(function(st,Rt){typeof exports=="object"&&typeof module<"u"?Rt(exports):typeof define=="function"&&define.amd?define(["exports"],Rt):(st=typeof globalThis<"u"?globalThis:st||self,Rt(st.mathlifier={}))})(this,function(st){"use strict";function Rt(t,e){return(n,...r)=>{let s="",a="",l=0,u={mathEnv:0};if(n.forEach((c,m)=>{let b=r[m];if((b==null||typeof b=="object"&&Object.keys(b).length===0)&&(b=""),l===0)c.endsWith("@")?s+=`${c.slice(0,c.length-1)}${b}`:[l,a,s,u]=oe(c,"",b,s);else if(l===1){const A=/([^]*?)(\r?\n)([^]*)/,x=c.match(A);if(x){const[,T,D,j]=x;a+=`${T}`,a&&(s+=t.math(a)),[l,a,s,u]=oe(j,D,b,s)}else c.endsWith("@")?a+=`${c.slice(0,c.length-1)}`:a+=`${c}${b}`}else if(l===2){const A=/([^]*?)(\r?\n[ \t]*\r?\n)([^]*)/,x=c.match(A);if(x){const[,T,D,j]=x;a+=T,a&&(s+=t.display(a)),[l,a,s,u]=oe(j,D,b,s)}else c.endsWith("@")?a+=`${c.slice(0,c.length-1)}`:a+=`${c}${b}`}else if(l===3){const A=/([^]*?)(\r?\n[ \t]*\r?\n)([^]*)/,x=c.match(A);if(x){const[,T,D,j]=x;a+=T,a&&(s+=le(u,a,t)),[l,a,s,u]=oe(j,D,b,s)}else c.endsWith("@")?a+=`${c.slice(0,c.length-1)}`:a+=`${c}${b}`}}),a){const c=l;if(e!=null&&e.postContent){const m=e.postContent.mode??"auto-math",b=e.postContent.content;c===0&&m==="text"?s+=a+b:c===1&&(m==="math"||m==="auto-math")?s+=t.math(a+b):c===2&&(m==="display"||m==="auto-math")?s+=t.display(a+b):c===3&&m==="auto-math"?s+=le(u,a+b,t):(c===0?s+=a:c===1?s+=t.math(a):c===2?s+=t.display(a):s+=le(u,a,t),m==="text"?s+=b:m==="math"||m==="auto-math"?s+=t.math(b):m==="display"&&(s+=t.display(b)))}else c===1?s+=t.math(a):c===2?s+=t.display(a):s+=le(u,a,t)}else if(e!=null&&e.postContent){const{mode:c,content:m}=e.postContent;c==="text"?s+=m:c==="math"||c==="auto-math"?s+=t.math(m):c==="display"&&(s+=t.display(m))}return s}}const hs=["equation","equation*","align","align*","gather","gather*","alignat","alignat*"];function ds(t){return hs.includes(t)}const ps={equation:0,"equation*":1,align:2,"align*":3,gather:4,"gather*":5,alignat:6,"alignat*":7};function oe(t,e,n,r){const s={mathEnv:0};let a=s;if(t.endsWith("$")){let l=`${n}`,u=2;return ds(l)&&(u=3,a={mathEnv:ps[l]},l=""),[u,l,r+`${e}${t.slice(0,t.length-1)}`,a]}else return t.endsWith("@")?[0,"",r+`${e}${t.slice(0,t.length-1)}${n}`,s]:[1,`${n}`,r+e+t,s]}function le(t,e,n){var s,a,l,u,c,m,b,A;const r=t.mathEnv;return r===0?(s=n.mathEnvs)!=null&&s.equation?n.mathEnvs.equation(e):e:r===1?(a=n.mathEnvs)!=null&&a.equationStar?n.mathEnvs.equationStar(e):e:r===2?(l=n.mathEnvs)!=null&&l.align?n.mathEnvs.align(e):e:r===3?(u=n.mathEnvs)!=null&&u.alignStar?n.mathEnvs.alignStar(e):e:r===4?(c=n.mathEnvs)!=null&&c.gather?n.mathEnvs.gather(e):e:r===5?(m=n.mathEnvs)!=null&&m.gatherStar?n.mathEnvs.gatherStar(e):e:r===6?(b=n.mathEnvs)!=null&&b.alignat?n.mathEnvs.alignat(e):e:r===7?(A=n.mathEnvs)!=null&&A.alignatStar?n.mathEnvs.alignatStar(e):e:(console.warn(`mathEnv ${r} not found`),e)}function Cn(t,...e){return Rt(ms)(t,...e)}const Nt=t=>"$$ "+t+" $$",ms={math:t=>"$ "+t+" $",display:Nt,mathEnvs:{equation:t=>Nt(Et("equation",t)),align:t=>Nt(Et("align",t)),gather:t=>Nt(Et("gather",t)),alignat:t=>Nt(Et("alignat",t)),equationStar:t=>Nt(Et("equation*",t)),alignStar:t=>Nt(Et("align*",t)),gatherStar:t=>Nt(Et("gather*",t)),alignatStar:t=>Nt(Et("alignat*",t))}};function Et(t,e,n=""){if(t==="alignat"||t==="alignat*"){let r=e.split(`
`)[0];r||(r=e.split(`
`)[1]);const s=r.split("&").length;s%2!==0&&console.warn(`alignat should have an even number of columns, but got ${s} instead`),n=`{${Math.floor(s/2)}}`}for(;e.endsWith(`
`)||e.endsWith("	")||e.endsWith(" ");)e=e.slice(0,e.length-1);return`\\begin{${t}}${n}${e}
\\end{${t}}`}function Tn(t,...e){return Cn(t,...e).replace(new RegExp("(?<!\\\\)\\$(?!`)\\$([^]+?)\\$\\$","g"),(r,s)=>`$$\`${s}\``).replace(new RegExp("(?<!\\\\)\\$(?![`$])([^]+?)(?<!\\\\)\\$","g"),(r,s)=>`$\`${s}\``)}class q{constructor(e,n){let r=" "+e,s;const a=n&&n.loc;if(a&&a.start<=a.end){const u=a.lexer.input;s=a.start;const c=a.end;s===u.length?r+=" at end of input: ":r+=" at position "+(s+1)+": ";const m=u.slice(s,c).replace(/[^]/g,"$&̲");let b;s>15?b="…"+u.slice(s-15,s):b=u.slice(0,s);let A;c+15<u.length?A=u.slice(c,c+15)+"…":A=u.slice(c),r+=b+m+A}const l=new Error(r);return l.name="ParseError",l.__proto__=q.prototype,l.position=s,l}}q.prototype.__proto__=Error.prototype;const fs=function(t,e){return t===void 0?e:t},gs=/([A-Z])/g,bs=function(t){return t.replace(gs,"-$1").toLowerCase()},xs={"&":"&amp;",">":"&gt;","<":"&lt;",'"':"&quot;","'":"&#x27;"},ys=/[&><"']/g;function ws(t){return String(t).replace(ys,e=>xs[e])}const Zt=function(t){return t.type==="ordgroup"||t.type==="color"?t.body.length===1?Zt(t.body[0]):t:t.type==="font"?Zt(t.body):t},vs=function(t){const e=Zt(t);return e.type==="mathord"||e.type==="textord"||e.type==="atom"},ks=function(t){if(!t)throw new Error("Expected non-null, but got "+String(t));return t};var Q={deflt:fs,escape:ws,hyphenate:bs,getBaseElem:Zt,isCharacterBox:vs,protocolFromUrl:function(t){const e=/^[\x00-\x20]*([^\\/#?]*?)(:|&#0*58|&#x0*3a|&colon)/i.exec(t);return e?e[2]!==":"||!/^[a-zA-Z][a-zA-Z0-9+\-.]*$/.test(e[1])?null:e[1].toLowerCase():"_relative"},round:function(t){return+t.toFixed(4)}};class Pe{constructor(e){e=e||{},this.displayMode=Q.deflt(e.displayMode,!1),this.annotate=Q.deflt(e.annotate,!1),this.leqno=Q.deflt(e.leqno,!1),this.throwOnError=Q.deflt(e.throwOnError,!1),this.errorColor=Q.deflt(e.errorColor,"#b22222"),this.macros=e.macros||{},this.wrap=Q.deflt(e.wrap,"tex"),this.xml=Q.deflt(e.xml,!1),this.colorIsTextColor=Q.deflt(e.colorIsTextColor,!1),this.strict=Q.deflt(e.strict,!1),this.trust=Q.deflt(e.trust,!1),this.maxSize=e.maxSize===void 0?[1/0,1/0]:Array.isArray(e.maxSize)?e.maxSize:[1/0,1/0],this.maxExpand=Math.max(0,Q.deflt(e.maxExpand,1e3))}isTrusted(e){if(e.url&&!e.protocol){const r=Q.protocolFromUrl(e.url);if(r==null)return!1;e.protocol=r}return!!(typeof this.trust=="function"?this.trust(e):this.trust)}}const qn={},ue={};function $({type:t,names:e,props:n,handler:r,mathmlBuilder:s}){const a={type:t,numArgs:n.numArgs,argTypes:n.argTypes,allowedInArgument:!!n.allowedInArgument,allowedInText:!!n.allowedInText,allowedInMath:n.allowedInMath===void 0?!0:n.allowedInMath,numOptionalArgs:n.numOptionalArgs||0,infix:!!n.infix,primitive:!!n.primitive,handler:r};for(let l=0;l<e.length;++l)qn[e[l]]=a;t&&s&&(ue[t]=s)}function Pt({type:t,mathmlBuilder:e}){$({type:t,names:[],props:{numArgs:0},handler(){throw new Error("Should never be called.")},mathmlBuilder:e})}const Xt=function(t){return t.type==="ordgroup"&&t.body.length===1?t.body[0]:t},it=function(t){return t.type==="ordgroup"?t.body:[t]};class Be{constructor(e){this.children=e,this.classes=[],this.style={}}hasClass(e){return this.classes.includes(e)}toNode(){const e=document.createDocumentFragment();for(let n=0;n<this.children.length;n++)e.appendChild(this.children[n].toNode());return e}toMarkup(){let e="";for(let n=0;n<this.children.length;n++)e+=this.children[n].toMarkup();return e}toText(){const e=n=>n.toText();return this.children.map(e).join("")}}const ce=function(t){return t.filter(e=>e).join(" ")},_s=function(t,e){this.classes=t||[],this.attributes={},this.style=e||{}},As=function(t){const e=document.createElement(t);e.className=ce(this.classes);for(const n in this.style)Object.prototype.hasOwnProperty.call(this.style,n)&&(e.style[n]=this.style[n]);for(const n in this.attributes)Object.prototype.hasOwnProperty.call(this.attributes,n)&&e.setAttribute(n,this.attributes[n]);for(let n=0;n<this.children.length;n++)e.appendChild(this.children[n].toNode());return e},Ss=function(t){let e=`<${t}`;this.classes.length&&(e+=` class="${Q.escape(ce(this.classes))}"`);let n="";for(const r in this.style)Object.prototype.hasOwnProperty.call(this.style,r)&&(n+=`${Q.hyphenate(r)}:${this.style[r]};`);n&&(e+=` style="${n}"`);for(const r in this.attributes)Object.prototype.hasOwnProperty.call(this.attributes,r)&&(e+=` ${r}="${Q.escape(this.attributes[r])}"`);e+=">";for(let r=0;r<this.children.length;r++)e+=this.children[r].toMarkup();return e+=`</${t}>`,e};class Mn{constructor(e,n,r){_s.call(this,e,r),this.children=n||[]}setAttribute(e,n){this.attributes[e]=n}toNode(){return As.call(this,"span")}toMarkup(){return Ss.call(this,"span")}}let Ns=class{constructor(e){this.text=e}toNode(){return document.createTextNode(this.text)}toMarkup(){return Q.escape(this.text)}};class Cs{constructor(e,n,r){this.alt=n,this.src=e,this.classes=["mord"],this.style=r}hasClass(e){return this.classes.includes(e)}toNode(){const e=document.createElement("img");e.src=this.src,e.alt=this.alt,e.className="mord";for(const n in this.style)Object.prototype.hasOwnProperty.call(this.style,n)&&(e.style[n]=this.style[n]);return e}toMarkup(){let e=`<img src='${this.src}' alt='${this.alt}'`,n="";for(const r in this.style)Object.prototype.hasOwnProperty.call(this.style,r)&&(n+=`${Q.hyphenate(r)}:${this.style[r]};`);return n&&(e+=` style="${Q.escape(n)}"`),e+=">",e}}function Ts(t){return new Be(t)}class ht{constructor(e,n,r,s){this.type=e,this.attributes={},this.children=n||[],this.classes=r||[],this.style=s||{}}setAttribute(e,n){this.attributes[e]=n}getAttribute(e){return this.attributes[e]}toNode(){const e=document.createElementNS("http://www.w3.org/1998/Math/MathML",this.type);for(const n in this.attributes)Object.prototype.hasOwnProperty.call(this.attributes,n)&&e.setAttribute(n,this.attributes[n]);this.classes.length>0&&(e.className=ce(this.classes));for(const n in this.style)Object.prototype.hasOwnProperty.call(this.style,n)&&(e.style[n]=this.style[n]);for(let n=0;n<this.children.length;n++)e.appendChild(this.children[n].toNode());return e}toMarkup(){let e="<"+this.type;for(const r in this.attributes)Object.prototype.hasOwnProperty.call(this.attributes,r)&&(e+=" "+r+'="',e+=Q.escape(this.attributes[r]),e+='"');this.classes.length>0&&(e+=` class="${Q.escape(ce(this.classes))}"`);let n="";for(const r in this.style)Object.prototype.hasOwnProperty.call(this.style,r)&&(n+=`${Q.hyphenate(r)}:${this.style[r]};`);n&&(e+=` style="${n}"`),e+=">";for(let r=0;r<this.children.length;r++)e+=this.children[r].toMarkup();return e+="</"+this.type+">",e}toText(){return this.children.map(e=>e.toText()).join("")}}class On{constructor(e){this.text=e}toNode(){return document.createTextNode(this.text)}toMarkup(){return Q.escape(this.toText())}toText(){return this.text}}const Le=t=>{let e;return t.length===1&&t[0].type==="mrow"?(e=t.pop(),e.type="mstyle"):e=new ht("mstyle",t),e};var y={MathNode:ht,TextNode:On,newDocumentFragment:Ts};const Yt=t=>{let e=0;if(t.body)for(const n of t.body)e+=Yt(n);else if(t.type==="supsub")e+=Yt(t.base),t.sub&&(e+=.7*Yt(t.sub)),t.sup&&(e+=.7*Yt(t.sup));else if(t.type==="mathord"||t.type==="textord")for(const n of t.text.split("")){const r=n.codePointAt(0);96<r&&r<123||944<r&&r<970?e+=.56:47<r&&r<58?e+=.5:e+=.92}else e+=1;return e},qs={widehat:"^",widecheck:"ˇ",widetilde:"~",wideparen:"⏜",utilde:"~",overleftarrow:"←",underleftarrow:"←",xleftarrow:"←",overrightarrow:"→",underrightarrow:"→",xrightarrow:"→",underbrace:"⏟",overbrace:"⏞",overgroup:"⏠",overparen:"⏜",undergroup:"⏡",underparen:"⏝",overleftrightarrow:"↔",underleftrightarrow:"↔",xleftrightarrow:"↔",Overrightarrow:"⇒",xRightarrow:"⇒",overleftharpoon:"↼",xleftharpoonup:"↼",overrightharpoon:"⇀",xrightharpoonup:"⇀",xLeftarrow:"⇐",xLeftrightarrow:"⇔",xhookleftarrow:"↩",xhookrightarrow:"↪",xmapsto:"↦",xrightharpoondown:"⇁",xleftharpoondown:"↽",xtwoheadleftarrow:"↞",xtwoheadrightarrow:"↠",xlongequal:"=",xrightleftarrows:"⇄",yields:"→",yieldsLeft:"←",mesomerism:"↔",longrightharpoonup:"⇀",longleftharpoondown:"↽",eqrightharpoonup:"⇀",eqleftharpoondown:"↽","\\cdrightarrow":"→","\\cdleftarrow":"←","\\cdlongequal":"="},$n=function(t){const e=new y.TextNode(qs[t.slice(1)]),n=new y.MathNode("mo",[e]);return n.setAttribute("stretchy","true"),n},Ms=["\\widetilde","\\widehat","\\widecheck","\\utilde"];var he={mathMLnode:$n,accentNode:t=>{const e=$n(t.label);if(Ms.includes(t.label)){const n=Yt(t.base);1<n&&n<1.6?e.classes.push("tml-crooked-2"):1.6<=n&&n<2.5?e.classes.push("tml-crooked-3"):2.5<=n&&e.classes.push("tml-crooked-4")}return e}};const Os={bin:1,close:1,inner:1,open:1,punct:1,rel:1},$s={"accent-token":1,mathord:1,"op-token":1,spacing:1,textord:1},lt={math:{},text:{}};function i(t,e,n,r,s){lt[t][r]={group:e,replace:n},s&&n&&(lt[t][n]=lt[t][r])}const o="math",_="text",V="accent-token",w="bin",at="close",Bt="inner",O="mathord",G="op-token",ut="open",Kt="punct",d="rel",Ct="spacing",f="textord";i(o,d,"≡","\\equiv",!0),i(o,d,"≺","\\prec",!0),i(o,d,"≻","\\succ",!0),i(o,d,"∼","\\sim",!0),i(o,d,"⟂","\\perp",!0),i(o,d,"⪯","\\preceq",!0),i(o,d,"⪰","\\succeq",!0),i(o,d,"≃","\\simeq",!0),i(o,d,"≌","\\backcong",!0),i(o,d,"|","\\mid",!0),i(o,d,"≪","\\ll",!0),i(o,d,"≫","\\gg",!0),i(o,d,"≍","\\asymp",!0),i(o,d,"∥","\\parallel"),i(o,d,"⌣","\\smile",!0),i(o,d,"⊑","\\sqsubseteq",!0),i(o,d,"⊒","\\sqsupseteq",!0),i(o,d,"≐","\\doteq",!0),i(o,d,"⌢","\\frown",!0),i(o,d,"∋","\\ni",!0),i(o,d,"∌","\\notni",!0),i(o,d,"∝","\\propto",!0),i(o,d,"⊢","\\vdash",!0),i(o,d,"⊣","\\dashv",!0),i(o,d,"∋","\\owns"),i(o,d,"≘","\\arceq",!0),i(o,d,"≙","\\wedgeq",!0),i(o,d,"≚","\\veeeq",!0),i(o,d,"≛","\\stareq",!0),i(o,d,"≝","\\eqdef",!0),i(o,d,"≞","\\measeq",!0),i(o,d,"≟","\\questeq",!0),i(o,d,"≠","\\ne",!0),i(o,d,"≠","\\neq"),i(o,d,"⩵","\\eqeq",!0),i(o,d,"⩶","\\eqeqeq",!0),i(o,d,"∷","\\dblcolon",!0),i(o,d,"≔","\\coloneqq",!0),i(o,d,"≕","\\eqqcolon",!0),i(o,d,"∹","\\eqcolon",!0),i(o,d,"⩴","\\Coloneqq",!0),i(o,Kt,".","\\ldotp"),i(o,Kt,"·","\\cdotp"),i(o,f,"#","\\#"),i(_,f,"#","\\#"),i(o,f,"&","\\&"),i(_,f,"&","\\&"),i(o,f,"ℵ","\\aleph",!0),i(o,f,"∀","\\forall",!0),i(o,f,"ℏ","\\hbar",!0),i(o,f,"∃","\\exists",!0),i(o,w,"∇","\\nabla",!0),i(o,f,"♭","\\flat",!0),i(o,f,"ℓ","\\ell",!0),i(o,f,"♮","\\natural",!0),i(o,f,"Å","\\Angstrom",!0),i(_,f,"Å","\\Angstrom",!0),i(o,f,"♣","\\clubsuit",!0),i(o,f,"♧","\\varclubsuit",!0),i(o,f,"℘","\\wp",!0),i(o,f,"♯","\\sharp",!0),i(o,f,"♢","\\diamondsuit",!0),i(o,f,"♦","\\vardiamondsuit",!0),i(o,f,"ℜ","\\Re",!0),i(o,f,"♡","\\heartsuit",!0),i(o,f,"♥","\\varheartsuit",!0),i(o,f,"ℑ","\\Im",!0),i(o,f,"♠","\\spadesuit",!0),i(o,f,"♤","\\varspadesuit",!0),i(o,f,"♀","\\female",!0),i(o,f,"♂","\\male",!0),i(o,f,"§","\\S",!0),i(_,f,"§","\\S"),i(o,f,"¶","\\P",!0),i(_,f,"¶","\\P"),i(_,f,"☺","\\smiley",!0),i(o,f,"☺","\\smiley",!0),i(o,f,"†","\\dag"),i(_,f,"†","\\dag"),i(_,f,"†","\\textdagger"),i(o,f,"‡","\\ddag"),i(_,f,"‡","\\ddag"),i(_,f,"‡","\\textdaggerdbl"),i(o,at,"⎱","\\rmoustache",!0),i(o,ut,"⎰","\\lmoustache",!0),i(o,at,"⟯","\\rgroup",!0),i(o,ut,"⟮","\\lgroup",!0),i(o,w,"∓","\\mp",!0),i(o,w,"⊖","\\ominus",!0),i(o,w,"⊎","\\uplus",!0),i(o,w,"⊓","\\sqcap",!0),i(o,w,"∗","\\ast"),i(o,w,"⊔","\\sqcup",!0),i(o,w,"◯","\\bigcirc",!0),i(o,w,"∙","\\bullet",!0),i(o,w,"‡","\\ddagger"),i(o,w,"≀","\\wr",!0),i(o,w,"⨿","\\amalg"),i(o,w,"&","\\And"),i(o,w,"⫽","\\sslash",!0),i(o,d,"⟵","\\longleftarrow",!0),i(o,d,"⇐","\\Leftarrow",!0),i(o,d,"⟸","\\Longleftarrow",!0),i(o,d,"⟶","\\longrightarrow",!0),i(o,d,"⇒","\\Rightarrow",!0),i(o,d,"⟹","\\Longrightarrow",!0),i(o,d,"↔","\\leftrightarrow",!0),i(o,d,"⟷","\\longleftrightarrow",!0),i(o,d,"⇔","\\Leftrightarrow",!0),i(o,d,"⟺","\\Longleftrightarrow",!0),i(o,d,"↤","\\mapsfrom",!0),i(o,d,"↦","\\mapsto",!0),i(o,d,"⟼","\\longmapsto",!0),i(o,d,"↗","\\nearrow",!0),i(o,d,"↩","\\hookleftarrow",!0),i(o,d,"↪","\\hookrightarrow",!0),i(o,d,"↘","\\searrow",!0),i(o,d,"↼","\\leftharpoonup",!0),i(o,d,"⇀","\\rightharpoonup",!0),i(o,d,"↙","\\swarrow",!0),i(o,d,"↽","\\leftharpoondown",!0),i(o,d,"⇁","\\rightharpoondown",!0),i(o,d,"↖","\\nwarrow",!0),i(o,d,"⇌","\\rightleftharpoons",!0),i(o,O,"↯","\\lightning",!0),i(o,O,"∎","\\QED",!0),i(o,O,"‰","\\permil",!0),i(_,f,"‰","\\permil"),i(o,O,"☉","\\astrosun",!0),i(o,O,"☼","\\sun",!0),i(o,O,"☾","\\leftmoon",!0),i(o,O,"☽","\\rightmoon",!0),i(o,O,"⊕","\\Earth"),i(o,d,"≮","\\nless",!0),i(o,d,"⪇","\\lneq",!0),i(o,d,"≨","\\lneqq",!0),i(o,d,"≨︀","\\lvertneqq"),i(o,d,"⋦","\\lnsim",!0),i(o,d,"⪉","\\lnapprox",!0),i(o,d,"⊀","\\nprec",!0),i(o,d,"⋠","\\npreceq",!0),i(o,d,"⋨","\\precnsim",!0),i(o,d,"⪹","\\precnapprox",!0),i(o,d,"≁","\\nsim",!0),i(o,d,"∤","\\nmid",!0),i(o,d,"∤","\\nshortmid"),i(o,d,"⊬","\\nvdash",!0),i(o,d,"⊭","\\nvDash",!0),i(o,d,"⋪","\\ntriangleleft"),i(o,d,"⋬","\\ntrianglelefteq",!0),i(o,d,"⊄","\\nsubset",!0),i(o,d,"⊅","\\nsupset",!0),i(o,d,"⊊","\\subsetneq",!0),i(o,d,"⊊︀","\\varsubsetneq"),i(o,d,"⫋","\\subsetneqq",!0),i(o,d,"⫋︀","\\varsubsetneqq"),i(o,d,"≯","\\ngtr",!0),i(o,d,"⪈","\\gneq",!0),i(o,d,"≩","\\gneqq",!0),i(o,d,"≩︀","\\gvertneqq"),i(o,d,"⋧","\\gnsim",!0),i(o,d,"⪊","\\gnapprox",!0),i(o,d,"⊁","\\nsucc",!0),i(o,d,"⋡","\\nsucceq",!0),i(o,d,"⋩","\\succnsim",!0),i(o,d,"⪺","\\succnapprox",!0),i(o,d,"≆","\\ncong",!0),i(o,d,"∦","\\nparallel",!0),i(o,d,"∦","\\nshortparallel"),i(o,d,"⊯","\\nVDash",!0),i(o,d,"⋫","\\ntriangleright"),i(o,d,"⋭","\\ntrianglerighteq",!0),i(o,d,"⊋","\\supsetneq",!0),i(o,d,"⊋","\\varsupsetneq"),i(o,d,"⫌","\\supsetneqq",!0),i(o,d,"⫌︀","\\varsupsetneqq"),i(o,d,"⊮","\\nVdash",!0),i(o,d,"⪵","\\precneqq",!0),i(o,d,"⪶","\\succneqq",!0),i(o,w,"⊴","\\unlhd"),i(o,w,"⊵","\\unrhd"),i(o,d,"↚","\\nleftarrow",!0),i(o,d,"↛","\\nrightarrow",!0),i(o,d,"⇍","\\nLeftarrow",!0),i(o,d,"⇏","\\nRightarrow",!0),i(o,d,"↮","\\nleftrightarrow",!0),i(o,d,"⇎","\\nLeftrightarrow",!0),i(o,d,"△","\\vartriangle"),i(o,f,"ℏ","\\hslash"),i(o,f,"▽","\\triangledown"),i(o,f,"◊","\\lozenge"),i(o,f,"Ⓢ","\\circledS"),i(o,f,"®","\\circledR",!0),i(_,f,"®","\\circledR"),i(_,f,"®","\\textregistered"),i(o,f,"∡","\\measuredangle",!0),i(o,f,"∄","\\nexists"),i(o,f,"℧","\\mho"),i(o,f,"Ⅎ","\\Finv",!0),i(o,f,"⅁","\\Game",!0),i(o,f,"‵","\\backprime"),i(o,f,"‶","\\backdprime"),i(o,f,"‷","\\backtrprime"),i(o,f,"▲","\\blacktriangle"),i(o,f,"▼","\\blacktriangledown"),i(o,f,"■","\\blacksquare"),i(o,f,"⧫","\\blacklozenge"),i(o,f,"★","\\bigstar"),i(o,f,"∢","\\sphericalangle",!0),i(o,f,"∁","\\complement",!0),i(o,f,"ð","\\eth",!0),i(_,f,"ð","ð"),i(o,f,"╱","\\diagup"),i(o,f,"╲","\\diagdown"),i(o,f,"□","\\square"),i(o,f,"□","\\Box"),i(o,f,"◊","\\Diamond"),i(o,f,"¥","\\yen",!0),i(_,f,"¥","\\yen",!0),i(o,f,"✓","\\checkmark",!0),i(_,f,"✓","\\checkmark"),i(o,f,"✗","\\ballotx",!0),i(_,f,"✗","\\ballotx"),i(_,f,"•","\\textbullet"),i(o,f,"ℶ","\\beth",!0),i(o,f,"ℸ","\\daleth",!0),i(o,f,"ℷ","\\gimel",!0),i(o,f,"ϝ","\\digamma",!0),i(o,f,"ϰ","\\varkappa"),i(o,ut,"⌜","\\ulcorner",!0),i(o,at,"⌝","\\urcorner",!0),i(o,ut,"⌞","\\llcorner",!0),i(o,at,"⌟","\\lrcorner",!0),i(o,d,"≦","\\leqq",!0),i(o,d,"⩽","\\leqslant",!0),i(o,d,"⪕","\\eqslantless",!0),i(o,d,"≲","\\lesssim",!0),i(o,d,"⪅","\\lessapprox",!0),i(o,d,"≊","\\approxeq",!0),i(o,w,"⋖","\\lessdot"),i(o,d,"⋘","\\lll",!0),i(o,d,"≶","\\lessgtr",!0),i(o,d,"⋚","\\lesseqgtr",!0),i(o,d,"⪋","\\lesseqqgtr",!0),i(o,d,"≑","\\doteqdot"),i(o,d,"≓","\\risingdotseq",!0),i(o,d,"≒","\\fallingdotseq",!0),i(o,d,"∽","\\backsim",!0),i(o,d,"⋍","\\backsimeq",!0),i(o,d,"⫅","\\subseteqq",!0),i(o,d,"⋐","\\Subset",!0),i(o,d,"⊏","\\sqsubset",!0),i(o,d,"≼","\\preccurlyeq",!0),i(o,d,"⋞","\\curlyeqprec",!0),i(o,d,"≾","\\precsim",!0),i(o,d,"⪷","\\precapprox",!0),i(o,d,"⊲","\\vartriangleleft"),i(o,d,"⊴","\\trianglelefteq"),i(o,d,"⊨","\\vDash",!0),i(o,d,"⊫","\\VDash",!0),i(o,d,"⊪","\\Vvdash",!0),i(o,d,"⌣","\\smallsmile"),i(o,d,"⌢","\\smallfrown"),i(o,d,"≏","\\bumpeq",!0),i(o,d,"≎","\\Bumpeq",!0),i(o,d,"≧","\\geqq",!0),i(o,d,"⩾","\\geqslant",!0),i(o,d,"⪖","\\eqslantgtr",!0),i(o,d,"≳","\\gtrsim",!0),i(o,d,"⪆","\\gtrapprox",!0),i(o,w,"⋗","\\gtrdot"),i(o,d,"⋙","\\ggg",!0),i(o,d,"≷","\\gtrless",!0),i(o,d,"⋛","\\gtreqless",!0),i(o,d,"⪌","\\gtreqqless",!0),i(o,d,"≖","\\eqcirc",!0),i(o,d,"≗","\\circeq",!0),i(o,d,"≜","\\triangleq",!0),i(o,d,"∼","\\thicksim"),i(o,d,"≈","\\thickapprox"),i(o,d,"⫆","\\supseteqq",!0),i(o,d,"⋑","\\Supset",!0),i(o,d,"⊐","\\sqsupset",!0),i(o,d,"≽","\\succcurlyeq",!0),i(o,d,"⋟","\\curlyeqsucc",!0),i(o,d,"≿","\\succsim",!0),i(o,d,"⪸","\\succapprox",!0),i(o,d,"⊳","\\vartriangleright"),i(o,d,"⊵","\\trianglerighteq"),i(o,d,"⊩","\\Vdash",!0),i(o,d,"∣","\\shortmid"),i(o,d,"∥","\\shortparallel"),i(o,d,"≬","\\between",!0),i(o,d,"⋔","\\pitchfork",!0),i(o,d,"∝","\\varpropto"),i(o,d,"◀","\\blacktriangleleft"),i(o,d,"∴","\\therefore",!0),i(o,d,"∍","\\backepsilon"),i(o,d,"▶","\\blacktriangleright"),i(o,d,"∵","\\because",!0),i(o,d,"⋘","\\llless"),i(o,d,"⋙","\\gggtr"),i(o,w,"⊲","\\lhd"),i(o,w,"⊳","\\rhd"),i(o,d,"≂","\\eqsim",!0),i(o,d,"≑","\\Doteq",!0),i(o,d,"⥽","\\strictif",!0),i(o,d,"⥼","\\strictfi",!0),i(o,w,"∔","\\dotplus",!0),i(o,w,"∖","\\smallsetminus"),i(o,w,"⋒","\\Cap",!0),i(o,w,"⋓","\\Cup",!0),i(o,w,"⩞","\\doublebarwedge",!0),i(o,w,"⊟","\\boxminus",!0),i(o,w,"⊞","\\boxplus",!0),i(o,w,"⧄","\\boxslash",!0),i(o,w,"⋇","\\divideontimes",!0),i(o,w,"⋉","\\ltimes",!0),i(o,w,"⋊","\\rtimes",!0),i(o,w,"⋋","\\leftthreetimes",!0),i(o,w,"⋌","\\rightthreetimes",!0),i(o,w,"⋏","\\curlywedge",!0),i(o,w,"⋎","\\curlyvee",!0),i(o,w,"⊝","\\circleddash",!0),i(o,w,"⊛","\\circledast",!0),i(o,w,"⊺","\\intercal",!0),i(o,w,"⋒","\\doublecap"),i(o,w,"⋓","\\doublecup"),i(o,w,"⊠","\\boxtimes",!0),i(o,w,"⋈","\\bowtie",!0),i(o,w,"⋈","\\Join"),i(o,w,"⟕","\\leftouterjoin",!0),i(o,w,"⟖","\\rightouterjoin",!0),i(o,w,"⟗","\\fullouterjoin",!0),i(o,w,"∸","\\dotminus",!0),i(o,w,"⟑","\\wedgedot",!0),i(o,w,"⟇","\\veedot",!0),i(o,w,"⩢","\\doublebarvee",!0),i(o,w,"⩣","\\veedoublebar",!0),i(o,w,"⩟","\\wedgebar",!0),i(o,w,"⩠","\\wedgedoublebar",!0),i(o,w,"⩔","\\Vee",!0),i(o,w,"⩓","\\Wedge",!0),i(o,w,"⩃","\\barcap",!0),i(o,w,"⩂","\\barcup",!0),i(o,w,"⩈","\\capbarcup",!0),i(o,w,"⩀","\\capdot",!0),i(o,w,"⩇","\\capovercup",!0),i(o,w,"⩆","\\cupovercap",!0),i(o,w,"⩍","\\closedvarcap",!0),i(o,w,"⩌","\\closedvarcup",!0),i(o,w,"⨪","\\minusdot",!0),i(o,w,"⨫","\\minusfdots",!0),i(o,w,"⨬","\\minusrdots",!0),i(o,w,"⊻","\\Xor",!0),i(o,w,"⊼","\\Nand",!0),i(o,w,"⊽","\\Nor",!0),i(o,w,"⊽","\\barvee"),i(o,w,"⫴","\\interleave",!0),i(o,w,"⧢","\\shuffle",!0),i(o,w,"⫶","\\threedotcolon",!0),i(o,w,"⦂","\\typecolon",!0),i(o,w,"∾","\\invlazys",!0),i(o,w,"⩋","\\twocaps",!0),i(o,w,"⩊","\\twocups",!0),i(o,w,"⩎","\\Sqcap",!0),i(o,w,"⩏","\\Sqcup",!0),i(o,w,"⩖","\\veeonvee",!0),i(o,w,"⩕","\\wedgeonwedge",!0),i(o,w,"⧗","\\blackhourglass",!0),i(o,w,"⧆","\\boxast",!0),i(o,w,"⧈","\\boxbox",!0),i(o,w,"⧇","\\boxcircle",!0),i(o,w,"⊜","\\circledequal",!0),i(o,w,"⦷","\\circledparallel",!0),i(o,w,"⦶","\\circledvert",!0),i(o,w,"⦵","\\circlehbar",!0),i(o,w,"⟡","\\concavediamond",!0),i(o,w,"⟢","\\concavediamondtickleft",!0),i(o,w,"⟣","\\concavediamondtickright",!0),i(o,w,"⋄","\\diamond",!0),i(o,w,"⧖","\\hourglass",!0),i(o,w,"⟠","\\lozengeminus",!0),i(o,w,"⌽","\\obar",!0),i(o,w,"⦸","\\obslash",!0),i(o,w,"⨸","\\odiv",!0),i(o,w,"⧁","\\ogreaterthan",!0),i(o,w,"⧀","\\olessthan",!0),i(o,w,"⦹","\\operp",!0),i(o,w,"⨷","\\Otimes",!0),i(o,w,"⨶","\\otimeshat",!0),i(o,w,"⋆","\\star",!0),i(o,w,"△","\\triangle",!0),i(o,w,"⨺","\\triangleminus",!0),i(o,w,"⨹","\\triangleplus",!0),i(o,w,"⨻","\\triangletimes",!0),i(o,w,"⟤","\\whitesquaretickleft",!0),i(o,w,"⟥","\\whitesquaretickright",!0),i(o,w,"⨳","\\smashtimes",!0),i(o,d,"⇢","\\dashrightarrow",!0),i(o,d,"⇠","\\dashleftarrow",!0),i(o,d,"⇇","\\leftleftarrows",!0),i(o,d,"⇆","\\leftrightarrows",!0),i(o,d,"⇚","\\Lleftarrow",!0),i(o,d,"↞","\\twoheadleftarrow",!0),i(o,d,"↢","\\leftarrowtail",!0),i(o,d,"↫","\\looparrowleft",!0),i(o,d,"⇋","\\leftrightharpoons",!0),i(o,d,"↶","\\curvearrowleft",!0),i(o,d,"↺","\\circlearrowleft",!0),i(o,d,"↰","\\Lsh",!0),i(o,d,"⇈","\\upuparrows",!0),i(o,d,"↿","\\upharpoonleft",!0),i(o,d,"⇃","\\downharpoonleft",!0),i(o,d,"⊶","\\origof",!0),i(o,d,"⊷","\\imageof",!0),i(o,d,"⊸","\\multimap",!0),i(o,d,"↭","\\leftrightsquigarrow",!0),i(o,d,"⇉","\\rightrightarrows",!0),i(o,d,"⇄","\\rightleftarrows",!0),i(o,d,"↠","\\twoheadrightarrow",!0),i(o,d,"↣","\\rightarrowtail",!0),i(o,d,"↬","\\looparrowright",!0),i(o,d,"↷","\\curvearrowright",!0),i(o,d,"↻","\\circlearrowright",!0),i(o,d,"↱","\\Rsh",!0),i(o,d,"⇊","\\downdownarrows",!0),i(o,d,"↾","\\upharpoonright",!0),i(o,d,"⇂","\\downharpoonright",!0),i(o,d,"⇝","\\rightsquigarrow",!0),i(o,d,"⇝","\\leadsto"),i(o,d,"⇛","\\Rrightarrow",!0),i(o,d,"↾","\\restriction"),i(o,f,"‘","`"),i(o,f,"$","\\$"),i(_,f,"$","\\$"),i(_,f,"$","\\textdollar"),i(o,f,"¢","\\cent"),i(_,f,"¢","\\cent"),i(o,f,"%","\\%"),i(_,f,"%","\\%"),i(o,f,"_","\\_"),i(_,f,"_","\\_"),i(_,f,"_","\\textunderscore"),i(_,f,"␣","\\textvisiblespace",!0),i(o,f,"∠","\\angle",!0),i(o,f,"∞","\\infty",!0),i(o,f,"′","\\prime"),i(o,f,"″","\\dprime"),i(o,f,"‴","\\trprime"),i(o,f,"⁗","\\qprime"),i(o,f,"△","\\triangle"),i(_,f,"Α","\\Alpha",!0),i(_,f,"Β","\\Beta",!0),i(_,f,"Γ","\\Gamma",!0),i(_,f,"Δ","\\Delta",!0),i(_,f,"Ε","\\Epsilon",!0),i(_,f,"Ζ","\\Zeta",!0),i(_,f,"Η","\\Eta",!0),i(_,f,"Θ","\\Theta",!0),i(_,f,"Ι","\\Iota",!0),i(_,f,"Κ","\\Kappa",!0),i(_,f,"Λ","\\Lambda",!0),i(_,f,"Μ","\\Mu",!0),i(_,f,"Ν","\\Nu",!0),i(_,f,"Ξ","\\Xi",!0),i(_,f,"Ο","\\Omicron",!0),i(_,f,"Π","\\Pi",!0),i(_,f,"Ρ","\\Rho",!0),i(_,f,"Σ","\\Sigma",!0),i(_,f,"Τ","\\Tau",!0),i(_,f,"Υ","\\Upsilon",!0),i(_,f,"Φ","\\Phi",!0),i(_,f,"Χ","\\Chi",!0),i(_,f,"Ψ","\\Psi",!0),i(_,f,"Ω","\\Omega",!0),i(o,O,"Α","\\Alpha",!0),i(o,O,"Β","\\Beta",!0),i(o,O,"Γ","\\Gamma",!0),i(o,O,"Δ","\\Delta",!0),i(o,O,"Ε","\\Epsilon",!0),i(o,O,"Ζ","\\Zeta",!0),i(o,O,"Η","\\Eta",!0),i(o,O,"Θ","\\Theta",!0),i(o,O,"Ι","\\Iota",!0),i(o,O,"Κ","\\Kappa",!0),i(o,O,"Λ","\\Lambda",!0),i(o,O,"Μ","\\Mu",!0),i(o,O,"Ν","\\Nu",!0),i(o,O,"Ξ","\\Xi",!0),i(o,O,"Ο","\\Omicron",!0),i(o,O,"Π","\\Pi",!0),i(o,O,"Ρ","\\Rho",!0),i(o,O,"Σ","\\Sigma",!0),i(o,O,"Τ","\\Tau",!0),i(o,O,"Υ","\\Upsilon",!0),i(o,O,"Φ","\\Phi",!0),i(o,O,"Χ","\\Chi",!0),i(o,O,"Ψ","\\Psi",!0),i(o,O,"Ω","\\Omega",!0),i(o,ut,"¬","\\neg",!0),i(o,ut,"¬","\\lnot"),i(o,f,"⊤","\\top"),i(o,f,"⊥","\\bot"),i(o,f,"∅","\\emptyset"),i(o,f,"⌀","\\varnothing"),i(o,O,"α","\\alpha",!0),i(o,O,"β","\\beta",!0),i(o,O,"γ","\\gamma",!0),i(o,O,"δ","\\delta",!0),i(o,O,"ϵ","\\epsilon",!0),i(o,O,"ζ","\\zeta",!0),i(o,O,"η","\\eta",!0),i(o,O,"θ","\\theta",!0),i(o,O,"ι","\\iota",!0),i(o,O,"κ","\\kappa",!0),i(o,O,"λ","\\lambda",!0),i(o,O,"μ","\\mu",!0),i(o,O,"ν","\\nu",!0),i(o,O,"ξ","\\xi",!0),i(o,O,"ο","\\omicron",!0),i(o,O,"π","\\pi",!0),i(o,O,"ρ","\\rho",!0),i(o,O,"σ","\\sigma",!0),i(o,O,"τ","\\tau",!0),i(o,O,"υ","\\upsilon",!0),i(o,O,"ϕ","\\phi",!0),i(o,O,"χ","\\chi",!0),i(o,O,"ψ","\\psi",!0),i(o,O,"ω","\\omega",!0),i(o,O,"ε","\\varepsilon",!0),i(o,O,"ϑ","\\vartheta",!0),i(o,O,"ϖ","\\varpi",!0),i(o,O,"ϱ","\\varrho",!0),i(o,O,"ς","\\varsigma",!0),i(o,O,"φ","\\varphi",!0),i(o,O,"Ϙ","\\Coppa",!0),i(o,O,"ϙ","\\coppa",!0),i(o,O,"ϙ","\\varcoppa",!0),i(o,O,"Ϟ","\\Koppa",!0),i(o,O,"ϟ","\\koppa",!0),i(o,O,"Ϡ","\\Sampi",!0),i(o,O,"ϡ","\\sampi",!0),i(o,O,"Ϛ","\\Stigma",!0),i(o,O,"ϛ","\\stigma",!0),i(o,O,"⫫","\\Bot"),i(o,w,"∗","∗",!0),i(o,w,"+","+"),i(o,w,"*","*"),i(o,w,"⁄","/",!0),i(o,w,"⁄","⁄"),i(o,w,"−","-",!0),i(o,w,"⋅","\\cdot",!0),i(o,w,"∘","\\circ",!0),i(o,w,"÷","\\div",!0),i(o,w,"±","\\pm",!0),i(o,w,"×","\\times",!0),i(o,w,"∩","\\cap",!0),i(o,w,"∪","\\cup",!0),i(o,w,"∖","\\setminus",!0),i(o,w,"∧","\\land"),i(o,w,"∨","\\lor"),i(o,w,"∧","\\wedge",!0),i(o,w,"∨","\\vee",!0),i(o,ut,"⟦","\\llbracket",!0),i(o,at,"⟧","\\rrbracket",!0),i(o,ut,"⟨","\\langle",!0),i(o,ut,"⟪","\\lAngle",!0),i(o,ut,"⦉","\\llangle",!0),i(o,ut,"|","\\lvert"),i(o,ut,"‖","\\lVert"),i(o,f,"!","\\oc"),i(o,f,"?","\\wn"),i(o,f,"↓","\\shpos"),i(o,f,"↕","\\shift"),i(o,f,"↑","\\shneg"),i(o,at,"?","?"),i(o,at,"!","!"),i(o,at,"‼","‼"),i(o,at,"⟩","\\rangle",!0),i(o,at,"⟫","\\rAngle",!0),i(o,at,"⦊","\\rrangle",!0),i(o,at,"|","\\rvert"),i(o,at,"‖","\\rVert"),i(o,ut,"⦃","\\lBrace",!0),i(o,at,"⦄","\\rBrace",!0),i(o,d,"=","\\equal",!0),i(o,d,":",":"),i(o,d,"≈","\\approx",!0),i(o,d,"≅","\\cong",!0),i(o,d,"≥","\\ge"),i(o,d,"≥","\\geq",!0),i(o,d,"←","\\gets"),i(o,d,">","\\gt",!0),i(o,d,"∈","\\in",!0),i(o,d,"∉","\\notin",!0),i(o,d,"","\\@not"),i(o,d,"⊂","\\subset",!0),i(o,d,"⊃","\\supset",!0),i(o,d,"⊆","\\subseteq",!0),i(o,d,"⊇","\\supseteq",!0),i(o,d,"⊈","\\nsubseteq",!0),i(o,d,"⊈","\\nsubseteqq"),i(o,d,"⊉","\\nsupseteq",!0),i(o,d,"⊉","\\nsupseteqq"),i(o,d,"⊨","\\models"),i(o,d,"←","\\leftarrow",!0),i(o,d,"≤","\\le"),i(o,d,"≤","\\leq",!0),i(o,d,"<","\\lt",!0),i(o,d,"→","\\rightarrow",!0),i(o,d,"→","\\to"),i(o,d,"≱","\\ngeq",!0),i(o,d,"≱","\\ngeqq"),i(o,d,"≱","\\ngeqslant"),i(o,d,"≰","\\nleq",!0),i(o,d,"≰","\\nleqq"),i(o,d,"≰","\\nleqslant"),i(o,d,"⫫","\\Perp",!0),i(o,Ct," ","\\ "),i(o,Ct," ","\\space"),i(o,Ct," ","\\nobreakspace"),i(_,Ct," ","\\ "),i(_,Ct," "," "),i(_,Ct," ","\\space"),i(_,Ct," ","\\nobreakspace"),i(o,Ct,null,"\\nobreak"),i(o,Ct,null,"\\allowbreak"),i(o,Kt,",",","),i(_,Kt,":",":"),i(o,Kt,";",";"),i(o,w,"⊼","\\barwedge"),i(o,w,"⊻","\\veebar"),i(o,w,"⊙","\\odot",!0),i(o,w,"⊕︎","\\oplus"),i(o,w,"⊗","\\otimes",!0),i(o,f,"∂","\\partial",!0),i(o,w,"⊘","\\oslash",!0),i(o,w,"⊚","\\circledcirc",!0),i(o,w,"⊡","\\boxdot",!0),i(o,w,"△","\\bigtriangleup"),i(o,w,"▽","\\bigtriangledown"),i(o,w,"†","\\dagger"),i(o,w,"⋄","\\diamond"),i(o,w,"◃","\\triangleleft"),i(o,w,"▹","\\triangleright"),i(o,ut,"{","\\{"),i(_,f,"{","\\{"),i(_,f,"{","\\textbraceleft"),i(o,at,"}","\\}"),i(_,f,"}","\\}"),i(_,f,"}","\\textbraceright"),i(o,ut,"{","\\lbrace"),i(o,at,"}","\\rbrace"),i(o,ut,"[","\\lbrack",!0),i(_,f,"[","\\lbrack",!0),i(o,at,"]","\\rbrack",!0),i(_,f,"]","\\rbrack",!0),i(o,ut,"(","\\lparen",!0),i(o,at,")","\\rparen",!0),i(o,ut,"⦇","\\llparenthesis",!0),i(o,at,"⦈","\\rrparenthesis",!0),i(_,f,"<","\\textless",!0),i(_,f,">","\\textgreater",!0),i(o,ut,"⌊","\\lfloor",!0),i(o,at,"⌋","\\rfloor",!0),i(o,ut,"⌈","\\lceil",!0),i(o,at,"⌉","\\rceil",!0),i(o,f,"\\","\\backslash"),i(o,f,"|","|"),i(o,f,"|","\\vert"),i(_,f,"|","\\textbar",!0),i(o,f,"‖","\\|"),i(o,f,"‖","\\Vert"),i(_,f,"‖","\\textbardbl"),i(_,f,"~","\\textasciitilde"),i(_,f,"\\","\\textbackslash"),i(_,f,"^","\\textasciicircum"),i(o,d,"↑","\\uparrow",!0),i(o,d,"⇑","\\Uparrow",!0),i(o,d,"↓","\\downarrow",!0),i(o,d,"⇓","\\Downarrow",!0),i(o,d,"↕","\\updownarrow",!0),i(o,d,"⇕","\\Updownarrow",!0),i(o,G,"∐","\\coprod"),i(o,G,"⋁","\\bigvee"),i(o,G,"⋀","\\bigwedge"),i(o,G,"⨄","\\biguplus"),i(o,G,"⨄","\\bigcupplus"),i(o,G,"⨃","\\bigcupdot"),i(o,G,"⨇","\\bigdoublevee"),i(o,G,"⨈","\\bigdoublewedge"),i(o,G,"⋂","\\bigcap"),i(o,G,"⋃","\\bigcup"),i(o,G,"∫","\\int"),i(o,G,"∫","\\intop"),i(o,G,"∬","\\iint"),i(o,G,"∭","\\iiint"),i(o,G,"∏","\\prod"),i(o,G,"∑","\\sum"),i(o,G,"⨂","\\bigotimes"),i(o,G,"⨁","\\bigoplus"),i(o,G,"⨀","\\bigodot"),i(o,G,"⨉","\\bigtimes"),i(o,G,"∮","\\oint"),i(o,G,"∯","\\oiint"),i(o,G,"∰","\\oiiint"),i(o,G,"∱","\\intclockwise"),i(o,G,"∲","\\varointclockwise"),i(o,G,"⨌","\\iiiint"),i(o,G,"⨍","\\intbar"),i(o,G,"⨎","\\intBar"),i(o,G,"⨏","\\fint"),i(o,G,"⨒","\\rppolint"),i(o,G,"⨓","\\scpolint"),i(o,G,"⨕","\\pointint"),i(o,G,"⨖","\\sqint"),i(o,G,"⨗","\\intlarhk"),i(o,G,"⨘","\\intx"),i(o,G,"⨙","\\intcap"),i(o,G,"⨚","\\intcup"),i(o,G,"⨅","\\bigsqcap"),i(o,G,"⨆","\\bigsqcup"),i(o,G,"∫","\\smallint"),i(_,Bt,"…","\\textellipsis"),i(o,Bt,"…","\\mathellipsis"),i(_,Bt,"…","\\ldots",!0),i(o,Bt,"…","\\ldots",!0),i(o,Bt,"⋰","\\iddots",!0),i(o,Bt,"⋯","\\@cdots",!0),i(o,Bt,"⋱","\\ddots",!0),i(o,f,"⋮","\\varvdots"),i(o,V,"ˊ","\\acute"),i(o,V,"`","\\grave"),i(o,V,"¨","\\ddot"),i(o,V,"…","\\dddot"),i(o,V,"….","\\ddddot"),i(o,V,"~","\\tilde"),i(o,V,"‾","\\bar"),i(o,V,"˘","\\breve"),i(o,V,"ˇ","\\check"),i(o,V,"^","\\hat"),i(o,V,"→","\\vec"),i(o,V,"˙","\\dot"),i(o,V,"˚","\\mathring"),i(o,O,"ı","\\imath",!0),i(o,O,"ȷ","\\jmath",!0),i(o,f,"ı","ı"),i(o,f,"ȷ","ȷ"),i(_,f,"ı","\\i",!0),i(_,f,"ȷ","\\j",!0),i(_,f,"ß","\\ss",!0),i(_,f,"æ","\\ae",!0),i(_,f,"œ","\\oe",!0),i(_,f,"ø","\\o",!0),i(o,O,"ø","\\o",!0),i(_,f,"Æ","\\AE",!0),i(_,f,"Œ","\\OE",!0),i(_,f,"Ø","\\O",!0),i(o,O,"Ø","\\O",!0),i(_,V,"ˊ","\\'"),i(_,V,"ˋ","\\`"),i(_,V,"ˆ","\\^"),i(_,V,"˜","\\~"),i(_,V,"ˉ","\\="),i(_,V,"˘","\\u"),i(_,V,"˙","\\."),i(_,V,"¸","\\c"),i(_,V,"˚","\\r"),i(_,V,"ˇ","\\v"),i(_,V,"¨",'\\"'),i(_,V,"˝","\\H"),i(o,V,"ˊ","\\'"),i(o,V,"ˋ","\\`"),i(o,V,"ˆ","\\^"),i(o,V,"˜","\\~"),i(o,V,"ˉ","\\="),i(o,V,"˘","\\u"),i(o,V,"˙","\\."),i(o,V,"¸","\\c"),i(o,V,"˚","\\r"),i(o,V,"ˇ","\\v"),i(o,V,"¨",'\\"'),i(o,V,"˝","\\H");const Es={"--":!0,"---":!0,"``":!0,"''":!0};i(_,f,"–","--",!0),i(_,f,"–","\\textendash"),i(_,f,"—","---",!0),i(_,f,"—","\\textemdash"),i(_,f,"‘","`",!0),i(_,f,"‘","\\textquoteleft"),i(_,f,"’","'",!0),i(_,f,"’","\\textquoteright"),i(_,f,"“","``",!0),i(_,f,"“","\\textquotedblleft"),i(_,f,"”","''",!0),i(_,f,"”","\\textquotedblright"),i(o,f,"°","\\degree",!0),i(_,f,"°","\\degree"),i(_,f,"°","\\textdegree",!0),i(o,f,"£","\\pounds"),i(o,f,"£","\\mathsterling",!0),i(_,f,"£","\\pounds"),i(_,f,"£","\\textsterling",!0),i(o,f,"✠","\\maltese"),i(_,f,"✠","\\maltese"),i(o,f,"€","\\euro",!0),i(_,f,"€","\\euro",!0),i(_,f,"€","\\texteuro"),i(o,f,"©","\\copyright",!0),i(_,f,"©","\\textcopyright"),i(o,f,"⌀","\\diameter",!0),i(_,f,"⌀","\\diameter"),i(o,f,"𝛤","\\varGamma"),i(o,f,"𝛥","\\varDelta"),i(o,f,"𝛩","\\varTheta"),i(o,f,"𝛬","\\varLambda"),i(o,f,"𝛯","\\varXi"),i(o,f,"𝛱","\\varPi"),i(o,f,"𝛴","\\varSigma"),i(o,f,"𝛶","\\varUpsilon"),i(o,f,"𝛷","\\varPhi"),i(o,f,"𝛹","\\varPsi"),i(o,f,"𝛺","\\varOmega"),i(_,f,"𝛤","\\varGamma"),i(_,f,"𝛥","\\varDelta"),i(_,f,"𝛩","\\varTheta"),i(_,f,"𝛬","\\varLambda"),i(_,f,"𝛯","\\varXi"),i(_,f,"𝛱","\\varPi"),i(_,f,"𝛴","\\varSigma"),i(_,f,"𝛶","\\varUpsilon"),i(_,f,"𝛷","\\varPhi"),i(_,f,"𝛹","\\varPsi"),i(_,f,"𝛺","\\varOmega");const En='0123456789/@."';for(let t=0;t<En.length;t++){const e=En.charAt(t);i(o,f,e,e)}const In='0123456789!@*()-=+";:?/.,';for(let t=0;t<In.length;t++){const e=In.charAt(t);i(_,f,e,e)}const de="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";for(let t=0;t<de.length;t++){const e=de.charAt(t);i(o,O,e,e),i(_,f,e,e)}const Dn="ÇÐÞçþℂℍℕℙℚℝℤℎℏℊℋℌℐℑℒℓ℘ℛℜℬℰℱℳℭℨ";for(let t=0;t<Dn.length;t++){const e=Dn.charAt(t);i(o,O,e,e),i(_,f,e,e)}let I="";for(let t=0;t<de.length;t++){I=String.fromCharCode(55349,56320+t),i(o,O,I,I),i(_,f,I,I),I=String.fromCharCode(55349,56372+t),i(o,O,I,I),i(_,f,I,I),I=String.fromCharCode(55349,56424+t),i(o,O,I,I),i(_,f,I,I),I=String.fromCharCode(55349,56580+t),i(o,O,I,I),i(_,f,I,I),I=String.fromCharCode(55349,56736+t),i(o,O,I,I),i(_,f,I,I),I=String.fromCharCode(55349,56788+t),i(o,O,I,I),i(_,f,I,I),I=String.fromCharCode(55349,56840+t),i(o,O,I,I),i(_,f,I,I),I=String.fromCharCode(55349,56944+t),i(o,O,I,I),i(_,f,I,I),I=String.fromCharCode(55349,56632+t),i(o,O,I,I),i(_,f,I,I);const e=de.charAt(t);I=String.fromCharCode(55349,56476+t),i(o,O,e,I),i(_,f,e,I)}for(let t=0;t<10;t++)I=String.fromCharCode(55349,57294+t),i(o,O,I,I),i(_,f,I,I),I=String.fromCharCode(55349,57314+t),i(o,O,I,I),i(_,f,I,I),I=String.fromCharCode(55349,57324+t),i(o,O,I,I),i(_,f,I,I),I=String.fromCharCode(55349,57334+t),i(o,O,I,I),i(_,f,I,I);const Is="([{⌊⌈⟨⟮⎰⟦⦃",Ds=")]}⌋⌉⟩⟯⎱⟦⦄";function Ps(t,e,n){const r=[];let s=[],a=[],l=0,u=0,c=0;for(;u<t.length;){for(;t[u]instanceof Be;)t.splice(u,1,...t[u].children);const m=t[u];if(m.attributes&&m.attributes.linebreak&&m.attributes.linebreak==="newline"){a.length>0&&s.push(new y.MathNode("mrow",a)),s.push(m),a=[];const b=new y.MathNode("mtd",s);b.style.textAlign="left",r.push(new y.MathNode("mtr",[b])),s=[],u+=1;continue}if(a.push(m),m.type&&m.type==="mo"&&m.children.length===1&&!Object.hasOwn(m.attributes,"movablelimits")){const b=m.children[0].text;if(Is.indexOf(b)>-1)c+=1;else if(Ds.indexOf(b)>-1)c-=1;else if(c===0&&e==="="&&b==="="){if(l+=1,l>1){a.pop();const A=new y.MathNode("mrow",a);s.push(A),a=[m]}}else if(c===0&&e==="tex"&&b!=="∇"){const A=u<t.length-1?t[u+1]:null;let x=!0;if(!(A&&A.type==="mtext"&&A.attributes.linebreak&&A.attributes.linebreak==="nobreak"))for(let T=u+1;T<t.length;T++){const D=t[T];if(D.type&&D.type==="mspace"&&!(D.attributes.linebreak&&D.attributes.linebreak==="newline"))a.push(D),u+=1,D.attributes&&D.attributes.linebreak&&D.attributes.linebreak==="nobreak"&&(x=!1);else break}if(x){const T=new y.MathNode("mrow",a);s.push(T),a=[]}}}u+=1}if(a.length>0){const m=new y.MathNode("mrow",a);s.push(m)}if(r.length>0){const m=new y.MathNode("mtd",s);m.style.textAlign="left";const b=new y.MathNode("mtr",[m]);r.push(b);const A=new y.MathNode("mtable",r);return n||(A.setAttribute("columnalign","left"),A.setAttribute("rowspacing","0em")),A}return y.newDocumentFragment(s)}const ft=function(t,e,n){return lt[e][t]&&lt[e][t].replace&&t.charCodeAt(0)!==55349&&!(Object.prototype.hasOwnProperty.call(Es,t)&&n&&(n.fontFamily&&n.fontFamily.slice(4,6)==="tt"||n.font&&n.font.slice(4,6)==="tt"))&&(t=lt[e][t].replace),new y.TextNode(t)},Pn=(t,e)=>{if(t.children.length===0||t.children[t.children.length-1].type!=="mtext"){const n=new y.MathNode("mtext",[new y.TextNode(e.children[0].text)]);t.children.push(n)}else t.children[t.children.length-1].children[0].text+=e.children[0].text},Fe=t=>{if(t.type!=="mrow"&&t.type!=="mstyle"||t.children.length===0)return t;const e=new y.MathNode("mrow");for(let n=0;n<t.children.length;n++){const r=t.children[n];if(r.type==="mtext"&&Object.keys(r.attributes).length===0)Pn(e,r);else if(r.type==="mrow"){let s=!0;for(let a=0;a<r.children.length;a++)if(r.children[a].type!=="mtext"||Object.keys(r.attributes).length!==0){s=!1;break}if(s)for(let a=0;a<r.children.length;a++){const l=r.children[a];Pn(e,l)}else e.children.push(r)}else e.children.push(r)}for(let n=0;n<e.children.length;n++)if(e.children[n].type==="mtext"){const r=e.children[n];r.children[0].text.charAt(0)===" "&&(r.children[0].text=" "+r.children[0].text.slice(1));const s=r.children[0].text.length;s>0&&r.children[0].text.charAt(s-1)===" "&&(r.children[0].text=r.children[0].text.slice(0,-1)+" ");for(const[a,l]of Object.entries(t.attributes))r.attributes[a]=l}return e.children.length===1&&e.children[0].type==="mtext"?e.children[0]:e},Bn=/^[0-9]$/,Bs=(t,e)=>(t.type==="textord"&&t.text==="."||t.type==="atom"&&t.text===",")&&t.loc&&e.loc&&t.loc.end===e.loc.start,Ls=t=>{if(t.length<2)return;const e=[];let n=!1;for(let r=0;r<t.length;r++){const s=t[r];s.type==="textord"&&Bn.test(s.text)?(n||e.push({start:r}),n=!0):(n&&(e[e.length-1].end=r-1),n=!1)}n&&(e[e.length-1].end=t.length-1);for(let r=e.length-1;r>0;r--)e[r-1].end===e[r].start-2&&Bs(t[e[r].start-1],t[e[r].start])&&(e[r-1].end=e[r].end,e.splice(r,1));for(let r=e.length-1;r>=0;r--){for(let s=e[r].start+1;s<=e[r].end;s++)t[e[r].start].text+=t[s].text;if(t.splice(e[r].start+1,e[r].end-e[r].start),t.length>e[r].start+1){const s=t[e[r].start+1];s.type==="supsub"&&s.base&&s.base.type==="textord"&&Bn.test(s.base.text)&&(s.base.text=t[e[r].start].text+s.base.text,t.splice(e[r].start,1))}}},ze=function(t,e=!1){if(t.length===1&&!(t[0]instanceof Be))return t[0];if(!e){t[0]instanceof ht&&t[0].type==="mo"&&!t[0].attributes.fence&&(t[0].attributes.lspace="0em",t[0].attributes.rspace="0em");const n=t.length-1;t[n]instanceof ht&&t[n].type==="mo"&&!t[n].attributes.fence&&(t[n].attributes.lspace="0em",t[n].attributes.rspace="0em")}return new y.MathNode("mrow",t)},pe=t=>t.type==="atom"&&t.family==="rel"||t.type==="mclass"&&t.mclass==="mrel",dt=function(t,e,n=!1){if(!n&&t.length===1){const s=tt(t[0],e);return s instanceof ht&&s.type==="mo"&&(s.setAttribute("lspace","0em"),s.setAttribute("rspace","0em")),[s]}Ls(t);const r=[];for(let s=0;s<t.length;s++){const a=tt(t[s],e);s<t.length-1&&pe(t[s])&&pe(t[s+1])&&a.setAttribute("rspace","0em"),s>0&&pe(t[s])&&pe(t[s-1])&&a.setAttribute("lspace","0em"),r.push(a)}return r},Tt=function(t,e,n=!1){return ze(dt(t,e,n),n)},tt=function(t,e){if(!t)return new y.MathNode("mrow");if(ue[t.type])return ue[t.type](t,e);throw new q("Got group of unknown type: '"+t.type+"'")},Ln=t=>new y.MathNode("mtd",[],[],{padding:"0",width:"50%"}),Fs=(t,e,n,r)=>{e=Tt(e[0].body,n),e=Fe(e),e.classes.push("tml-tag"),t=new y.MathNode("mtd",[t]);const s=[Ln(),t,Ln()];s[r?0:2].classes.push(r?"tml-left":"tml-right"),s[r?0:2].children.push(e);const a=new y.MathNode("mtr",s,["tml-tageqn"]),l=new y.MathNode("mtable",[a]);return l.style.width="100%",l.setAttribute("displaystyle","true"),l};function zs(t,e,n,r){let s=null;t.length===1&&t[0].type==="tag"&&(s=t[0].tag,t=t[0].body);const a=dt(t,n),l=r.displayMode||r.annotate?"none":r.wrap,u=a.length===0?null:a[0];let c=a.length===1&&s===null&&u instanceof ht?a[0]:Ps(a,l,r.displayMode);if(s&&(c=Fs(c,s,n,r.leqno)),r.annotate){const b=new y.MathNode("annotation",[new y.TextNode(e)]);b.setAttribute("encoding","application/x-tex"),c=new y.MathNode("semantics",[c,b])}const m=new y.MathNode("math",[c]);return r.xml&&m.setAttribute("xmlns","http://www.w3.org/1998/Math/MathML"),r.displayMode&&(m.setAttribute("display","block"),m.style.display="block math",m.classes=["tml-display"]),m}const Fn="acegıȷmnopqrsuvwxyzαγεηικμνοπρςστυχωϕ𝐚𝐜𝐞𝐠𝐦𝐧𝐨𝐩𝐪𝐫𝐬𝐮𝐯𝐰𝐱𝐲𝐳",js="ABCDEFGHIJKLMNOPQRSTUVWXYZbdfhkltΑΒΓΔΕΖΗΘΙΚΛΜΝΞΟΠΡΣΤΥΦΧΨΩβδλζφθψ𝐀𝐁𝐂𝐃𝐄𝐅𝐆𝐇𝐈𝐉𝐊𝐋𝐌𝐍𝐎𝐏𝐐𝐑𝐒𝐓𝐔𝐕𝐖𝐗𝐘𝐙𝐛𝐝𝐟𝐡𝐤𝐥𝐭",Gs=new Set(["\\alpha","\\gamma","\\delta","\\epsilon","\\eta","\\iota","\\kappa","\\mu","\\nu","\\pi","\\rho","\\sigma","\\tau","\\upsilon","\\chi","\\psi","\\omega","\\imath","\\jmath"]),Rs=new Set(["\\Gamma","\\Delta","\\Sigma","\\Omega","\\beta","\\delta","\\lambda","\\theta","\\psi"]),zn=(t,e)=>{const n=t.isStretchy?he.accentNode(t):new y.MathNode("mo",[ft(t.label,t.mode)]);if(t.label==="\\vec")n.style.transform="scale(0.75) translate(10%, 30%)";else if(n.style.mathStyle="normal",n.style.mathDepth="0",Ws.has(t.label)&&Q.isCharacterBox(t.base)){let s="";const a=t.base.text;(Fn.indexOf(a)>-1||Gs.has(a))&&(s="tml-xshift"),(js.indexOf(a)>-1||Rs.has(a))&&(s="tml-capshift"),s&&n.classes.push(s)}return t.isStretchy||n.setAttribute("stretchy","false"),new y.MathNode(t.label==="\\c"?"munder":"mover",[tt(t.base,e),n])},Us=new Set(["\\acute","\\grave","\\ddot","\\dddot","\\ddddot","\\tilde","\\bar","\\breve","\\check","\\hat","\\vec","\\dot","\\mathring"]),Ws=new Set(["\\acute","\\bar","\\breve","\\check","\\dot","\\ddot","\\grave","\\hat","\\mathring","\\'","\\^","\\~","\\=","\\u","\\.",'\\"',"\\r","\\H","\\v"]),jn={"\\`":"̀","\\'":"́","\\^":"̂","\\~":"̃","\\=":"̄","\\u":"̆","\\.":"̇",'\\"':"̈","\\r":"̊","\\H":"̋","\\v":"̌"};$({type:"accent",names:["\\acute","\\grave","\\ddot","\\dddot","\\ddddot","\\tilde","\\bar","\\breve","\\check","\\hat","\\vec","\\dot","\\mathring","\\overparen","\\widecheck","\\widehat","\\wideparen","\\widetilde","\\overrightarrow","\\overleftarrow","\\Overrightarrow","\\overleftrightarrow","\\overgroup","\\overleftharpoon","\\overrightharpoon"],props:{numArgs:1},handler:(t,e)=>{const n=Xt(e[0]),r=!Us.has(t.funcName);return{type:"accent",mode:t.parser.mode,label:t.funcName,isStretchy:r,base:n}},mathmlBuilder:zn}),$({type:"accent",names:["\\'","\\`","\\^","\\~","\\=","\\c","\\u","\\.",'\\"',"\\r","\\H","\\v"],props:{numArgs:1,allowedInText:!0,allowedInMath:!0,argTypes:["primitive"]},handler:(t,e)=>{const n=Xt(e[0]),r=t.parser.mode;return r==="math"&&t.parser.settings.strict&&console.log(`Temml parse error: Command ${t.funcName} is invalid in math mode.`),r==="text"&&n.text&&n.text.length===1&&t.funcName in jn&&Fn.indexOf(n.text)>-1?{type:"textord",mode:"text",text:n.text+jn[t.funcName]}:{type:"accent",mode:r,label:t.funcName,isStretchy:!1,base:n}},mathmlBuilder:zn}),$({type:"accentUnder",names:["\\underleftarrow","\\underrightarrow","\\underleftrightarrow","\\undergroup","\\underparen","\\utilde"],props:{numArgs:1},handler:({parser:t,funcName:e},n)=>{const r=n[0];return{type:"accentUnder",mode:t.mode,label:e,base:r}},mathmlBuilder:(t,e)=>{const n=he.accentNode(t);return n.style["math-depth"]=0,new y.MathNode("munder",[tt(t.base,e),n])}});const Gn={pt:800/803,pc:12*800/803,dd:1238/1157*800/803,cc:14856/1157*800/803,nd:685/642*800/803,nc:1370/107*800/803,sp:1/65536*800/803,mm:25.4/72,cm:2.54/72,in:1/72,px:96/72},Vs=["em","ex","mu","pt","mm","cm","in","px","bp","pc","dd","cc","nd","nc","sp"],Rn=function(t){return typeof t!="string"&&(t=t.unit),Vs.indexOf(t)>-1},Un=t=>{const e=Math.max(t-1,0);return[1,.7,.5][e]},kt=function(t,e){let n=t.number;if(e.maxSize[0]<0&&n>0)return{number:0,unit:"em"};const r=t.unit;switch(r){case"mm":case"cm":case"in":case"px":return n*Gn[r]>e.maxSize[1]?{number:e.maxSize[1],unit:"pt"}:{number:n,unit:r};case"em":case"ex":return r==="ex"&&(n*=.431),n=Math.min(n/Un(e.level),e.maxSize[0]),{number:Q.round(n),unit:"em"};case"bp":return n>e.maxSize[1]&&(n=e.maxSize[1]),{number:n,unit:"pt"};case"pt":case"pc":case"dd":case"cc":case"nd":case"nc":case"sp":return n=Math.min(n*Gn[r],e.maxSize[1]),{number:Q.round(n),unit:"pt"};case"mu":return n=Math.min(n/18,e.maxSize[0]),{number:Q.round(n),unit:"em"};default:throw new q("Invalid unit: '"+r+"'")}},qt=t=>{const e=new y.MathNode("mspace");return e.setAttribute("width",t+"em"),e},me=(t,e=.3,n=0)=>{if(t==null&&n===0)return qt(e);const r=t?[t]:[];return e!==0&&r.unshift(qt(e)),n>0&&r.push(qt(n)),new y.MathNode("mrow",r)},je=(t,e)=>Number(t)/Un(e),Ge=(t,e,n,r)=>{const s=he.mathMLnode(t),a=t.slice(1,3)==="eq",l=t.charAt(1)==="x"?"1.75":t.slice(2,4)==="cd"?"3.0":a?"1.0":"2.0";s.setAttribute("lspace","0"),s.setAttribute("rspace",a?"0.5em":"0");const u=r.withLevel(r.level<2?2:3),c=je(l,u.level),m=je(l,3),b=me(null,c.toFixed(4),0),A=me(null,m.toFixed(4),0),x=je(a?0:.3,u.level).toFixed(4);let T,D;const j=e&&e.body&&(e.body.body||e.body.length>0);if(j){let E=tt(e,u);E=me(E,x,x),T=new y.MathNode("mover",[E,A])}const rt=n&&n.body&&(n.body.body||n.body.length>0);if(rt){let E=tt(n,u);E=me(E,x,x),D=new y.MathNode("munder",[E,A])}let N;return!j&&!rt?N=new y.MathNode("mover",[s,b]):j&&rt?N=new y.MathNode("munderover",[s,D,T]):j?N=new y.MathNode("mover",[s,T]):N=new y.MathNode("munder",[s,D]),l==="3.0"&&(N.style.height="1em"),N.setAttribute("accent","false"),N};$({type:"xArrow",names:["\\xleftarrow","\\xrightarrow","\\xLeftarrow","\\xRightarrow","\\xleftrightarrow","\\xLeftrightarrow","\\xhookleftarrow","\\xhookrightarrow","\\xmapsto","\\xrightharpoondown","\\xrightharpoonup","\\xleftharpoondown","\\xleftharpoonup","\\xlongequal","\\xtwoheadrightarrow","\\xtwoheadleftarrow","\\yields","\\yieldsLeft","\\mesomerism","\\longrightharpoonup","\\longleftharpoondown","\\\\cdrightarrow","\\\\cdleftarrow","\\\\cdlongequal"],props:{numArgs:1,numOptionalArgs:1},handler({parser:t,funcName:e},n,r){return{type:"xArrow",mode:t.mode,name:e,body:n[0],below:r[0]}},mathmlBuilder(t,e){const r=[Ge(t.name,t.body,t.below,e)];return r.unshift(qt(.2778)),r.push(qt(.2778)),new y.MathNode("mrow",r)}});const Wn={"\\xtofrom":["\\xrightarrow","\\xleftarrow"],"\\xleftrightharpoons":["\\xleftharpoonup","\\xrightharpoondown"],"\\xrightleftharpoons":["\\xrightharpoonup","\\xleftharpoondown"],"\\yieldsLeftRight":["\\yields","\\yieldsLeft"],"\\equilibrium":["\\longrightharpoonup","\\longleftharpoondown"],"\\equilibriumRight":["\\longrightharpoonup","\\eqleftharpoondown"],"\\equilibriumLeft":["\\eqrightharpoonup","\\longleftharpoondown"]};$({type:"stackedArrow",names:["\\xtofrom","\\xleftrightharpoons","\\xrightleftharpoons","\\yieldsLeftRight","\\equilibrium","\\equilibriumRight","\\equilibriumLeft"],props:{numArgs:1,numOptionalArgs:1},handler({parser:t,funcName:e},n,r){const s=n[0]?{type:"hphantom",mode:t.mode,body:n[0]}:null,a=r[0]?{type:"hphantom",mode:t.mode,body:r[0]}:null;return{type:"stackedArrow",mode:t.mode,name:e,body:n[0],upperArrowBelow:a,lowerArrowBody:s,below:r[0]}},mathmlBuilder(t,e){const n=Wn[t.name][0],r=Wn[t.name][1],s=Ge(n,t.body,t.upperArrowBelow,e),a=Ge(r,t.lowerArrowBody,t.below,e);let l;const u=new y.MathNode("mpadded",[s]);if(u.setAttribute("voffset","0.3em"),u.setAttribute("height","+0.3em"),u.setAttribute("depth","-0.3em"),t.name==="\\equilibriumLeft"){const c=new y.MathNode("mpadded",[a]);c.setAttribute("width","0.5em"),l=new y.MathNode("mpadded",[qt(.2778),c,u,qt(.2778)])}else u.setAttribute("width",t.name==="\\equilibriumRight"?"0.5em":"0"),l=new y.MathNode("mpadded",[qt(.2778),u,a,qt(.2778)]);return l.setAttribute("voffset","-0.18em"),l.setAttribute("height","-0.18em"),l.setAttribute("depth","+0.18em"),l}});function F(t,e){if(!t||t.type!==e)throw new Error(`Expected node of type ${e}, but got `+(t?`node of type ${t.type}`:String(t)));return t}function Re(t){const e=fe(t);if(!e)throw new Error("Expected node of symbol group type, but got "+(t?`node of type ${t.type}`:String(t)));return e}function fe(t){return t&&(t.type==="atom"||Object.prototype.hasOwnProperty.call($s,t.type))?t:null}const Hs={">":"\\\\cdrightarrow","<":"\\\\cdleftarrow","=":"\\\\cdlongequal",A:"\\uparrow",V:"\\downarrow","|":"\\Vert",".":"no arrow"},Vn=()=>({type:"styling",body:[],mode:"math",scriptLevel:"display"}),Hn=t=>t.type==="textord"&&t.text==="@",Zs=(t,e)=>(t.type==="mathord"||t.type==="atom")&&t.text===e;function Xs(t,e,n){const r=Hs[t];switch(r){case"\\\\cdrightarrow":case"\\\\cdleftarrow":return n.callFunction(r,[e[0]],[e[1]]);case"\\uparrow":case"\\downarrow":{const s=n.callFunction("\\\\cdleft",[e[0]],[]),a={type:"atom",text:r,mode:"math",family:"rel"},l=n.callFunction("\\Big",[a],[]),u=n.callFunction("\\\\cdright",[e[1]],[]),c={type:"ordgroup",mode:"math",body:[s,l,u],semisimple:!0};return n.callFunction("\\\\cdparent",[c],[])}case"\\\\cdlongequal":return n.callFunction("\\\\cdlongequal",[],[]);case"\\Vert":{const s={type:"textord",text:"\\Vert",mode:"math"};return n.callFunction("\\Big",[s],[])}default:return{type:"textord",text:" ",mode:"math"}}}function Ys(t){const e=[];for(t.gullet.beginGroup(),t.gullet.macros.set("\\cr","\\\\\\relax"),t.gullet.beginGroup();;){e.push(t.parseExpression(!1,"\\\\")),t.gullet.endGroup(),t.gullet.beginGroup();const s=t.fetch().text;if(s==="&"||s==="\\\\")t.consume();else if(s==="\\end"){e[e.length-1].length===0&&e.pop();break}else throw new q("Expected \\\\ or \\cr or \\end",t.nextToken)}let n=[];const r=[n];for(let s=0;s<e.length;s++){const a=e[s];let l=Vn();for(let u=0;u<a.length;u++)if(!Hn(a[u]))l.body.push(a[u]);else{n.push(l),u+=1;const c=Re(a[u]).text,m=new Array(2);if(m[0]={type:"ordgroup",mode:"math",body:[]},m[1]={type:"ordgroup",mode:"math",body:[]},!("=|.".indexOf(c)>-1))if("<>AV".indexOf(c)>-1)for(let A=0;A<2;A++){let x=!0;for(let T=u+1;T<a.length;T++){if(Zs(a[T],c)){x=!1,u=T;break}if(Hn(a[T]))throw new q("Missing a "+c+" character to complete a CD arrow.",a[T]);m[A].body.push(a[T])}if(x)throw new q("Missing a "+c+" character to complete a CD arrow.",a[u])}else throw new q('Expected one of "<>AV=|." after @.');const b=Xs(c,m,t);n.push(b),l=Vn()}s%2===0?n.push(l):n.shift(),n=[],r.push(n)}return r.pop(),t.gullet.endGroup(),t.gullet.endGroup(),{type:"array",mode:"math",body:r,envClasses:["jot","cd"],cols:[],hLinesBeforeRow:new Array(r.length+1).fill([])}}$({type:"cdlabel",names:["\\\\cdleft","\\\\cdright"],props:{numArgs:1},handler({parser:t,funcName:e},n){return{type:"cdlabel",mode:t.mode,side:e.slice(4),label:n[0]}},mathmlBuilder(t,e){let n=new y.MathNode("mrow",[tt(t.label,e)]);return n=new y.MathNode("mpadded",[n]),n.setAttribute("width","0"),t.side==="left"&&n.setAttribute("lspace","-1width"),n.setAttribute("voffset","0.7em"),n=new y.MathNode("mstyle",[n]),n.setAttribute("displaystyle","false"),n.setAttribute("scriptlevel","1"),n}}),$({type:"cdlabelparent",names:["\\\\cdparent"],props:{numArgs:1},handler({parser:t},e){return{type:"cdlabelparent",mode:t.mode,fragment:e[0]}},mathmlBuilder(t,e){return new y.MathNode("mrow",[tt(t.fragment,e)])}}),$({type:"textord",names:["\\@char"],props:{numArgs:1,allowedInText:!0},handler({parser:t,token:e},n){const s=F(n[0],"ordgroup").body;let a="";for(let u=0;u<s.length;u++){const c=F(s[u],"textord");a+=c.text}const l=parseInt(a);if(isNaN(l))throw new q(`\\@char has non-numeric argument ${a}`,e);return{type:"textord",mode:t.mode,text:String.fromCodePoint(l)}}});const Ks=/^(#[a-f0-9]{3}|#?[a-f0-9]{6})$/i,Qs=/^(#[a-f0-9]{3}|#?[a-f0-9]{6}|[a-z]+)$/i,Js=/^ *\d{1,3} *(?:, *\d{1,3} *){2}$/,ti=/^ *[10](?:\.\d*)? *(?:, *[10](?:\.\d*)? *){2}$/,ei=/^[a-f0-9]{6}$/i,Zn=t=>{let e=t.toString(16);return e.length===1&&(e="0"+e),e},Xn=JSON.parse(`{
  "Apricot": "#ffb484",
  "Aquamarine": "#08b4bc",
  "Bittersweet": "#c84c14",
  "blue": "#0000FF",
  "Blue": "#303494",
  "BlueGreen": "#08b4bc",
  "BlueViolet": "#503c94",
  "BrickRed": "#b8341c",
  "brown": "#BF8040",
  "Brown": "#802404",
  "BurntOrange": "#f8941c",
  "CadetBlue": "#78749c",
  "CarnationPink": "#f884b4",
  "Cerulean": "#08a4e4",
  "CornflowerBlue": "#40ace4",
  "cyan": "#00FFFF",
  "Cyan": "#08acec",
  "Dandelion": "#ffbc44",
  "darkgray": "#404040",
  "DarkOrchid": "#a8548c",
  "Emerald": "#08ac9c",
  "ForestGreen": "#089c54",
  "Fuchsia": "#90348c",
  "Goldenrod": "#ffdc44",
  "gray": "#808080",
  "Gray": "#98949c",
  "green": "#00FF00",
  "Green": "#08a44c",
  "GreenYellow": "#e0e474",
  "JungleGreen": "#08ac9c",
  "Lavender": "#f89cc4",
  "lightgray": "#c0c0c0",
  "lime": "#BFFF00",
  "LimeGreen": "#90c43c",
  "magenta": "#FF00FF",
  "Magenta": "#f0048c",
  "Mahogany": "#b0341c",
  "Maroon": "#b03434",
  "Melon": "#f89c7c",
  "MidnightBlue": "#086494",
  "Mulberry": "#b03c94",
  "NavyBlue": "#086cbc",
  "olive": "#7F7F00",
  "OliveGreen": "#407c34",
  "orange": "#FF8000",
  "Orange": "#f8843c",
  "OrangeRed": "#f0145c",
  "Orchid": "#b074ac",
  "Peach": "#f8945c",
  "Periwinkle": "#8074bc",
  "PineGreen": "#088c74",
  "pink": "#ff7f7f",
  "Plum": "#98248c",
  "ProcessBlue": "#08b4ec",
  "purple": "#BF0040",
  "Purple": "#a0449c",
  "RawSienna": "#983c04",
  "red": "#ff0000",
  "Red": "#f01c24",
  "RedOrange": "#f86434",
  "RedViolet": "#a0246c",
  "Rhodamine": "#f0549c",
  "Royallue": "#0874bc",
  "RoyalPurple": "#683c9c",
  "RubineRed": "#f0047c",
  "Salmon": "#f8948c",
  "SeaGreen": "#30bc9c",
  "Sepia": "#701404",
  "SkyBlue": "#48c4dc",
  "SpringGreen": "#c8dc64",
  "Tan": "#e09c74",
  "teal": "#007F7F",
  "TealBlue": "#08acb4",
  "Thistle": "#d884b4",
  "Turquoise": "#08b4cc",
  "violet": "#800080",
  "Violet": "#60449c",
  "VioletRed": "#f054a4",
  "WildStrawberry": "#f0246c",
  "yellow": "#FFFF00",
  "Yellow": "#fff404",
  "YellowGreen": "#98cc6c",
  "YellowOrange": "#ffa41c"
}`),Ut=(t,e)=>{let n="";if(t==="HTML"){if(!Ks.test(e))throw new q("Invalid HTML input.");n=e}else if(t==="RGB"){if(!Js.test(e))throw new q("Invalid RGB input.");e.split(",").map(r=>{n+=Zn(Number(r.trim()))})}else{if(!ti.test(e))throw new q("Invalid rbg input.");e.split(",").map(r=>{const s=Number(r.trim());if(s>1)throw new q("Color rgb input must be < 1.");n+=Zn(Number((s*255).toFixed(0)))})}return n.charAt(0)!=="#"&&(n="#"+n),n},Qt=(t,e,n)=>{const r=`\\\\color@${t}`;if(!Qs.exec(t))throw new q("Invalid color: '"+t+"'",n);return ei.test(t)?"#"+t:(t.charAt(0)==="#"||(e.has(r)?t=e.get(r).tokens[0].text:Xn[t]&&(t=Xn[t])),t)},Yn=(t,e)=>{let n=dt(t.body,e.withColor(t.color));return n=n.map(r=>(r.style.color=t.color,r)),y.newDocumentFragment(n)};$({type:"color",names:["\\textcolor"],props:{numArgs:2,numOptionalArgs:1,allowedInText:!0,argTypes:["raw","raw","original"]},handler({parser:t,token:e},n,r){const s=r[0]&&F(r[0],"raw").string;let a="";if(s){const u=F(n[0],"raw").string;a=Ut(s,u)}else a=Qt(F(n[0],"raw").string,t.gullet.macros,e);const l=n[1];return{type:"color",mode:t.mode,color:a,body:it(l)}},mathmlBuilder:Yn}),$({type:"color",names:["\\color"],props:{numArgs:1,numOptionalArgs:1,allowedInText:!0,argTypes:["raw","raw"]},handler({parser:t,breakOnTokenText:e,token:n},r,s){const a=s[0]&&F(s[0],"raw").string;let l="";if(a){const c=F(r[0],"raw").string;l=Ut(a,c)}else l=Qt(F(r[0],"raw").string,t.gullet.macros,n);const u=t.parseExpression(!0,e,!0);return{type:"color",mode:t.mode,color:l,body:u}},mathmlBuilder:Yn}),$({type:"color",names:["\\definecolor"],props:{numArgs:3,allowedInText:!0,argTypes:["raw","raw","raw"]},handler({parser:t,funcName:e,token:n},r){const s=F(r[0],"raw").string;if(!/^[A-Za-z]+$/.test(s))throw new q("Color name must be latin letters.",n);const a=F(r[1],"raw").string;if(!["HTML","RGB","rgb"].includes(a))throw new q("Color model must be HTML, RGB, or rgb.",n);const l=F(r[2],"raw").string,u=Ut(a,l);return t.gullet.macros.set(`\\\\color@${s}`,{tokens:[{text:u}],numArgs:0}),{type:"internal",mode:t.mode}}}),$({type:"cr",names:["\\\\"],props:{numArgs:0,numOptionalArgs:0,allowedInText:!0},handler({parser:t},e,n){const r=t.gullet.future().text==="["?t.parseSizeGroup(!0):null,s=!t.settings.displayMode;return{type:"cr",mode:t.mode,newLine:s,size:r&&F(r,"size").value}},mathmlBuilder(t,e){const n=new y.MathNode("mo");if(t.newLine&&(n.setAttribute("linebreak","newline"),t.size)){const r=kt(t.size,e);n.setAttribute("height",r.number+r.unit)}return n}});const Ue={"\\global":"\\global","\\long":"\\\\globallong","\\\\globallong":"\\\\globallong","\\def":"\\gdef","\\gdef":"\\gdef","\\edef":"\\xdef","\\xdef":"\\xdef","\\let":"\\\\globallet","\\futurelet":"\\\\globalfuture"},ge=t=>{const e=t.text;if(/^(?:[\\{}$&#^_]|EOF)$/.test(e))throw new q("Expected a control sequence",t);return e},ni=t=>{let e=t.gullet.popToken();return e.text==="="&&(e=t.gullet.popToken(),e.text===" "&&(e=t.gullet.popToken())),e},Kn=(t,e,n,r)=>{let s=t.gullet.macros.get(n.text);s==null&&(n.noexpand=!0,s={tokens:[n],numArgs:0,unexpandable:!t.gullet.isExpandable(n.text)}),t.gullet.macros.set(e,s,r)};$({type:"internal",names:["\\global","\\long","\\\\globallong"],props:{numArgs:0,allowedInText:!0},handler({parser:t,funcName:e}){t.consumeSpaces();const n=t.fetch();if(Ue[n.text])return(e==="\\global"||e==="\\\\globallong")&&(n.text=Ue[n.text]),F(t.parseFunction(),"internal");throw new q("Invalid token after macro prefix",n)}}),$({type:"internal",names:["\\def","\\gdef","\\edef","\\xdef"],props:{numArgs:0,allowedInText:!0,primitive:!0},handler({parser:t,funcName:e}){let n=t.gullet.popToken();const r=n.text;if(/^(?:[\\{}$&#^_]|EOF)$/.test(r))throw new q("Expected a control sequence",n);let s=0,a;const l=[[]];for(;t.gullet.future().text!=="{";)if(n=t.gullet.popToken(),n.text==="#"){if(t.gullet.future().text==="{"){a=t.gullet.future(),l[s].push("{");break}if(n=t.gullet.popToken(),!/^[1-9]$/.test(n.text))throw new q(`Invalid argument number "${n.text}"`);if(parseInt(n.text)!==s+1)throw new q(`Argument number "${n.text}" out of order`);s++,l.push([])}else{if(n.text==="EOF")throw new q("Expected a macro definition");l[s].push(n.text)}let{tokens:u}=t.gullet.consumeArg();if(a&&u.unshift(a),e==="\\edef"||e==="\\xdef"){if(u=t.gullet.expandTokens(u),u.length>t.gullet.settings.maxExpand)throw new q("Too many expansions in an "+e);u.reverse()}return t.gullet.macros.set(r,{tokens:u,numArgs:s,delimiters:l},e===Ue[e]),{type:"internal",mode:t.mode}}}),$({type:"internal",names:["\\let","\\\\globallet"],props:{numArgs:0,allowedInText:!0,primitive:!0},handler({parser:t,funcName:e}){const n=ge(t.gullet.popToken());t.gullet.consumeSpaces();const r=ni(t);return Kn(t,n,r,e==="\\\\globallet"),{type:"internal",mode:t.mode}}}),$({type:"internal",names:["\\futurelet","\\\\globalfuture"],props:{numArgs:0,allowedInText:!0,primitive:!0},handler({parser:t,funcName:e}){const n=ge(t.gullet.popToken()),r=t.gullet.popToken(),s=t.gullet.popToken();return Kn(t,n,s,e==="\\\\globalfuture"),t.gullet.pushToken(s),t.gullet.pushToken(r),{type:"internal",mode:t.mode}}}),$({type:"internal",names:["\\newcommand","\\renewcommand","\\providecommand"],props:{numArgs:0,allowedInText:!0,primitive:!0},handler({parser:t,funcName:e}){let n="";const r=t.gullet.popToken();r.text==="{"?(n=ge(t.gullet.popToken()),t.gullet.popToken()):n=ge(r);const s=t.gullet.isDefined(n);if(s&&e==="\\newcommand")throw new q(`\\newcommand{${n}} attempting to redefine ${n}; use \\renewcommand`);if(!s&&e==="\\renewcommand")throw new q(`\\renewcommand{${n}} when command ${n} does not yet exist; use \\newcommand`);let a=0;if(t.gullet.future().text==="["){let u=t.gullet.popToken();if(u=t.gullet.popToken(),!/^[0-9]$/.test(u.text))throw new q(`Invalid number of arguments: "${u.text}"`);if(a=parseInt(u.text),u=t.gullet.popToken(),u.text!=="]")throw new q(`Invalid argument "${u.text}"`)}const{tokens:l}=t.gullet.consumeArg();return t.gullet.macros.set(n,{tokens:l,numArgs:a}),{type:"internal",mode:t.mode}}});const We={"\\bigl":{mclass:"mopen",size:1},"\\Bigl":{mclass:"mopen",size:2},"\\biggl":{mclass:"mopen",size:3},"\\Biggl":{mclass:"mopen",size:4},"\\bigr":{mclass:"mclose",size:1},"\\Bigr":{mclass:"mclose",size:2},"\\biggr":{mclass:"mclose",size:3},"\\Biggr":{mclass:"mclose",size:4},"\\bigm":{mclass:"mrel",size:1},"\\Bigm":{mclass:"mrel",size:2},"\\biggm":{mclass:"mrel",size:3},"\\Biggm":{mclass:"mrel",size:4},"\\big":{mclass:"mord",size:1},"\\Big":{mclass:"mord",size:2},"\\bigg":{mclass:"mord",size:3},"\\Bigg":{mclass:"mord",size:4}},Qn=["(","\\lparen",")","\\rparen","[","\\lbrack","]","\\rbrack","\\{","\\lbrace","\\}","\\rbrace","⦇","\\llparenthesis","⦈","\\rrparenthesis","\\lfloor","\\rfloor","⌊","⌋","\\lceil","\\rceil","⌈","⌉","<",">","\\langle","⟨","\\rangle","⟩","\\lAngle","⟪","\\rAngle","⟫","\\llangle","⦉","\\rrangle","⦊","\\lt","\\gt","\\lvert","\\rvert","\\lVert","\\rVert","\\lgroup","\\rgroup","⟮","⟯","\\lmoustache","\\rmoustache","⎰","⎱","\\llbracket","\\rrbracket","⟦","⟦","\\lBrace","\\rBrace","⦃","⦄","/","\\backslash","|","\\vert","\\|","\\Vert","\\uparrow","\\Uparrow","\\downarrow","\\Downarrow","\\updownarrow","\\Updownarrow","."],ri=["}","\\left","\\middle","\\right"],be=t=>t.length>0&&(Qn.includes(t)||We[t]||ri.includes(t)),Jn=[0,1.2,1.8,2.4,3];function Jt(t,e){const n=fe(t);if(n&&Qn.includes(n.text))return["/","⁄"].includes(n.text)&&(n.text="∕"),["<","\\lt"].includes(n.text)&&(n.text="⟨"),[">","\\gt"].includes(n.text)&&(n.text="⟩"),n.text==="\\backslash"&&(n.text="∖"),n;throw n?new q(`Invalid delimiter '${n.text}' after '${e.funcName}'`,t):new q(`Invalid delimiter type '${t.type}'`,t)}$({type:"delimsizing",names:["\\bigl","\\Bigl","\\biggl","\\Biggl","\\bigr","\\Bigr","\\biggr","\\Biggr","\\bigm","\\Bigm","\\biggm","\\Biggm","\\big","\\Big","\\bigg","\\Bigg"],props:{numArgs:1,argTypes:["primitive"]},handler:(t,e)=>{const n=Jt(e[0],t);return{type:"delimsizing",mode:t.parser.mode,size:We[t.funcName].size,mclass:We[t.funcName].mclass,delim:n.text}},mathmlBuilder:t=>{const e=[];t.delim==="."&&(t.delim=""),e.push(ft(t.delim,t.mode));const n=new y.MathNode("mo",e);return t.mclass==="mopen"||t.mclass==="mclose"?n.setAttribute("fence","true"):n.setAttribute("fence","false"),(t.delim==="∖"||t.delim==="\\vert"||t.delim==="|"||t.delim.indexOf("arrow")>-1)&&n.setAttribute("stretchy","true"),n.setAttribute("symmetric","true"),n.setAttribute("minsize",Jn[t.size]+"em"),n.setAttribute("maxsize",Jn[t.size]+"em"),n}});function si(t){if(!t.body)throw new Error("Bug: The leftright ParseNode wasn't fully parsed.")}$({type:"leftright-right",names:["\\right"],props:{numArgs:1,argTypes:["primitive"]},handler:(t,e)=>({type:"leftright-right",mode:t.parser.mode,delim:Jt(e[0],t).text})}),$({type:"leftright",names:["\\left"],props:{numArgs:1,argTypes:["primitive"]},handler:(t,e)=>{const n=Jt(e[0],t),r=t.parser;++r.leftrightDepth;let s=r.parseExpression(!1,null,!0),a=r.fetch();for(;a.text==="\\middle";){r.consume();const u=r.fetch().text;if(!lt.math[u])throw new q(`Invalid delimiter '${u}' after '\\middle'`);Jt({type:"atom",mode:"math",text:u},{funcName:"\\middle"}),s.push({type:"middle",mode:"math",delim:u}),r.consume(),s=s.concat(r.parseExpression(!1,null,!0)),a=r.fetch()}--r.leftrightDepth,r.expect("\\right",!1);const l=F(r.parseFunction(),"leftright-right");return{type:"leftright",mode:r.mode,body:s,left:n.text,right:l.delim}},mathmlBuilder:(t,e)=>{si(t);const n=dt(t.body,e);t.left==="."&&(t.left="");const r=new y.MathNode("mo",[ft(t.left,t.mode)]);r.setAttribute("fence","true"),r.setAttribute("form","prefix"),(t.left==="∖"||t.left.indexOf("arrow")>-1)&&r.setAttribute("stretchy","true"),n.unshift(r),t.right==="."&&(t.right="");const s=new y.MathNode("mo",[ft(t.right,t.mode)]);return s.setAttribute("fence","true"),s.setAttribute("form","postfix"),(t.right==="∖"||t.right.indexOf("arrow")>-1)&&s.setAttribute("stretchy","true"),n.push(s),ze(n)}}),$({type:"middle",names:["\\middle"],props:{numArgs:1,argTypes:["primitive"]},handler:(t,e)=>{const n=Jt(e[0],t);if(!t.parser.leftrightDepth)throw new q("\\middle without preceding \\left",n);return{type:"middle",mode:t.parser.mode,delim:n.text}},mathmlBuilder:(t,e)=>{const n=ft(t.delim,t.mode),r=new y.MathNode("mo",[n]);return r.setAttribute("fence","true"),t.delim.indexOf("arrow")>-1&&r.setAttribute("stretchy","true"),r.setAttribute("form","prefix"),r.setAttribute("lspace","0.05em"),r.setAttribute("rspace","0.05em"),r}});const tr=t=>{const e=new y.MathNode("mspace");return e.setAttribute("width","3pt"),e},te=(t,e)=>{let n;switch(t.label.indexOf("colorbox")>-1||t.label==="\\boxed"?n=new y.MathNode("mrow",[tr(),tt(t.body,e),tr()]):n=new y.MathNode("menclose",[tt(t.body,e)]),t.label){case"\\overline":n.setAttribute("notation","top"),n.classes.push("tml-overline");break;case"\\underline":n.setAttribute("notation","bottom"),n.classes.push("tml-underline");break;case"\\cancel":n.setAttribute("notation","updiagonalstrike"),n.children.push(new y.MathNode("mrow",[],["tml-cancel","upstrike"]));break;case"\\bcancel":n.setAttribute("notation","downdiagonalstrike"),n.children.push(new y.MathNode("mrow",[],["tml-cancel","downstrike"]));break;case"\\sout":n.setAttribute("notation","horizontalstrike"),n.children.push(new y.MathNode("mrow",[],["tml-cancel","sout"]));break;case"\\xcancel":n.setAttribute("notation","updiagonalstrike downdiagonalstrike"),n.classes.push("tml-xcancel");break;case"\\longdiv":n.setAttribute("notation","longdiv"),n.classes.push("longdiv-top"),n.children.push(new y.MathNode("mrow",[],["longdiv-arc"]));break;case"\\phase":n.setAttribute("notation","phasorangle"),n.classes.push("phasor-bottom"),n.children.push(new y.MathNode("mrow",[],["phasor-angle"]));break;case"\\textcircled":n.setAttribute("notation","circle"),n.classes.push("circle-pad"),n.children.push(new y.MathNode("mrow",[],["textcircle"]));break;case"\\angl":n.setAttribute("notation","actuarial"),n.classes.push("actuarial");break;case"\\boxed":n.setAttribute("notation","box"),n.classes.push("tml-box"),n.setAttribute("scriptlevel","0"),n.setAttribute("displaystyle","true");break;case"\\fbox":n.setAttribute("notation","box"),n.classes.push("tml-fbox");break;case"\\fcolorbox":case"\\colorbox":{const r={padding:"3pt 0 3pt 0"};t.label==="\\fcolorbox"&&(r.border="0.0667em solid "+String(t.borderColor)),n.style=r;break}}return t.backgroundColor&&n.setAttribute("mathbackground",t.backgroundColor),n};$({type:"enclose",names:["\\colorbox"],props:{numArgs:2,numOptionalArgs:1,allowedInText:!0,argTypes:["raw","raw","text"]},handler({parser:t,funcName:e},n,r){const s=r[0]&&F(r[0],"raw").string;let a="";if(s){const u=F(n[0],"raw").string;a=Ut(s,u)}else a=Qt(F(n[0],"raw").string,t.gullet.macros);const l=n[1];return{type:"enclose",mode:t.mode,label:e,backgroundColor:a,body:l}},mathmlBuilder:te}),$({type:"enclose",names:["\\fcolorbox"],props:{numArgs:3,numOptionalArgs:1,allowedInText:!0,argTypes:["raw","raw","raw","text"]},handler({parser:t,funcName:e},n,r){const s=r[0]&&F(r[0],"raw").string;let a="",l;if(s){const c=F(n[0],"raw").string,m=F(n[0],"raw").string;a=Ut(s,c),l=Ut(s,m)}else a=Qt(F(n[0],"raw").string,t.gullet.macros),l=Qt(F(n[1],"raw").string,t.gullet.macros);const u=n[2];return{type:"enclose",mode:t.mode,label:e,backgroundColor:l,borderColor:a,body:u}},mathmlBuilder:te}),$({type:"enclose",names:["\\fbox"],props:{numArgs:1,argTypes:["hbox"],allowedInText:!0},handler({parser:t},e){return{type:"enclose",mode:t.mode,label:"\\fbox",body:e[0]}}}),$({type:"enclose",names:["\\angl","\\cancel","\\bcancel","\\xcancel","\\sout","\\overline","\\boxed","\\longdiv","\\phase"],props:{numArgs:1},handler({parser:t,funcName:e},n){const r=n[0];return{type:"enclose",mode:t.mode,label:e,body:r}},mathmlBuilder:te}),$({type:"enclose",names:["\\underline"],props:{numArgs:1,allowedInText:!0},handler({parser:t,funcName:e},n){const r=n[0];return{type:"enclose",mode:t.mode,label:e,body:r}},mathmlBuilder:te}),$({type:"enclose",names:["\\textcircled"],props:{numArgs:1,argTypes:["text"],allowedInArgument:!0,allowedInText:!0},handler({parser:t,funcName:e},n){const r=n[0];return{type:"enclose",mode:t.mode,label:e,body:r}},mathmlBuilder:te});const er={};function wt({type:t,names:e,props:n,handler:r,mathmlBuilder:s}){const a={type:t,numArgs:n.numArgs||0,allowedInText:!1,numOptionalArgs:0,handler:r};for(let l=0;l<e.length;++l)er[e[l]]=a;s&&(ue[t]=s)}const ct={DISPLAY:0,TEXT:1,SCRIPT:2,SCRIPTSCRIPT:3},nr={};function h(t,e){nr[t]=e}const ii=nr;h("\\noexpand",function(t){const e=t.popToken();return t.isExpandable(e.text)&&(e.noexpand=!0,e.treatAsRelax=!0),{tokens:[e],numArgs:0}}),h("\\expandafter",function(t){const e=t.popToken();return t.expandOnce(!0),{tokens:[e],numArgs:0}}),h("\\@firstoftwo",function(t){return{tokens:t.consumeArgs(2)[0],numArgs:0}}),h("\\@secondoftwo",function(t){return{tokens:t.consumeArgs(2)[1],numArgs:0}}),h("\\@ifnextchar",function(t){const e=t.consumeArgs(3);t.consumeSpaces();const n=t.future();return e[0].length===1&&e[0][0].text===n.text?{tokens:e[1],numArgs:0}:{tokens:e[2],numArgs:0}}),h("\\@ifstar","\\@ifnextchar *{\\@firstoftwo{#1}}"),h("\\TextOrMath",function(t){const e=t.consumeArgs(2);return t.mode==="text"?{tokens:e[0],numArgs:0}:{tokens:e[1],numArgs:0}});const Ve=t=>{let e="";for(let n=t.length-1;n>-1;n--)e+=t[n].text;return e},He={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,a:10,A:10,b:11,B:11,c:12,C:12,d:13,D:13,e:14,E:14,f:15,F:15},rr=t=>{const e=t.future().text;return e==="EOF"?[null,""]:[He[e.charAt(0)],e]},sr=(t,e,n)=>{for(let r=1;r<e.length;r++){const s=He[e.charAt(r)];t*=n,t+=s}return t};h("\\char",function(t){let e=t.popToken(),n,r="";if(e.text==="'")n=8,e=t.popToken();else if(e.text==='"')n=16,e=t.popToken();else if(e.text==="`")if(e=t.popToken(),e.text[0]==="\\")r=e.text.charCodeAt(1);else{if(e.text==="EOF")throw new q("\\char` missing argument");r=e.text.charCodeAt(0)}else n=10;if(n){let s=e.text;if(r=He[s.charAt(0)],r==null||r>=n)throw new q(`Invalid base-${n} digit ${e.text}`);r=sr(r,s,n);let a;for([a,s]=rr(t);a!=null&&a<n;)r*=n,r+=a,r=sr(r,s,n),t.popToken(),[a,s]=rr(t)}return`\\@char{${r}}`});function Ze(t){const e=t.consumeArgs(1)[0];let n="",r=e[e.length-1].loc.start;for(let s=e.length-1;s>=0;s--){const a=e[s].loc.start;a>r&&(n+=" ",r=a),n+=e[s].text,r+=e[s].text.length}return n}h("\\surd","\\sqrt{\\vphantom{|}}"),h("⊕","\\oplus"),h("\\long",""),h("\\bgroup","{"),h("\\egroup","}"),h("~","\\nobreakspace"),h("\\lq","`"),h("\\rq","'"),h("\\aa","\\r a"),h("\\Bbbk","\\Bbb{k}"),h("\\mathstrut","\\vphantom{(}"),h("\\underbar","\\underline{\\text{#1}}"),h("\\vdots","{\\varvdots\\rule{0pt}{15pt}}"),h("⋮","\\vdots"),h("\\arraystretch","1"),h("\\arraycolsep","6pt"),h("\\substack","\\begin{subarray}{c}#1\\end{subarray}"),h("\\iff","\\DOTSB\\;\\Longleftrightarrow\\;"),h("\\implies","\\DOTSB\\;\\Longrightarrow\\;"),h("\\impliedby","\\DOTSB\\;\\Longleftarrow\\;");const ir={",":"\\dotsc","\\not":"\\dotsb","+":"\\dotsb","=":"\\dotsb","<":"\\dotsb",">":"\\dotsb","-":"\\dotsb","*":"\\dotsb",":":"\\dotsb","\\DOTSB":"\\dotsb","\\coprod":"\\dotsb","\\bigvee":"\\dotsb","\\bigwedge":"\\dotsb","\\biguplus":"\\dotsb","\\bigcap":"\\dotsb","\\bigcup":"\\dotsb","\\prod":"\\dotsb","\\sum":"\\dotsb","\\bigotimes":"\\dotsb","\\bigoplus":"\\dotsb","\\bigodot":"\\dotsb","\\bigsqcap":"\\dotsb","\\bigsqcup":"\\dotsb","\\bigtimes":"\\dotsb","\\And":"\\dotsb","\\longrightarrow":"\\dotsb","\\Longrightarrow":"\\dotsb","\\longleftarrow":"\\dotsb","\\Longleftarrow":"\\dotsb","\\longleftrightarrow":"\\dotsb","\\Longleftrightarrow":"\\dotsb","\\mapsto":"\\dotsb","\\longmapsto":"\\dotsb","\\hookrightarrow":"\\dotsb","\\doteq":"\\dotsb","\\mathbin":"\\dotsb","\\mathrel":"\\dotsb","\\relbar":"\\dotsb","\\Relbar":"\\dotsb","\\xrightarrow":"\\dotsb","\\xleftarrow":"\\dotsb","\\DOTSI":"\\dotsi","\\int":"\\dotsi","\\oint":"\\dotsi","\\iint":"\\dotsi","\\iiint":"\\dotsi","\\iiiint":"\\dotsi","\\idotsint":"\\dotsi","\\DOTSX":"\\dotsx"};h("\\dots",function(t){let e="\\dotso";const n=t.expandAfterFuture().text;return n in ir?e=ir[n]:(n.slice(0,4)==="\\not"||n in lt.math&&["bin","rel"].includes(lt.math[n].group))&&(e="\\dotsb"),e});const Xe={")":!0,"]":!0,"\\rbrack":!0,"\\}":!0,"\\rbrace":!0,"\\rangle":!0,"\\rceil":!0,"\\rfloor":!0,"\\rgroup":!0,"\\rmoustache":!0,"\\right":!0,"\\bigr":!0,"\\biggr":!0,"\\Bigr":!0,"\\Biggr":!0,$:!0,";":!0,".":!0,",":!0};h("\\dotso",function(t){return t.future().text in Xe?"\\ldots\\,":"\\ldots"}),h("\\dotsc",function(t){const e=t.future().text;return e in Xe&&e!==","?"\\ldots\\,":"\\ldots"}),h("\\cdots",function(t){return t.future().text in Xe?"\\@cdots\\,":"\\@cdots"}),h("\\dotsb","\\cdots"),h("\\dotsm","\\cdots"),h("\\dotsi","\\!\\cdots"),h("\\idotsint","\\dotsi"),h("\\dotsx","\\ldots\\,"),h("\\DOTSI","\\relax"),h("\\DOTSB","\\relax"),h("\\DOTSX","\\relax"),h("\\tmspace","\\TextOrMath{\\kern#1#3}{\\mskip#1#2}\\relax"),h("\\,","{\\tmspace+{3mu}{.1667em}}"),h("\\thinspace","\\,"),h("\\>","\\mskip{4mu}"),h("\\:","{\\tmspace+{4mu}{.2222em}}"),h("\\medspace","\\:"),h("\\;","{\\tmspace+{5mu}{.2777em}}"),h("\\thickspace","\\;"),h("\\!","{\\tmspace-{3mu}{.1667em}}"),h("\\negthinspace","\\!"),h("\\negmedspace","{\\tmspace-{4mu}{.2222em}}"),h("\\negthickspace","{\\tmspace-{5mu}{.277em}}"),h("\\enspace","\\kern.5em "),h("\\enskip","\\hskip.5em\\relax"),h("\\quad","\\hskip1em\\relax"),h("\\qquad","\\hskip2em\\relax"),h("\\AA","\\TextOrMath{\\Angstrom}{\\mathring{A}}\\relax"),h("\\tag","\\@ifstar\\tag@literal\\tag@paren"),h("\\tag@paren","\\tag@literal{({#1})}"),h("\\tag@literal",t=>{if(t.macros.get("\\df@tag"))throw new q("Multiple \\tag");return"\\def\\df@tag{\\text{#1}}"}),h("\\bmod","\\mathbin{\\text{mod}}"),h("\\pod","\\allowbreak\\mathchoice{\\mkern18mu}{\\mkern8mu}{\\mkern8mu}{\\mkern8mu}(#1)"),h("\\pmod","\\pod{{\\rm mod}\\mkern6mu#1}"),h("\\mod","\\allowbreak\\mathchoice{\\mkern18mu}{\\mkern12mu}{\\mkern12mu}{\\mkern12mu}{\\rm mod}\\,\\,#1"),h("\\newline","\\\\\\relax"),h("\\TeX","\\textrm{T}\\kern-.1667em\\raisebox{-.5ex}{E}\\kern-.125em\\textrm{X}"),h("\\LaTeX","\\textrm{L}\\kern-.35em\\raisebox{0.2em}{\\scriptstyle A}\\kern-.15em\\TeX"),h("\\Temml","\\textrm{T}\\kern-0.2em\\lower{0.2em}{\\textrm{E}}\\kern-0.08em{\\textrm{M}\\kern-0.08em\\raise{0.2em}\\textrm{M}\\kern-0.08em\\textrm{L}}"),h("\\hspace","\\@ifstar\\@hspacer\\@hspace"),h("\\@hspace","\\hskip #1\\relax"),h("\\@hspacer","\\rule{0pt}{0pt}\\hskip #1\\relax"),h("\\colon",'\\mathpunct{\\char"3a}'),h("\\prescript","\\pres@cript{_{#1}^{#2}}{}{#3}"),h("\\ordinarycolon",'\\char"3a'),h("\\vcentcolon","\\mathrel{\\raisebox{0.035em}{\\ordinarycolon}}"),h("\\coloneq",'\\mathrel{\\raisebox{0.035em}{\\ordinarycolon}\\char"2212}'),h("\\Coloneq",'\\mathrel{\\char"2237\\char"2212}'),h("\\Eqqcolon",'\\mathrel{\\char"3d\\char"2237}'),h("\\Eqcolon",'\\mathrel{\\char"2212\\char"2237}'),h("\\colonapprox",'\\mathrel{\\raisebox{0.035em}{\\ordinarycolon}\\char"2248}'),h("\\Colonapprox",'\\mathrel{\\char"2237\\char"2248}'),h("\\colonsim",'\\mathrel{\\raisebox{0.035em}{\\ordinarycolon}\\char"223c}'),h("\\Colonsim",'\\mathrel{\\raisebox{0.035em}{\\ordinarycolon}\\char"223c}'),h("\\ratio","\\vcentcolon"),h("\\coloncolon","\\dblcolon"),h("\\colonequals","\\coloneqq"),h("\\coloncolonequals","\\Coloneqq"),h("\\equalscolon","\\eqqcolon"),h("\\equalscoloncolon","\\Eqqcolon"),h("\\colonminus","\\coloneq"),h("\\coloncolonminus","\\Coloneq"),h("\\minuscolon","\\eqcolon"),h("\\minuscoloncolon","\\Eqcolon"),h("\\coloncolonapprox","\\Colonapprox"),h("\\coloncolonsim","\\Colonsim"),h("\\notni","\\mathrel{\\char`∌}"),h("\\limsup","\\DOTSB\\operatorname*{lim\\,sup}"),h("\\liminf","\\DOTSB\\operatorname*{lim\\,inf}"),h("\\injlim","\\DOTSB\\operatorname*{inj\\,lim}"),h("\\projlim","\\DOTSB\\operatorname*{proj\\,lim}"),h("\\varlimsup","\\DOTSB\\operatorname*{\\overline{\\text{lim}}}"),h("\\varliminf","\\DOTSB\\operatorname*{\\underline{\\text{lim}}}"),h("\\varinjlim","\\DOTSB\\operatorname*{\\underrightarrow{\\text{lim}}}"),h("\\varprojlim","\\DOTSB\\operatorname*{\\underleftarrow{\\text{lim}}}"),h("\\centerdot","{\\medspace\\rule{0.167em}{0.189em}\\medspace}"),h("\\argmin","\\DOTSB\\operatorname*{arg\\,min}"),h("\\argmax","\\DOTSB\\operatorname*{arg\\,max}"),h("\\plim","\\DOTSB\\operatorname*{plim}"),h("\\leftmodels","\\mathop{\\reflectbox{$\\models$}}"),h("\\bra","\\mathinner{\\langle{#1}|}"),h("\\ket","\\mathinner{|{#1}\\rangle}"),h("\\braket","\\mathinner{\\langle{#1}\\rangle}"),h("\\Bra","\\left\\langle#1\\right|"),h("\\Ket","\\left|#1\\right\\rangle");const ar=(t,e)=>{const r=`}\\,\\middle${e[0]==="|"?"\\vert":"\\Vert"}\\,{`;return t.slice(0,e.index)+r+t.slice(e.index+e[0].length)};h("\\Braket",function(t){let e=Ze(t);const n=/\|\||\||\\\|/g;let r;for(;(r=n.exec(e))!==null;)e=ar(e,r);return"\\left\\langle{"+e+"}\\right\\rangle"}),h("\\Set",function(t){let e=Ze(t);const n=/\|\||\||\\\|/.exec(e);return n&&(e=ar(e,n)),"\\left\\{\\:{"+e+"}\\:\\right\\}"}),h("\\set",function(t){return"\\{{"+Ze(t).replace(/\|/,"}\\mid{")+"}\\}"}),h("\\angln","{\\angl n}"),h("\\odv","\\@ifstar\\odv@next\\odv@numerator"),h("\\odv@numerator","\\frac{\\mathrm{d}#1}{\\mathrm{d}#2}"),h("\\odv@next","\\frac{\\mathrm{d}}{\\mathrm{d}#2}#1"),h("\\pdv","\\@ifstar\\pdv@next\\pdv@numerator");const or=t=>{const e=t[0][0].text,n=Ve(t[1]).split(","),r=String(n.length),s=r==="1"?"\\partial":`\\partial^${r}`;let a="";return n.map(l=>{a+="\\partial "+l.trim()+"\\,"}),[e,s,a.replace(/\\,$/,"")]};h("\\pdv@numerator",function(t){const[e,n,r]=or(t.consumeArgs(2));return`\\frac{${n} ${e}}{${r}}`}),h("\\pdv@next",function(t){const[e,n,r]=or(t.consumeArgs(2));return`\\frac{${n}}{${r}} ${e}`}),h("\\upalpha","\\up@greek{\\alpha}"),h("\\upbeta","\\up@greek{\\beta}"),h("\\upgamma","\\up@greek{\\gamma}"),h("\\updelta","\\up@greek{\\delta}"),h("\\upepsilon","\\up@greek{\\epsilon}"),h("\\upzeta","\\up@greek{\\zeta}"),h("\\upeta","\\up@greek{\\eta}"),h("\\uptheta","\\up@greek{\\theta}"),h("\\upiota","\\up@greek{\\iota}"),h("\\upkappa","\\up@greek{\\kappa}"),h("\\uplambda","\\up@greek{\\lambda}"),h("\\upmu","\\up@greek{\\mu}"),h("\\upnu","\\up@greek{\\nu}"),h("\\upxi","\\up@greek{\\xi}"),h("\\upomicron","\\up@greek{\\omicron}"),h("\\uppi","\\up@greek{\\pi}"),h("\\upalpha","\\up@greek{\\alpha}"),h("\\uprho","\\up@greek{\\rho}"),h("\\upsigma","\\up@greek{\\sigma}"),h("\\uptau","\\up@greek{\\tau}"),h("\\upupsilon","\\up@greek{\\upsilon}"),h("\\upphi","\\up@greek{\\phi}"),h("\\upchi","\\up@greek{\\chi}"),h("\\uppsi","\\up@greek{\\psi}"),h("\\upomega","\\up@greek{\\omega}"),h("\\invamp",'\\mathbin{\\char"214b}'),h("\\parr",'\\mathbin{\\char"214b}'),h("\\with",'\\mathbin{\\char"26}'),h("\\multimapinv",'\\mathrel{\\char"27dc}'),h("\\multimapboth",'\\mathrel{\\char"29df}'),h("\\scoh",'{\\mkern5mu\\char"2322\\mkern5mu}'),h("\\sincoh",'{\\mkern5mu\\char"2323\\mkern5mu}'),h("\\coh",`{\\mkern5mu\\rule{}{0.7em}\\mathrlap{\\smash{\\raise2mu{\\char"2322}}}
{\\smash{\\lower4mu{\\char"2323}}}\\mkern5mu}`),h("\\incoh",`{\\mkern5mu\\rule{}{0.7em}\\mathrlap{\\smash{\\raise2mu{\\char"2323}}}
{\\smash{\\lower4mu{\\char"2322}}}\\mkern5mu}`),h("\\standardstate","\\text{\\tiny\\char`⦵}"),h("\\ce",function(t){return lr(t.consumeArgs(1)[0],"ce")}),h("\\pu",function(t){return lr(t.consumeArgs(1)[0],"pu")}),h("\\uniDash","{\\rule{0.672em}{0.06em}}"),h("\\triDash","{\\rule{0.15em}{0.06em}\\kern2mu\\rule{0.15em}{0.06em}\\kern2mu\\rule{0.15em}{0.06em}}"),h("\\tripleDash","\\kern0.075em\\raise0.25em{\\triDash}\\kern0.075em"),h("\\tripleDashOverLine","\\kern0.075em\\mathrlap{\\raise0.125em{\\uniDash}}\\raise0.34em{\\triDash}\\kern0.075em"),h("\\tripleDashOverDoubleLine","\\kern0.075em\\mathrlap{\\mathrlap{\\raise0.48em{\\triDash}}\\raise0.27em{\\uniDash}}{\\raise0.05em{\\uniDash}}\\kern0.075em"),h("\\tripleDashBetweenDoubleLine","\\kern0.075em\\mathrlap{\\mathrlap{\\raise0.48em{\\uniDash}}\\raise0.27em{\\triDash}}{\\raise0.05em{\\uniDash}}\\kern0.075em");var lr=function(t,e){for(var n="",r=t.length&&t[t.length-1].loc.start,s=t.length-1;s>=0;s--)t[s].loc.start>r&&(n+=" ",r=t[s].loc.start),n+=t[s].text,r+=t[s].text.length;var a=nt.go(C.go(n,e));return a},C={go:function(t,e){if(!t)return[];e===void 0&&(e="ce");var n="0",r={};r.parenthesisLevel=0,t=t.replace(/\n/g," "),t=t.replace(/[\u2212\u2013\u2014\u2010]/g,"-"),t=t.replace(/[\u2026]/g,"...");for(var s,a=10,l=[];;){s!==t?(a=10,s=t):a--;var u=C.stateMachines[e],c=u.transitions[n]||u.transitions["*"];t:for(var m=0;m<c.length;m++){var b=C.patterns.match_(c[m].pattern,t);if(b){for(var A=c[m].task,x=0;x<A.action_.length;x++){var T;if(u.actions[A.action_[x].type_])T=u.actions[A.action_[x].type_](r,b.match_,A.action_[x].option);else if(C.actions[A.action_[x].type_])T=C.actions[A.action_[x].type_](r,b.match_,A.action_[x].option);else throw["MhchemBugA","mhchem bug A. Please report. ("+A.action_[x].type_+")"];C.concatArray(l,T)}if(n=A.nextState||n,t.length>0){if(A.revisit||(t=b.remainder),!A.toContinue)break t}else return l}}if(a<=0)throw["MhchemBugU","mhchem bug U. Please report."]}},concatArray:function(t,e){if(e)if(Array.isArray(e))for(var n=0;n<e.length;n++)t.push(e[n]);else t.push(e)},patterns:{patterns:{empty:/^$/,else:/^./,else2:/^./,space:/^\s/,"space A":/^\s(?=[A-Z\\$])/,space$:/^\s$/,"a-z":/^[a-z]/,x:/^x/,x$:/^x$/,i$:/^i$/,letters:/^(?:[a-zA-Z\u03B1-\u03C9\u0391-\u03A9?@]|(?:\\(?:alpha|beta|gamma|delta|epsilon|zeta|eta|theta|iota|kappa|lambda|mu|nu|xi|omicron|pi|rho|sigma|tau|upsilon|phi|chi|psi|omega|Gamma|Delta|Theta|Lambda|Xi|Pi|Sigma|Upsilon|Phi|Psi|Omega)(?:\s+|\{\}|(?![a-zA-Z]))))+/,"\\greek":/^\\(?:alpha|beta|gamma|delta|epsilon|zeta|eta|theta|iota|kappa|lambda|mu|nu|xi|omicron|pi|rho|sigma|tau|upsilon|phi|chi|psi|omega|Gamma|Delta|Theta|Lambda|Xi|Pi|Sigma|Upsilon|Phi|Psi|Omega)(?:\s+|\{\}|(?![a-zA-Z]))/,"one lowercase latin letter $":/^(?:([a-z])(?:$|[^a-zA-Z]))$/,"$one lowercase latin letter$ $":/^\$(?:([a-z])(?:$|[^a-zA-Z]))\$$/,"one lowercase greek letter $":/^(?:\$?[\u03B1-\u03C9]\$?|\$?\\(?:alpha|beta|gamma|delta|epsilon|zeta|eta|theta|iota|kappa|lambda|mu|nu|xi|omicron|pi|rho|sigma|tau|upsilon|phi|chi|psi|omega)\s*\$?)(?:\s+|\{\}|(?![a-zA-Z]))$/,digits:/^[0-9]+/,"-9.,9":/^[+\-]?(?:[0-9]+(?:[,.][0-9]+)?|[0-9]*(?:\.[0-9]+))/,"-9.,9 no missing 0":/^[+\-]?[0-9]+(?:[.,][0-9]+)?/,"(-)(9.,9)(e)(99)":function(t){var e=t.match(/^(\+\-|\+\/\-|\+|\-|\\pm\s?)?([0-9]+(?:[,.][0-9]+)?|[0-9]*(?:\.[0-9]+))?(\((?:[0-9]+(?:[,.][0-9]+)?|[0-9]*(?:\.[0-9]+))\))?(?:([eE]|\s*(\*|x|\\times|\u00D7)\s*10\^)([+\-]?[0-9]+|\{[+\-]?[0-9]+\}))?/);return e&&e[0]?{match_:e.splice(1),remainder:t.substr(e[0].length)}:null},"(-)(9)^(-9)":function(t){var e=t.match(/^(\+\-|\+\/\-|\+|\-|\\pm\s?)?([0-9]+(?:[,.][0-9]+)?|[0-9]*(?:\.[0-9]+)?)\^([+\-]?[0-9]+|\{[+\-]?[0-9]+\})/);return e&&e[0]?{match_:e.splice(1),remainder:t.substr(e[0].length)}:null},"state of aggregation $":function(t){var e=C.patterns.findObserveGroups(t,"",/^\([a-z]{1,3}(?=[\),])/,")","");if(e&&e.remainder.match(/^($|[\s,;\)\]\}])/))return e;var n=t.match(/^(?:\((?:\\ca\s?)?\$[amothc]\$\))/);return n?{match_:n[0],remainder:t.substr(n[0].length)}:null},"_{(state of aggregation)}$":/^_\{(\([a-z]{1,3}\))\}/,"{[(":/^(?:\\\{|\[|\()/,")]}":/^(?:\)|\]|\\\})/,", ":/^[,;]\s*/,",":/^[,;]/,".":/^[.]/,". ":/^([.\u22C5\u00B7\u2022])\s*/,"...":/^\.\.\.(?=$|[^.])/,"* ":/^([*])\s*/,"^{(...)}":function(t){return C.patterns.findObserveGroups(t,"^{","","","}")},"^($...$)":function(t){return C.patterns.findObserveGroups(t,"^","$","$","")},"^a":/^\^([0-9]+|[^\\_])/,"^\\x{}{}":function(t){return C.patterns.findObserveGroups(t,"^",/^\\[a-zA-Z]+\{/,"}","","","{","}","",!0)},"^\\x{}":function(t){return C.patterns.findObserveGroups(t,"^",/^\\[a-zA-Z]+\{/,"}","")},"^\\x":/^\^(\\[a-zA-Z]+)\s*/,"^(-1)":/^\^(-?\d+)/,"'":/^'/,"_{(...)}":function(t){return C.patterns.findObserveGroups(t,"_{","","","}")},"_($...$)":function(t){return C.patterns.findObserveGroups(t,"_","$","$","")},_9:/^_([+\-]?[0-9]+|[^\\])/,"_\\x{}{}":function(t){return C.patterns.findObserveGroups(t,"_",/^\\[a-zA-Z]+\{/,"}","","","{","}","",!0)},"_\\x{}":function(t){return C.patterns.findObserveGroups(t,"_",/^\\[a-zA-Z]+\{/,"}","")},"_\\x":/^_(\\[a-zA-Z]+)\s*/,"^_":/^(?:\^(?=_)|\_(?=\^)|[\^_]$)/,"{}":/^\{\}/,"{...}":function(t){return C.patterns.findObserveGroups(t,"","{","}","")},"{(...)}":function(t){return C.patterns.findObserveGroups(t,"{","","","}")},"$...$":function(t){return C.patterns.findObserveGroups(t,"","$","$","")},"${(...)}$":function(t){return C.patterns.findObserveGroups(t,"${","","","}$")},"$(...)$":function(t){return C.patterns.findObserveGroups(t,"$","","","$")},"=<>":/^[=<>]/,"#":/^[#\u2261]/,"+":/^\+/,"-$":/^-(?=[\s_},;\]/]|$|\([a-z]+\))/,"-9":/^-(?=[0-9])/,"- orbital overlap":/^-(?=(?:[spd]|sp)(?:$|[\s,;\)\]\}]))/,"-":/^-/,"pm-operator":/^(?:\\pm|\$\\pm\$|\+-|\+\/-)/,operator:/^(?:\+|(?:[\-=<>]|<<|>>|\\approx|\$\\approx\$)(?=\s|$|-?[0-9]))/,arrowUpDown:/^(?:v|\(v\)|\^|\(\^\))(?=$|[\s,;\)\]\}])/,"\\bond{(...)}":function(t){return C.patterns.findObserveGroups(t,"\\bond{","","","}")},"->":/^(?:<->|<-->|->|<-|<=>>|<<=>|<=>|[\u2192\u27F6\u21CC])/,CMT:/^[CMT](?=\[)/,"[(...)]":function(t){return C.patterns.findObserveGroups(t,"[","","","]")},"1st-level escape":/^(&|\\\\|\\hline)\s*/,"\\,":/^(?:\\[,\ ;:])/,"\\x{}{}":function(t){return C.patterns.findObserveGroups(t,"",/^\\[a-zA-Z]+\{/,"}","","","{","}","",!0)},"\\x{}":function(t){return C.patterns.findObserveGroups(t,"",/^\\[a-zA-Z]+\{/,"}","")},"\\ca":/^\\ca(?:\s+|(?![a-zA-Z]))/,"\\x":/^(?:\\[a-zA-Z]+\s*|\\[_&{}%])/,orbital:/^(?:[0-9]{1,2}[spdfgh]|[0-9]{0,2}sp)(?=$|[^a-zA-Z])/,others:/^[\/~|]/,"\\frac{(...)}":function(t){return C.patterns.findObserveGroups(t,"\\frac{","","","}","{","","","}")},"\\overset{(...)}":function(t){return C.patterns.findObserveGroups(t,"\\overset{","","","}","{","","","}")},"\\underset{(...)}":function(t){return C.patterns.findObserveGroups(t,"\\underset{","","","}","{","","","}")},"\\underbrace{(...)}":function(t){return C.patterns.findObserveGroups(t,"\\underbrace{","","","}_","{","","","}")},"\\color{(...)}0":function(t){return C.patterns.findObserveGroups(t,"\\color{","","","}")},"\\color{(...)}{(...)}1":function(t){return C.patterns.findObserveGroups(t,"\\color{","","","}","{","","","}")},"\\color(...){(...)}2":function(t){return C.patterns.findObserveGroups(t,"\\color","\\","",/^(?=\{)/,"{","","","}")},"\\ce{(...)}":function(t){return C.patterns.findObserveGroups(t,"\\ce{","","","}")},oxidation$:/^(?:[+-][IVX]+|\\pm\s*0|\$\\pm\$\s*0)$/,"d-oxidation$":/^(?:[+-]?\s?[IVX]+|\\pm\s*0|\$\\pm\$\s*0)$/,"roman numeral":/^[IVX]+/,"1/2$":/^[+\-]?(?:[0-9]+|\$[a-z]\$|[a-z])\/[0-9]+(?:\$[a-z]\$|[a-z])?$/,amount:function(t){var e;if(e=t.match(/^(?:(?:(?:\([+\-]?[0-9]+\/[0-9]+\)|[+\-]?(?:[0-9]+|\$[a-z]\$|[a-z])\/[0-9]+|[+\-]?[0-9]+[.,][0-9]+|[+\-]?\.[0-9]+|[+\-]?[0-9]+)(?:[a-z](?=\s*[A-Z]))?)|[+\-]?[a-z](?=\s*[A-Z])|\+(?!\s))/),e)return{match_:e[0],remainder:t.substr(e[0].length)};var n=C.patterns.findObserveGroups(t,"","$","$","");return n&&(e=n.match_.match(/^\$(?:\(?[+\-]?(?:[0-9]*[a-z]?[+\-])?[0-9]*[a-z](?:[+\-][0-9]*[a-z]?)?\)?|\+|-)\$$/),e)?{match_:e[0],remainder:t.substr(e[0].length)}:null},amount2:function(t){return this.amount(t)},"(KV letters),":/^(?:[A-Z][a-z]{0,2}|i)(?=,)/,formula$:function(t){if(t.match(/^\([a-z]+\)$/))return null;var e=t.match(/^(?:[a-z]|(?:[0-9\ \+\-\,\.\(\)]+[a-z])+[0-9\ \+\-\,\.\(\)]*|(?:[a-z][0-9\ \+\-\,\.\(\)]+)+[a-z]?)$/);return e?{match_:e[0],remainder:t.substr(e[0].length)}:null},uprightEntities:/^(?:pH|pOH|pC|pK|iPr|iBu)(?=$|[^a-zA-Z])/,"/":/^\s*(\/)\s*/,"//":/^\s*(\/\/)\s*/,"*":/^\s*[*.]\s*/},findObserveGroups:function(t,e,n,r,s,a,l,u,c,m){var b=function(N,E){if(typeof E=="string")return N.indexOf(E)!==0?null:E;var R=N.match(E);return R?R[0]:null},A=function(N,E,R){for(var K=0;E<N.length;){var X=N.charAt(E),Y=b(N.substr(E),R);if(Y!==null&&K===0)return{endMatchBegin:E,endMatchEnd:E+Y.length};if(X==="{")K++;else if(X==="}"){if(K===0)throw["ExtraCloseMissingOpen","Extra close brace or missing open brace"];K--}E++}return K>0,null},x=b(t,e);if(x===null||(t=t.substr(x.length),x=b(t,n),x===null))return null;var T=A(t,x.length,r||s);if(T===null)return null;var D=t.substring(0,r?T.endMatchEnd:T.endMatchBegin);if(a||l){var j=this.findObserveGroups(t.substr(T.endMatchEnd),a,l,u,c);if(j===null)return null;var rt=[D,j.match_];return{match_:m?rt.join(""):rt,remainder:j.remainder}}else return{match_:D,remainder:t.substr(T.endMatchEnd)}},match_:function(t,e){var n=C.patterns.patterns[t];if(n===void 0)throw["MhchemBugP","mhchem bug P. Please report. ("+t+")"];if(typeof n=="function")return C.patterns.patterns[t](e);var r=e.match(n);if(r){var s;return r[2]?s=[r[1],r[2]]:r[1]?s=r[1]:s=r[0],{match_:s,remainder:e.substr(r[0].length)}}return null}},actions:{"a=":function(t,e){t.a=(t.a||"")+e},"b=":function(t,e){t.b=(t.b||"")+e},"p=":function(t,e){t.p=(t.p||"")+e},"o=":function(t,e){t.o=(t.o||"")+e},"q=":function(t,e){t.q=(t.q||"")+e},"d=":function(t,e){t.d=(t.d||"")+e},"rm=":function(t,e){t.rm=(t.rm||"")+e},"text=":function(t,e){t.text_=(t.text_||"")+e},insert:function(t,e,n){return{type_:n}},"insert+p1":function(t,e,n){return{type_:n,p1:e}},"insert+p1+p2":function(t,e,n){return{type_:n,p1:e[0],p2:e[1]}},copy:function(t,e){return e},rm:function(t,e){return{type_:"rm",p1:e||""}},text:function(t,e){return C.go(e,"text")},"{text}":function(t,e){var n=["{"];return C.concatArray(n,C.go(e,"text")),n.push("}"),n},"tex-math":function(t,e){return C.go(e,"tex-math")},"tex-math tight":function(t,e){return C.go(e,"tex-math tight")},bond:function(t,e,n){return{type_:"bond",kind_:n||e}},"color0-output":function(t,e){return{type_:"color0",color:e[0]}},ce:function(t,e){return C.go(e)},"1/2":function(t,e){var n=[];e.match(/^[+\-]/)&&(n.push(e.substr(0,1)),e=e.substr(1));var r=e.match(/^([0-9]+|\$[a-z]\$|[a-z])\/([0-9]+)(\$[a-z]\$|[a-z])?$/);return r[1]=r[1].replace(/\$/g,""),n.push({type_:"frac",p1:r[1],p2:r[2]}),r[3]&&(r[3]=r[3].replace(/\$/g,""),n.push({type_:"tex-math",p1:r[3]})),n},"9,9":function(t,e){return C.go(e,"9,9")}},createTransitions:function(t){var e,n,r,s,a={};for(e in t)for(n in t[e])for(r=n.split("|"),t[e][n].stateArray=r,s=0;s<r.length;s++)a[r[s]]=[];for(e in t)for(n in t[e])for(r=t[e][n].stateArray||[],s=0;s<r.length;s++){var l=t[e][n];if(l.action_){l.action_=[].concat(l.action_);for(var u=0;u<l.action_.length;u++)typeof l.action_[u]=="string"&&(l.action_[u]={type_:l.action_[u]})}else l.action_=[];for(var c=e.split("|"),m=0;m<c.length;m++)if(r[s]==="*")for(var b in a)a[b].push({pattern:c[m],task:l});else a[r[s]].push({pattern:c[m],task:l})}return a},stateMachines:{}};C.stateMachines={ce:{transitions:C.createTransitions({empty:{"*":{action_:"output"}},else:{"0|1|2":{action_:"beginsWithBond=false",revisit:!0,toContinue:!0}},oxidation$:{0:{action_:"oxidation-output"}},CMT:{r:{action_:"rdt=",nextState:"rt"},rd:{action_:"rqt=",nextState:"rdt"}},arrowUpDown:{"0|1|2|as":{action_:["sb=false","output","operator"],nextState:"1"}},uprightEntities:{"0|1|2":{action_:["o=","output"],nextState:"1"}},orbital:{"0|1|2|3":{action_:"o=",nextState:"o"}},"->":{"0|1|2|3":{action_:"r=",nextState:"r"},"a|as":{action_:["output","r="],nextState:"r"},"*":{action_:["output","r="],nextState:"r"}},"+":{o:{action_:"d= kv",nextState:"d"},"d|D":{action_:"d=",nextState:"d"},q:{action_:"d=",nextState:"qd"},"qd|qD":{action_:"d=",nextState:"qd"},dq:{action_:["output","d="],nextState:"d"},3:{action_:["sb=false","output","operator"],nextState:"0"}},amount:{"0|2":{action_:"a=",nextState:"a"}},"pm-operator":{"0|1|2|a|as":{action_:["sb=false","output",{type_:"operator",option:"\\pm"}],nextState:"0"}},operator:{"0|1|2|a|as":{action_:["sb=false","output","operator"],nextState:"0"}},"-$":{"o|q":{action_:["charge or bond","output"],nextState:"qd"},d:{action_:"d=",nextState:"d"},D:{action_:["output",{type_:"bond",option:"-"}],nextState:"3"},q:{action_:"d=",nextState:"qd"},qd:{action_:"d=",nextState:"qd"},"qD|dq":{action_:["output",{type_:"bond",option:"-"}],nextState:"3"}},"-9":{"3|o":{action_:["output",{type_:"insert",option:"hyphen"}],nextState:"3"}},"- orbital overlap":{o:{action_:["output",{type_:"insert",option:"hyphen"}],nextState:"2"},d:{action_:["output",{type_:"insert",option:"hyphen"}],nextState:"2"}},"-":{"0|1|2":{action_:[{type_:"output",option:1},"beginsWithBond=true",{type_:"bond",option:"-"}],nextState:"3"},3:{action_:{type_:"bond",option:"-"}},a:{action_:["output",{type_:"insert",option:"hyphen"}],nextState:"2"},as:{action_:[{type_:"output",option:2},{type_:"bond",option:"-"}],nextState:"3"},b:{action_:"b="},o:{action_:{type_:"- after o/d",option:!1},nextState:"2"},q:{action_:{type_:"- after o/d",option:!1},nextState:"2"},"d|qd|dq":{action_:{type_:"- after o/d",option:!0},nextState:"2"},"D|qD|p":{action_:["output",{type_:"bond",option:"-"}],nextState:"3"}},amount2:{"1|3":{action_:"a=",nextState:"a"}},letters:{"0|1|2|3|a|as|b|p|bp|o":{action_:"o=",nextState:"o"},"q|dq":{action_:["output","o="],nextState:"o"},"d|D|qd|qD":{action_:"o after d",nextState:"o"}},digits:{o:{action_:"q=",nextState:"q"},"d|D":{action_:"q=",nextState:"dq"},q:{action_:["output","o="],nextState:"o"},a:{action_:"o=",nextState:"o"}},"space A":{"b|p|bp":{}},space:{a:{nextState:"as"},0:{action_:"sb=false"},"1|2":{action_:"sb=true"},"r|rt|rd|rdt|rdq":{action_:"output",nextState:"0"},"*":{action_:["output","sb=true"],nextState:"1"}},"1st-level escape":{"1|2":{action_:["output",{type_:"insert+p1",option:"1st-level escape"}]},"*":{action_:["output",{type_:"insert+p1",option:"1st-level escape"}],nextState:"0"}},"[(...)]":{"r|rt":{action_:"rd=",nextState:"rd"},"rd|rdt":{action_:"rq=",nextState:"rdq"}},"...":{"o|d|D|dq|qd|qD":{action_:["output",{type_:"bond",option:"..."}],nextState:"3"},"*":{action_:[{type_:"output",option:1},{type_:"insert",option:"ellipsis"}],nextState:"1"}},". |* ":{"*":{action_:["output",{type_:"insert",option:"addition compound"}],nextState:"1"}},"state of aggregation $":{"*":{action_:["output","state of aggregation"],nextState:"1"}},"{[(":{"a|as|o":{action_:["o=","output","parenthesisLevel++"],nextState:"2"},"0|1|2|3":{action_:["o=","output","parenthesisLevel++"],nextState:"2"},"*":{action_:["output","o=","output","parenthesisLevel++"],nextState:"2"}},")]}":{"0|1|2|3|b|p|bp|o":{action_:["o=","parenthesisLevel--"],nextState:"o"},"a|as|d|D|q|qd|qD|dq":{action_:["output","o=","parenthesisLevel--"],nextState:"o"}},", ":{"*":{action_:["output","comma"],nextState:"0"}},"^_":{"*":{}},"^{(...)}|^($...$)":{"0|1|2|as":{action_:"b=",nextState:"b"},p:{action_:"b=",nextState:"bp"},"3|o":{action_:"d= kv",nextState:"D"},q:{action_:"d=",nextState:"qD"},"d|D|qd|qD|dq":{action_:["output","d="],nextState:"D"}},"^a|^\\x{}{}|^\\x{}|^\\x|'":{"0|1|2|as":{action_:"b=",nextState:"b"},p:{action_:"b=",nextState:"bp"},"3|o":{action_:"d= kv",nextState:"d"},q:{action_:"d=",nextState:"qd"},"d|qd|D|qD":{action_:"d="},dq:{action_:["output","d="],nextState:"d"}},"_{(state of aggregation)}$":{"d|D|q|qd|qD|dq":{action_:["output","q="],nextState:"q"}},"_{(...)}|_($...$)|_9|_\\x{}{}|_\\x{}|_\\x":{"0|1|2|as":{action_:"p=",nextState:"p"},b:{action_:"p=",nextState:"bp"},"3|o":{action_:"q=",nextState:"q"},"d|D":{action_:"q=",nextState:"dq"},"q|qd|qD|dq":{action_:["output","q="],nextState:"q"}},"=<>":{"0|1|2|3|a|as|o|q|d|D|qd|qD|dq":{action_:[{type_:"output",option:2},"bond"],nextState:"3"}},"#":{"0|1|2|3|a|as|o":{action_:[{type_:"output",option:2},{type_:"bond",option:"#"}],nextState:"3"}},"{}":{"*":{action_:{type_:"output",option:1},nextState:"1"}},"{...}":{"0|1|2|3|a|as|b|p|bp":{action_:"o=",nextState:"o"},"o|d|D|q|qd|qD|dq":{action_:["output","o="],nextState:"o"}},"$...$":{a:{action_:"a="},"0|1|2|3|as|b|p|bp|o":{action_:"o=",nextState:"o"},"as|o":{action_:"o="},"q|d|D|qd|qD|dq":{action_:["output","o="],nextState:"o"}},"\\bond{(...)}":{"*":{action_:[{type_:"output",option:2},"bond"],nextState:"3"}},"\\frac{(...)}":{"*":{action_:[{type_:"output",option:1},"frac-output"],nextState:"3"}},"\\overset{(...)}":{"*":{action_:[{type_:"output",option:2},"overset-output"],nextState:"3"}},"\\underset{(...)}":{"*":{action_:[{type_:"output",option:2},"underset-output"],nextState:"3"}},"\\underbrace{(...)}":{"*":{action_:[{type_:"output",option:2},"underbrace-output"],nextState:"3"}},"\\color{(...)}{(...)}1|\\color(...){(...)}2":{"*":{action_:[{type_:"output",option:2},"color-output"],nextState:"3"}},"\\color{(...)}0":{"*":{action_:[{type_:"output",option:2},"color0-output"]}},"\\ce{(...)}":{"*":{action_:[{type_:"output",option:2},"ce"],nextState:"3"}},"\\,":{"*":{action_:[{type_:"output",option:1},"copy"],nextState:"1"}},"\\x{}{}|\\x{}|\\x":{"0|1|2|3|a|as|b|p|bp|o|c0":{action_:["o=","output"],nextState:"3"},"*":{action_:["output","o=","output"],nextState:"3"}},others:{"*":{action_:[{type_:"output",option:1},"copy"],nextState:"3"}},else2:{a:{action_:"a to o",nextState:"o",revisit:!0},as:{action_:["output","sb=true"],nextState:"1",revisit:!0},"r|rt|rd|rdt|rdq":{action_:["output"],nextState:"0",revisit:!0},"*":{action_:["output","copy"],nextState:"3"}}}),actions:{"o after d":function(t,e){var n;if((t.d||"").match(/^[0-9]+$/)){var r=t.d;t.d=void 0,n=this.output(t),t.b=r}else n=this.output(t);return C.actions["o="](t,e),n},"d= kv":function(t,e){t.d=e,t.dType="kv"},"charge or bond":function(t,e){if(t.beginsWithBond){var n=[];return C.concatArray(n,this.output(t)),C.concatArray(n,C.actions.bond(t,e,"-")),n}else t.d=e},"- after o/d":function(t,e,n){var r=C.patterns.match_("orbital",t.o||""),s=C.patterns.match_("one lowercase greek letter $",t.o||""),a=C.patterns.match_("one lowercase latin letter $",t.o||""),l=C.patterns.match_("$one lowercase latin letter$ $",t.o||""),u=e==="-"&&(r&&r.remainder===""||s||a||l);u&&!t.a&&!t.b&&!t.p&&!t.d&&!t.q&&!r&&a&&(t.o="$"+t.o+"$");var c=[];return u?(C.concatArray(c,this.output(t)),c.push({type_:"hyphen"})):(r=C.patterns.match_("digits",t.d||""),n&&r&&r.remainder===""?(C.concatArray(c,C.actions["d="](t,e)),C.concatArray(c,this.output(t))):(C.concatArray(c,this.output(t)),C.concatArray(c,C.actions.bond(t,e,"-")))),c},"a to o":function(t){t.o=t.a,t.a=void 0},"sb=true":function(t){t.sb=!0},"sb=false":function(t){t.sb=!1},"beginsWithBond=true":function(t){t.beginsWithBond=!0},"beginsWithBond=false":function(t){t.beginsWithBond=!1},"parenthesisLevel++":function(t){t.parenthesisLevel++},"parenthesisLevel--":function(t){t.parenthesisLevel--},"state of aggregation":function(t,e){return{type_:"state of aggregation",p1:C.go(e,"o")}},comma:function(t,e){var n=e.replace(/\s*$/,""),r=n!==e;return r&&t.parenthesisLevel===0?{type_:"comma enumeration L",p1:n}:{type_:"comma enumeration M",p1:n}},output:function(t,e,n){var r;if(!t.r)r=[],!t.a&&!t.b&&!t.p&&!t.o&&!t.q&&!t.d&&!n||(t.sb&&r.push({type_:"entitySkip"}),!t.o&&!t.q&&!t.d&&!t.b&&!t.p&&n!==2?(t.o=t.a,t.a=void 0):!t.o&&!t.q&&!t.d&&(t.b||t.p)?(t.o=t.a,t.d=t.b,t.q=t.p,t.a=t.b=t.p=void 0):t.o&&t.dType==="kv"&&C.patterns.match_("d-oxidation$",t.d||"")?t.dType="oxidation":t.o&&t.dType==="kv"&&!t.q&&(t.dType=void 0),r.push({type_:"chemfive",a:C.go(t.a,"a"),b:C.go(t.b,"bd"),p:C.go(t.p,"pq"),o:C.go(t.o,"o"),q:C.go(t.q,"pq"),d:C.go(t.d,t.dType==="oxidation"?"oxidation":"bd"),dType:t.dType}));else{var s;t.rdt==="M"?s=C.go(t.rd,"tex-math"):t.rdt==="T"?s=[{type_:"text",p1:t.rd||""}]:s=C.go(t.rd);var a;t.rqt==="M"?a=C.go(t.rq,"tex-math"):t.rqt==="T"?a=[{type_:"text",p1:t.rq||""}]:a=C.go(t.rq),r={type_:"arrow",r:t.r,rd:s,rq:a}}for(var l in t)l!=="parenthesisLevel"&&l!=="beginsWithBond"&&delete t[l];return r},"oxidation-output":function(t,e){var n=["{"];return C.concatArray(n,C.go(e,"oxidation")),n.push("}"),n},"frac-output":function(t,e){return{type_:"frac-ce",p1:C.go(e[0]),p2:C.go(e[1])}},"overset-output":function(t,e){return{type_:"overset",p1:C.go(e[0]),p2:C.go(e[1])}},"underset-output":function(t,e){return{type_:"underset",p1:C.go(e[0]),p2:C.go(e[1])}},"underbrace-output":function(t,e){return{type_:"underbrace",p1:C.go(e[0]),p2:C.go(e[1])}},"color-output":function(t,e){return{type_:"color",color1:e[0],color2:C.go(e[1])}},"r=":function(t,e){t.r=e},"rdt=":function(t,e){t.rdt=e},"rd=":function(t,e){t.rd=e},"rqt=":function(t,e){t.rqt=e},"rq=":function(t,e){t.rq=e},operator:function(t,e,n){return{type_:"operator",kind_:n||e}}}},a:{transitions:C.createTransitions({empty:{"*":{}},"1/2$":{0:{action_:"1/2"}},else:{0:{nextState:"1",revisit:!0}},"$(...)$":{"*":{action_:"tex-math tight",nextState:"1"}},",":{"*":{action_:{type_:"insert",option:"commaDecimal"}}},else2:{"*":{action_:"copy"}}}),actions:{}},o:{transitions:C.createTransitions({empty:{"*":{}},"1/2$":{0:{action_:"1/2"}},else:{0:{nextState:"1",revisit:!0}},letters:{"*":{action_:"rm"}},"\\ca":{"*":{action_:{type_:"insert",option:"circa"}}},"\\x{}{}|\\x{}|\\x":{"*":{action_:"copy"}},"${(...)}$|$(...)$":{"*":{action_:"tex-math"}},"{(...)}":{"*":{action_:"{text}"}},else2:{"*":{action_:"copy"}}}),actions:{}},text:{transitions:C.createTransitions({empty:{"*":{action_:"output"}},"{...}":{"*":{action_:"text="}},"${(...)}$|$(...)$":{"*":{action_:"tex-math"}},"\\greek":{"*":{action_:["output","rm"]}},"\\,|\\x{}{}|\\x{}|\\x":{"*":{action_:["output","copy"]}},else:{"*":{action_:"text="}}}),actions:{output:function(t){if(t.text_){var e={type_:"text",p1:t.text_};for(var n in t)delete t[n];return e}}}},pq:{transitions:C.createTransitions({empty:{"*":{}},"state of aggregation $":{"*":{action_:"state of aggregation"}},i$:{0:{nextState:"!f",revisit:!0}},"(KV letters),":{0:{action_:"rm",nextState:"0"}},formula$:{0:{nextState:"f",revisit:!0}},"1/2$":{0:{action_:"1/2"}},else:{0:{nextState:"!f",revisit:!0}},"${(...)}$|$(...)$":{"*":{action_:"tex-math"}},"{(...)}":{"*":{action_:"text"}},"a-z":{f:{action_:"tex-math"}},letters:{"*":{action_:"rm"}},"-9.,9":{"*":{action_:"9,9"}},",":{"*":{action_:{type_:"insert+p1",option:"comma enumeration S"}}},"\\color{(...)}{(...)}1|\\color(...){(...)}2":{"*":{action_:"color-output"}},"\\color{(...)}0":{"*":{action_:"color0-output"}},"\\ce{(...)}":{"*":{action_:"ce"}},"\\,|\\x{}{}|\\x{}|\\x":{"*":{action_:"copy"}},else2:{"*":{action_:"copy"}}}),actions:{"state of aggregation":function(t,e){return{type_:"state of aggregation subscript",p1:C.go(e,"o")}},"color-output":function(t,e){return{type_:"color",color1:e[0],color2:C.go(e[1],"pq")}}}},bd:{transitions:C.createTransitions({empty:{"*":{}},x$:{0:{nextState:"!f",revisit:!0}},formula$:{0:{nextState:"f",revisit:!0}},else:{0:{nextState:"!f",revisit:!0}},"-9.,9 no missing 0":{"*":{action_:"9,9"}},".":{"*":{action_:{type_:"insert",option:"electron dot"}}},"a-z":{f:{action_:"tex-math"}},x:{"*":{action_:{type_:"insert",option:"KV x"}}},letters:{"*":{action_:"rm"}},"'":{"*":{action_:{type_:"insert",option:"prime"}}},"${(...)}$|$(...)$":{"*":{action_:"tex-math"}},"{(...)}":{"*":{action_:"text"}},"\\color{(...)}{(...)}1|\\color(...){(...)}2":{"*":{action_:"color-output"}},"\\color{(...)}0":{"*":{action_:"color0-output"}},"\\ce{(...)}":{"*":{action_:"ce"}},"\\,|\\x{}{}|\\x{}|\\x":{"*":{action_:"copy"}},else2:{"*":{action_:"copy"}}}),actions:{"color-output":function(t,e){return{type_:"color",color1:e[0],color2:C.go(e[1],"bd")}}}},oxidation:{transitions:C.createTransitions({empty:{"*":{}},"roman numeral":{"*":{action_:"roman-numeral"}},"${(...)}$|$(...)$":{"*":{action_:"tex-math"}},else:{"*":{action_:"copy"}}}),actions:{"roman-numeral":function(t,e){return{type_:"roman numeral",p1:e||""}}}},"tex-math":{transitions:C.createTransitions({empty:{"*":{action_:"output"}},"\\ce{(...)}":{"*":{action_:["output","ce"]}},"{...}|\\,|\\x{}{}|\\x{}|\\x":{"*":{action_:"o="}},else:{"*":{action_:"o="}}}),actions:{output:function(t){if(t.o){var e={type_:"tex-math",p1:t.o};for(var n in t)delete t[n];return e}}}},"tex-math tight":{transitions:C.createTransitions({empty:{"*":{action_:"output"}},"\\ce{(...)}":{"*":{action_:["output","ce"]}},"{...}|\\,|\\x{}{}|\\x{}|\\x":{"*":{action_:"o="}},"-|+":{"*":{action_:"tight operator"}},else:{"*":{action_:"o="}}}),actions:{"tight operator":function(t,e){t.o=(t.o||"")+"{"+e+"}"},output:function(t){if(t.o){var e={type_:"tex-math",p1:t.o};for(var n in t)delete t[n];return e}}}},"9,9":{transitions:C.createTransitions({empty:{"*":{}},",":{"*":{action_:"comma"}},else:{"*":{action_:"copy"}}}),actions:{comma:function(){return{type_:"commaDecimal"}}}},pu:{transitions:C.createTransitions({empty:{"*":{action_:"output"}},space$:{"*":{action_:["output","space"]}},"{[(|)]}":{"0|a":{action_:"copy"}},"(-)(9)^(-9)":{0:{action_:"number^",nextState:"a"}},"(-)(9.,9)(e)(99)":{0:{action_:"enumber",nextState:"a"}},space:{"0|a":{}},"pm-operator":{"0|a":{action_:{type_:"operator",option:"\\pm"},nextState:"0"}},operator:{"0|a":{action_:"copy",nextState:"0"}},"//":{d:{action_:"o=",nextState:"/"}},"/":{d:{action_:"o=",nextState:"/"}},"{...}|else":{"0|d":{action_:"d=",nextState:"d"},a:{action_:["space","d="],nextState:"d"},"/|q":{action_:"q=",nextState:"q"}}}),actions:{enumber:function(t,e){var n=[];return e[0]==="+-"||e[0]==="+/-"?n.push("\\pm "):e[0]&&n.push(e[0]),e[1]&&(C.concatArray(n,C.go(e[1],"pu-9,9")),e[2]&&(e[2].match(/[,.]/)?C.concatArray(n,C.go(e[2],"pu-9,9")):n.push(e[2])),e[3]=e[4]||e[3],e[3]&&(e[3]=e[3].trim(),e[3]==="e"||e[3].substr(0,1)==="*"?n.push({type_:"cdot"}):n.push({type_:"times"}))),e[3]&&n.push("10^{"+e[5]+"}"),n},"number^":function(t,e){var n=[];return e[0]==="+-"||e[0]==="+/-"?n.push("\\pm "):e[0]&&n.push(e[0]),C.concatArray(n,C.go(e[1],"pu-9,9")),n.push("^{"+e[2]+"}"),n},operator:function(t,e,n){return{type_:"operator",kind_:n||e}},space:function(){return{type_:"pu-space-1"}},output:function(t){var e,n=C.patterns.match_("{(...)}",t.d||"");n&&n.remainder===""&&(t.d=n.match_);var r=C.patterns.match_("{(...)}",t.q||"");if(r&&r.remainder===""&&(t.q=r.match_),t.d&&(t.d=t.d.replace(/\u00B0C|\^oC|\^{o}C/g,"{}^{\\circ}C"),t.d=t.d.replace(/\u00B0F|\^oF|\^{o}F/g,"{}^{\\circ}F")),t.q){t.q=t.q.replace(/\u00B0C|\^oC|\^{o}C/g,"{}^{\\circ}C"),t.q=t.q.replace(/\u00B0F|\^oF|\^{o}F/g,"{}^{\\circ}F");var s={d:C.go(t.d,"pu"),q:C.go(t.q,"pu")};t.o==="//"?e={type_:"pu-frac",p1:s.d,p2:s.q}:(e=s.d,s.d.length>1||s.q.length>1?e.push({type_:" / "}):e.push({type_:"/"}),C.concatArray(e,s.q))}else e=C.go(t.d,"pu-2");for(var a in t)delete t[a];return e}}},"pu-2":{transitions:C.createTransitions({empty:{"*":{action_:"output"}},"*":{"*":{action_:["output","cdot"],nextState:"0"}},"\\x":{"*":{action_:"rm="}},space:{"*":{action_:["output","space"],nextState:"0"}},"^{(...)}|^(-1)":{1:{action_:"^(-1)"}},"-9.,9":{0:{action_:"rm=",nextState:"0"},1:{action_:"^(-1)",nextState:"0"}},"{...}|else":{"*":{action_:"rm=",nextState:"1"}}}),actions:{cdot:function(){return{type_:"tight cdot"}},"^(-1)":function(t,e){t.rm+="^{"+e+"}"},space:function(){return{type_:"pu-space-2"}},output:function(t){var e=[];if(t.rm){var n=C.patterns.match_("{(...)}",t.rm||"");n&&n.remainder===""?e=C.go(n.match_,"pu"):e={type_:"rm",p1:t.rm}}for(var r in t)delete t[r];return e}}},"pu-9,9":{transitions:C.createTransitions({empty:{0:{action_:"output-0"},o:{action_:"output-o"}},",":{0:{action_:["output-0","comma"],nextState:"o"}},".":{0:{action_:["output-0","copy"],nextState:"o"}},else:{"*":{action_:"text="}}}),actions:{comma:function(){return{type_:"commaDecimal"}},"output-0":function(t){var e=[];if(t.text_=t.text_||"",t.text_.length>4){var n=t.text_.length%3;n===0&&(n=3);for(var r=t.text_.length-3;r>0;r-=3)e.push(t.text_.substr(r,3)),e.push({type_:"1000 separator"});e.push(t.text_.substr(0,n)),e.reverse()}else e.push(t.text_);for(var s in t)delete t[s];return e},"output-o":function(t){var e=[];if(t.text_=t.text_||"",t.text_.length>4){for(var n=t.text_.length-3,r=0;r<n;r+=3)e.push(t.text_.substr(r,3)),e.push({type_:"1000 separator"});e.push(t.text_.substr(r))}else e.push(t.text_);for(var s in t)delete t[s];return e}}}};var nt={go:function(t,e){if(!t)return"";for(var n="",r=!1,s=0;s<t.length;s++){var a=t[s];typeof a=="string"?n+=a:(n+=nt._go2(a),a.type_==="1st-level escape"&&(r=!0))}return!e&&!r&&n&&(n="{"+n+"}"),n},_goInner:function(t){return t&&nt.go(t,!0)},_go2:function(t){var e;switch(t.type_){case"chemfive":e="";var n={a:nt._goInner(t.a),b:nt._goInner(t.b),p:nt._goInner(t.p),o:nt._goInner(t.o),q:nt._goInner(t.q),d:nt._goInner(t.d)};n.a&&(n.a.match(/^[+\-]/)&&(n.a="{"+n.a+"}"),e+=n.a+"\\,"),(n.b||n.p)&&(e+="{\\vphantom{X}}",e+="^{\\hphantom{"+(n.b||"")+"}}_{\\hphantom{"+(n.p||"")+"}}",e+="{\\vphantom{X}}",e+="^{\\vphantom{2}\\mathllap{"+(n.b||"")+"}}",e+="_{\\vphantom{2}\\mathllap{"+(n.p||"")+"}}"),n.o&&(n.o.match(/^[+\-]/)&&(n.o="{"+n.o+"}"),e+=n.o),t.dType==="kv"?((n.d||n.q)&&(e+="{\\vphantom{X}}"),n.d&&(e+="^{"+n.d+"}"),n.q&&(e+="_{"+n.q+"}")):t.dType==="oxidation"?(n.d&&(e+="{\\vphantom{X}}",e+="^{"+n.d+"}"),n.q&&(e+="{{}}",e+="_{"+n.q+"}")):(n.q&&(e+="{{}}",e+="_{"+n.q+"}"),n.d&&(e+="{{}}",e+="^{"+n.d+"}"));break;case"rm":e="\\mathrm{"+t.p1+"}";break;case"text":t.p1.match(/[\^_]/)?(t.p1=t.p1.replace(" ","~").replace("-","\\text{-}"),e="\\mathrm{"+t.p1+"}"):e="\\text{"+t.p1+"}";break;case"roman numeral":e="\\mathrm{"+t.p1+"}";break;case"state of aggregation":e="\\mskip2mu "+nt._goInner(t.p1);break;case"state of aggregation subscript":e="\\mskip1mu "+nt._goInner(t.p1);break;case"bond":if(e=nt._getBond(t.kind_),!e)throw["MhchemErrorBond","mhchem Error. Unknown bond type ("+t.kind_+")"];break;case"frac":var r="\\frac{"+t.p1+"}{"+t.p2+"}";e="\\mathchoice{\\textstyle"+r+"}{"+r+"}{"+r+"}{"+r+"}";break;case"pu-frac":var s="\\frac{"+nt._goInner(t.p1)+"}{"+nt._goInner(t.p2)+"}";e="\\mathchoice{\\textstyle"+s+"}{"+s+"}{"+s+"}{"+s+"}";break;case"tex-math":e=t.p1+" ";break;case"frac-ce":e="\\frac{"+nt._goInner(t.p1)+"}{"+nt._goInner(t.p2)+"}";break;case"overset":e="\\overset{"+nt._goInner(t.p1)+"}{"+nt._goInner(t.p2)+"}";break;case"underset":e="\\underset{"+nt._goInner(t.p1)+"}{"+nt._goInner(t.p2)+"}";break;case"underbrace":e="\\underbrace{"+nt._goInner(t.p1)+"}_{"+nt._goInner(t.p2)+"}";break;case"color":e="{\\color{"+t.color1+"}{"+nt._goInner(t.color2)+"}}";break;case"color0":e="\\color{"+t.color+"}";break;case"arrow":var a={rd:nt._goInner(t.rd),rq:nt._goInner(t.rq)},l=nt._getArrow(t.r);a.rq&&(l+="[{\\rm "+a.rq+"}]"),a.rd?l+="{\\rm "+a.rd+"}":l+="{}",e=l;break;case"operator":e=nt._getOperator(t.kind_);break;case"1st-level escape":e=t.p1+" ";break;case"space":e=" ";break;case"entitySkip":e="~";break;case"pu-space-1":e="~";break;case"pu-space-2":e="\\mkern3mu ";break;case"1000 separator":e="\\mkern2mu ";break;case"commaDecimal":e="{,}";break;case"comma enumeration L":e="{"+t.p1+"}\\mkern6mu ";break;case"comma enumeration M":e="{"+t.p1+"}\\mkern3mu ";break;case"comma enumeration S":e="{"+t.p1+"}\\mkern1mu ";break;case"hyphen":e="\\text{-}";break;case"addition compound":e="\\,{\\cdot}\\,";break;case"electron dot":e="\\mkern1mu \\text{\\textbullet}\\mkern1mu ";break;case"KV x":e="{\\times}";break;case"prime":e="\\prime ";break;case"cdot":e="\\cdot ";break;case"tight cdot":e="\\mkern1mu{\\cdot}\\mkern1mu ";break;case"times":e="\\times ";break;case"circa":e="{\\sim}";break;case"^":e="uparrow";break;case"v":e="downarrow";break;case"ellipsis":e="\\ldots ";break;case"/":e="/";break;case" / ":e="\\,/\\,";break;default:throw["MhchemBugT","mhchem bug T. Please report."]}return e},_getArrow:function(t){switch(t){case"->":return"\\yields";case"→":return"\\yields";case"⟶":return"\\yields";case"<-":return"\\yieldsLeft";case"<->":return"\\mesomerism";case"<-->":return"\\yieldsLeftRight";case"<=>":return"\\equilibrium";case"⇌":return"\\equilibrium";case"<=>>":return"\\equilibriumRight";case"<<=>":return"\\equilibriumLeft";default:throw["MhchemBugT","mhchem bug T. Please report."]}},_getBond:function(t){switch(t){case"-":return"{-}";case"1":return"{-}";case"=":return"{=}";case"2":return"{=}";case"#":return"{\\equiv}";case"3":return"{\\equiv}";case"~":return"{\\tripleDash}";case"~-":return"{\\tripleDashOverLine}";case"~=":return"{\\tripleDashOverDoubleLine}";case"~--":return"{\\tripleDashOverDoubleLine}";case"-~-":return"{\\tripleDashBetweenDoubleLine}";case"...":return"{{\\cdot}{\\cdot}{\\cdot}}";case"....":return"{{\\cdot}{\\cdot}{\\cdot}{\\cdot}}";case"->":return"{\\rightarrow}";case"<-":return"{\\leftarrow}";case"<":return"{<}";case">":return"{>}";default:throw["MhchemBugT","mhchem bug T. Please report."]}},_getOperator:function(t){switch(t){case"+":return" {}+{} ";case"-":return" {}-{} ";case"=":return" {}={} ";case"<":return" {}<{} ";case">":return" {}>{} ";case"<<":return" {}\\ll{} ";case">>":return" {}\\gg{} ";case"\\pm":return" {}\\pm{} ";case"\\approx":return" {}\\approx{} ";case"$\\approx$":return" {}\\approx{} ";case"v":return" \\downarrow{} ";case"(v)":return" \\downarrow{} ";case"^":return" \\uparrow{} ";case"(^)":return" \\uparrow{} ";default:throw["MhchemBugT","mhchem bug T. Please report."]}}};h("\\darr","\\downarrow"),h("\\dArr","\\Downarrow"),h("\\Darr","\\Downarrow"),h("\\lang","\\langle"),h("\\rang","\\rangle"),h("\\uarr","\\uparrow"),h("\\uArr","\\Uparrow"),h("\\Uarr","\\Uparrow"),h("\\N","\\mathbb{N}"),h("\\R","\\mathbb{R}"),h("\\Z","\\mathbb{Z}"),h("\\alef","\\aleph"),h("\\alefsym","\\aleph"),h("\\bull","\\bullet"),h("\\clubs","\\clubsuit"),h("\\cnums","\\mathbb{C}"),h("\\Complex","\\mathbb{C}"),h("\\Dagger","\\ddagger"),h("\\diamonds","\\diamondsuit"),h("\\empty","\\emptyset"),h("\\exist","\\exists"),h("\\harr","\\leftrightarrow"),h("\\hArr","\\Leftrightarrow"),h("\\Harr","\\Leftrightarrow"),h("\\hearts","\\heartsuit"),h("\\image","\\Im"),h("\\infin","\\infty"),h("\\isin","\\in"),h("\\larr","\\leftarrow"),h("\\lArr","\\Leftarrow"),h("\\Larr","\\Leftarrow"),h("\\lrarr","\\leftrightarrow"),h("\\lrArr","\\Leftrightarrow"),h("\\Lrarr","\\Leftrightarrow"),h("\\natnums","\\mathbb{N}"),h("\\plusmn","\\pm"),h("\\rarr","\\rightarrow"),h("\\rArr","\\Rightarrow"),h("\\Rarr","\\Rightarrow"),h("\\real","\\Re"),h("\\reals","\\mathbb{R}"),h("\\Reals","\\mathbb{R}"),h("\\sdot","\\cdot"),h("\\sect","\\S"),h("\\spades","\\spadesuit"),h("\\sub","\\subset"),h("\\sube","\\subseteq"),h("\\supe","\\supseteq"),h("\\thetasym","\\vartheta"),h("\\weierp","\\wp"),h("\\quantity","{\\left\\{ #1 \\right\\}}"),h("\\qty","{\\left\\{ #1 \\right\\}}"),h("\\pqty","{\\left( #1 \\right)}"),h("\\bqty","{\\left[ #1 \\right]}"),h("\\vqty","{\\left\\vert #1 \\right\\vert}"),h("\\Bqty","{\\left\\{ #1 \\right\\}}"),h("\\absolutevalue","{\\left\\vert #1 \\right\\vert}"),h("\\abs","{\\left\\vert #1 \\right\\vert}"),h("\\norm","{\\left\\Vert #1 \\right\\Vert}"),h("\\evaluated","{\\left.#1 \\right\\vert}"),h("\\eval","{\\left.#1 \\right\\vert}"),h("\\order","{\\mathcal{O} \\left( #1 \\right)}"),h("\\commutator","{\\left[ #1 , #2 \\right]}"),h("\\comm","{\\left[ #1 , #2 \\right]}"),h("\\anticommutator","{\\left\\{ #1 , #2 \\right\\}}"),h("\\acomm","{\\left\\{ #1 , #2 \\right\\}}"),h("\\poissonbracket","{\\left\\{ #1 , #2 \\right\\}}"),h("\\pb","{\\left\\{ #1 , #2 \\right\\}}"),h("\\vectorbold","{\\boldsymbol{ #1 }}"),h("\\vb","{\\boldsymbol{ #1 }}"),h("\\vectorarrow","{\\vec{\\boldsymbol{ #1 }}}"),h("\\va","{\\vec{\\boldsymbol{ #1 }}}"),h("\\vectorunit","{{\\boldsymbol{\\hat{ #1 }}}}"),h("\\vu","{{\\boldsymbol{\\hat{ #1 }}}}"),h("\\dotproduct","\\mathbin{\\boldsymbol\\cdot}"),h("\\vdot","{\\boldsymbol\\cdot}"),h("\\crossproduct","\\mathbin{\\boldsymbol\\times}"),h("\\cross","\\mathbin{\\boldsymbol\\times}"),h("\\cp","\\mathbin{\\boldsymbol\\times}"),h("\\gradient","{\\boldsymbol\\nabla}"),h("\\grad","{\\boldsymbol\\nabla}"),h("\\divergence","{\\grad\\vdot}"),h("\\curl","{\\grad\\cross}"),h("\\laplacian","\\nabla^2"),h("\\tr","{\\operatorname{tr}}"),h("\\Tr","{\\operatorname{Tr}}"),h("\\rank","{\\operatorname{rank}}"),h("\\erf","{\\operatorname{erf}}"),h("\\Res","{\\operatorname{Res}}"),h("\\principalvalue","{\\mathcal{P}}"),h("\\pv","{\\mathcal{P}}"),h("\\PV","{\\operatorname{P.V.}}"),h("\\qqtext","{\\quad\\text{ #1 }\\quad}"),h("\\qq","{\\quad\\text{ #1 }\\quad}"),h("\\qcomma","{\\text{,}\\quad}"),h("\\qc","{\\text{,}\\quad}"),h("\\qcc","{\\quad\\text{c.c.}\\quad}"),h("\\qif","{\\quad\\text{if}\\quad}"),h("\\qthen","{\\quad\\text{then}\\quad}"),h("\\qelse","{\\quad\\text{else}\\quad}"),h("\\qotherwise","{\\quad\\text{otherwise}\\quad}"),h("\\qunless","{\\quad\\text{unless}\\quad}"),h("\\qgiven","{\\quad\\text{given}\\quad}"),h("\\qusing","{\\quad\\text{using}\\quad}"),h("\\qassume","{\\quad\\text{assume}\\quad}"),h("\\qsince","{\\quad\\text{since}\\quad}"),h("\\qlet","{\\quad\\text{let}\\quad}"),h("\\qfor","{\\quad\\text{for}\\quad}"),h("\\qall","{\\quad\\text{all}\\quad}"),h("\\qeven","{\\quad\\text{even}\\quad}"),h("\\qodd","{\\quad\\text{odd}\\quad}"),h("\\qinteger","{\\quad\\text{integer}\\quad}"),h("\\qand","{\\quad\\text{and}\\quad}"),h("\\qor","{\\quad\\text{or}\\quad}"),h("\\qas","{\\quad\\text{as}\\quad}"),h("\\qin","{\\quad\\text{in}\\quad}"),h("\\differential","{\\text{d}}"),h("\\dd","{\\text{d}}"),h("\\derivative","{\\frac{\\text{d}{ #1 }}{\\text{d}{ #2 }}}"),h("\\dv","{\\frac{\\text{d}{ #1 }}{\\text{d}{ #2 }}}"),h("\\partialderivative","{\\frac{\\partial{ #1 }}{\\partial{ #2 }}}"),h("\\variation","{\\delta}"),h("\\var","{\\delta}"),h("\\functionalderivative","{\\frac{\\delta{ #1 }}{\\delta{ #2 }}}"),h("\\fdv","{\\frac{\\delta{ #1 }}{\\delta{ #2 }}}"),h("\\innerproduct","{\\left\\langle {#1} \\mid { #2} \\right\\rangle}"),h("\\outerproduct","{\\left\\vert { #1 } \\right\\rangle\\left\\langle { #2} \\right\\vert}"),h("\\dyad","{\\left\\vert { #1 } \\right\\rangle\\left\\langle { #2} \\right\\vert}"),h("\\ketbra","{\\left\\vert { #1 } \\right\\rangle\\left\\langle { #2} \\right\\vert}"),h("\\op","{\\left\\vert { #1 } \\right\\rangle\\left\\langle { #2} \\right\\vert}"),h("\\expectationvalue","{\\left\\langle {#1 } \\right\\rangle}"),h("\\expval","{\\left\\langle {#1 } \\right\\rangle}"),h("\\ev","{\\left\\langle {#1 } \\right\\rangle}"),h("\\matrixelement","{\\left\\langle{ #1 }\\right\\vert{ #2 }\\left\\vert{#3}\\right\\rangle}"),h("\\matrixel","{\\left\\langle{ #1 }\\right\\vert{ #2 }\\left\\vert{#3}\\right\\rangle}"),h("\\mel","{\\left\\langle{ #1 }\\right\\vert{ #2 }\\left\\vert{#3}\\right\\rangle}");function ur(t){const e=[];t.consumeSpaces();let n=t.fetch().text;for(n==="\\relax"&&(t.consume(),t.consumeSpaces(),n=t.fetch().text);n==="\\hline"||n==="\\hdashline";)t.consume(),e.push(n==="\\hdashline"),t.consumeSpaces(),n=t.fetch().text;return e}const ee=t=>{if(!t.parser.settings.displayMode)throw new q(`{${t.envName}} can be used only in display mode.`)},ai=/([-+]?) *(\d+(?:\.\d*)?|\.\d+) *([a-z]{2})/,cr=t=>{let e=t.get("\\arraystretch");typeof e!="string"&&(e=Ve(e.tokens)),e=isNaN(e)?null:Number(e);let n=t.get("\\arraycolsep");typeof n!="string"&&(n=Ve(n.tokens));const r=ai.exec(n),s=r?{number:+(r[1]+r[2]),unit:r[3]}:null;return[e,s]},oi=(t,e,n)=>{let r;const s=t.tags.shift();if(s)if(s.body)r=Tt(s.body,e,!0),r.classes=["tml-tag"];else return r=new y.MathNode("mtext",[],[]),r;else{if(t.envClasses.includes("multline")&&(t.leqno&&n!==0||!t.leqno&&n!==t.body.length-1))return r=new y.MathNode("mtext",[],[]),r;r=new y.MathNode("mtext",[new Mn(["tml-eqn"])])}return r};function Mt(t,{cols:e,envClasses:n,addEqnNum:r,singleRow:s,emptySingleRow:a,maxNumCols:l,leqno:u,arraystretch:c,arraycolsep:m},b){t.gullet.beginGroup(),s||t.gullet.macros.set("\\cr","\\\\\\relax"),r&&(t.gullet.macros.set("\\tag","\\@ifstar\\envtag@literal\\envtag@paren"),t.gullet.macros.set("\\envtag@paren","\\env@tag{{(\\text{#1})}}"),t.gullet.macros.set("\\envtag@literal","\\env@tag{\\text{#1}}"),t.gullet.macros.set("\\notag","\\env@notag"),t.gullet.macros.set("\\nonumber","\\env@notag")),t.gullet.beginGroup();let A=[];const x=[A],T=[],D=[];let j;const rt=[];for(rt.push(ur(t));;){let N=t.parseExpression(!1,s?"\\end":"\\\\");if(r&&!j){for(let R=0;R<N.length;R++)if(N[R].type==="envTag"||N[R].type==="noTag"){j=N[R].type==="envTag"?N.splice(R,1)[0].body.body[0]:{body:null};break}}t.gullet.endGroup(),t.gullet.beginGroup(),N={type:"ordgroup",mode:t.mode,body:N,semisimple:!0},A.push(N);const E=t.fetch().text;if(E==="&"){if(l&&A.length===l)if(n.includes("array")){if(t.settings.strict)throw new q("Too few columns specified in the {array} column argument.",t.nextToken)}else throw l===2?new q("The split environment accepts no more than two columns",t.nextToken):new q("The equation environment accepts only one column",t.nextToken);t.consume()}else if(E==="\\end"){A.length===1&&N.body.length===0&&(x.length>1||!a)&&x.pop(),rt.length<x.length+1&&rt.push([]);break}else if(E==="\\\\"){t.consume();let R;t.gullet.future().text!==" "&&(R=t.parseSizeGroup(!0)),T.push(R?R.value:null),D.push(j),rt.push(ur(t)),A=[],j=null,x.push(A)}else throw new q("Expected & or \\\\ or \\cr or \\end",t.nextToken)}return t.gullet.endGroup(),t.gullet.endGroup(),D.push(j),{type:"array",mode:t.mode,body:x,cols:e,rowGaps:T,hLinesBeforeRow:rt,envClasses:n,addEqnNum:r,scriptLevel:b,tags:D,leqno:u,arraystretch:c,arraycolsep:m}}function hr(t){return t.slice(0,1)==="d"?"display":"text"}const li={c:"center ",l:"left ",r:"right "},dr=t=>{const e=new y.MathNode("mtd",[]);return e.style={padding:"0",width:"50%"},t.envClasses.includes("multline")&&(e.style.width="7.5%"),e},vt=function(t,e){const n=[],r=t.body.length,s=t.hLinesBeforeRow;for(let u=0;u<r;u++){const c=t.body[u],m=[],b=t.scriptLevel==="text"?ct.TEXT:t.scriptLevel==="script"?ct.SCRIPT:ct.DISPLAY;for(let x=0;x<c.length;x++){const T=new y.MathNode("mtd",[tt(c[x],e.withLevel(b))]);if(t.envClasses.includes("multline")){const D=u===0?"left":u===r-1?"right":"center";T.setAttribute("columnalign",D),D!=="center"&&T.classes.push("tml-"+D)}m.push(T)}if(t.addEqnNum){m.unshift(dr(t)),m.push(dr(t));const x=oi(t,e.withLevel(b),u);t.leqno?(m[0].children.push(x),m[0].classes.push("tml-left")):(m[m.length-1].children.push(x),m[m.length-1].classes.push("tml-right"))}const A=new y.MathNode("mtr",m,[]);u===0&&s[0].length>0&&(s[0].length===2?A.children.forEach(x=>{x.style.borderTop="0.15em double"}):A.children.forEach(x=>{x.style.borderTop=s[0][0]?"0.06em dashed":"0.06em solid"})),s[u+1].length>0&&(s[u+1].length===2?A.children.forEach(x=>{x.style.borderBottom="0.15em double"}):A.children.forEach(x=>{x.style.borderBottom=s[u+1][0]?"0.06em dashed":"0.06em solid"})),n.push(A)}if(t.envClasses.length>0){let u=t.envClasses.includes("jot")?"0.7":t.envClasses.includes("small")?"0.35":"0.5";t.arraystretch&&t.arraystretch!==1&&(u=String(1.4*t.arraystretch-.8));let c=t.envClasses.includes("abut")||t.envClasses.includes("cases")?"0":t.envClasses.includes("small")?"0.1389":t.envClasses.includes("cd")?"0.25":"0.4",m="em";if(t.arraycolsep){const T=kt(t.arraycolsep,e);c=T.number,m=T.unit}const b=n.length===0?0:n[0].children.length,A=(T,D)=>T===0&&D===0||T===b-1&&D===1?"0":t.envClasses[0]!=="align"?c:D===1?"0":t.addEqnNum?T%2?"1":"0":T%2?"0":"1";for(let T=0;T<n.length;T++)for(let D=0;D<n[T].children.length;D++)n[T].children[D].style.padding=`${u}ex ${A(D,1)}${m} ${u}ex ${A(D,0)}${m}`;const x=t.envClasses.includes("align")||t.envClasses.includes("alignat");for(let T=0;T<n.length;T++){const D=n[T];if(x){for(let j=0;j<D.children.length;j++)D.children[j].classes=["tml-"+(j%2?"left":"right")];if(t.addEqnNum){const j=t.leqno?0:D.children.length-1;D.children[j].classes=["tml-"+(t.leqno?"left":"right")]}}if(D.children.length>1&&t.envClasses.includes("cases")&&(D.children[1].style.padding=D.children[1].style.padding.replace(/0em$/,"1em")),t.envClasses.includes("cases")||t.envClasses.includes("subarray"))for(const j of D.children)j.classes.push("tml-left")}}else for(let u=0;u<n.length;u++)n[u].children[0].style.paddingLeft="0em",n[u].children.length===n[0].children.length&&(n[u].children[n[u].children.length-1].style.paddingRight="0em");let a=new y.MathNode("mtable",n);t.scriptLevel==="display"&&a.setAttribute("displaystyle","true"),(t.addEqnNum||t.envClasses.includes("multline"))&&(a.style.width="100%");let l="";if(t.cols&&t.cols.length>0){const u=t.cols;let c=!1,m=0,b=u.length;for(;u[m].type==="separator";)m+=1;for(;u[b-1].type==="separator";)b-=1;if(u[0].type==="separator"){const x=u[1].type==="separator"?"0.15em double":u[0].separator==="|"?"0.06em solid ":"0.06em dashed ";for(const T of a.children)T.children[0].style.borderLeft=x}let A=t.addEqnNum?0:-1;for(let x=m;x<b;x++)if(u[x].type==="align"){const T=li[u[x].align];l+=T,A+=1;for(const D of a.children)T.trim()!=="center"&&A<D.children.length&&(D.children[A].classes=["tml-"+T.trim()]);c=!0}else if(u[x].type==="separator"){if(c){const T=u[x+1].type==="separator"?"0.15em double":u[x].separator==="|"?"0.06em solid":"0.06em dashed";for(const D of a.children)A<D.children.length&&(D.children[A].style.borderRight=T)}c=!1}if(u[u.length-1].type==="separator"){const x=u[u.length-2].type==="separator"?"0.15em double":u[u.length-1].separator==="|"?"0.06em solid":"0.06em dashed";for(const T of a.children)T.children[T.children.length-1].style.borderRight=x,T.children[T.children.length-1].style.paddingRight="0.4em"}}return t.addEqnNum&&(l="left "+(l.length>0?l:"center ")+"right "),l&&a.setAttribute("columnalign",l.trim()),t.envClasses.includes("small")&&(a=new y.MathNode("mstyle",[a]),a.setAttribute("scriptlevel","1")),a},pr=function(t,e){t.envName.indexOf("ed")===-1&&ee(t);const n=[],r=Mt(t.parser,{cols:n,addEqnNum:t.envName==="align"||t.envName==="alignat",emptySingleRow:!0,envClasses:["abut","jot"],maxNumCols:t.envName==="split"?2:void 0,leqno:t.parser.settings.leqno},"display");let s,a=0;const l=t.envName.indexOf("at")>-1;if(e[0]&&l){let u="";for(let c=0;c<e[0].body.length;c++){const m=F(e[0].body[c],"textord");u+=m.text}if(isNaN(u))throw new q("The alignat enviroment requires a numeric first argument.");s=Number(u),a=s*2}r.body.forEach(function(u){if(l){const c=u.length/2;if(s<c)throw new q(`Too many math in a row: expected ${s}, but got ${c}`,u[0])}else a<u.length&&(a=u.length)});for(let u=0;u<a;++u){let c="r";u%2===1&&(c="l"),n[u]={type:"align",align:c}}return t.envName==="split"||(l?r.envClasses.push("alignat"):r.envClasses[0]="align"),r};wt({type:"array",names:["array","darray"],props:{numArgs:1},handler(t,e){const s=(fe(e[0])?[e[0]]:F(e[0],"ordgroup").body).map(function(c){const b=Re(c).text;if("lcr".indexOf(b)!==-1)return{type:"align",align:b};if(b==="|")return{type:"separator",separator:"|"};if(b===":")return{type:"separator",separator:":"};throw new q("Unknown column alignment: "+b,c)}),[a,l]=cr(t.parser.gullet.macros),u={cols:s,envClasses:["array"],maxNumCols:s.length,arraystretch:a,arraycolsep:l};return Mt(t.parser,u,hr(t.envName))},mathmlBuilder:vt}),wt({type:"array",names:["matrix","pmatrix","bmatrix","Bmatrix","vmatrix","Vmatrix","matrix*","pmatrix*","bmatrix*","Bmatrix*","vmatrix*","Vmatrix*"],props:{numArgs:0},handler(t){const e={matrix:null,pmatrix:["(",")"],bmatrix:["[","]"],Bmatrix:["\\{","\\}"],vmatrix:["|","|"],Vmatrix:["\\Vert","\\Vert"]}[t.envName.replace("*","")];let n="c";const r={envClasses:[],cols:[]};if(t.envName.charAt(t.envName.length-1)==="*"){const u=t.parser;if(u.consumeSpaces(),u.fetch().text==="["){if(u.consume(),u.consumeSpaces(),n=u.fetch().text,"lcr".indexOf(n)===-1)throw new q("Expected l or c or r",u.nextToken);u.consume(),u.consumeSpaces(),u.expect("]"),u.consume(),r.cols=[]}}const s=Mt(t.parser,r,"text");s.cols=new Array(s.body[0].length).fill({type:"align",align:n});const[a,l]=cr(t.parser.gullet.macros);return e?{type:"leftright",mode:t.mode,body:[s],left:e[0],right:e[1],rightColor:void 0,arraystretch:a,arraycolsep:l}:s},mathmlBuilder:vt}),wt({type:"array",names:["smallmatrix"],props:{numArgs:0},handler(t){const e={type:"small"},n=Mt(t.parser,e,"script");return n.envClasses=["small"],n},mathmlBuilder:vt}),wt({type:"array",names:["subarray"],props:{numArgs:1},handler(t,e){const s=(fe(e[0])?[e[0]]:F(e[0],"ordgroup").body).map(function(l){const c=Re(l).text;if("lc".indexOf(c)!==-1)return{type:"align",align:c};throw new q("Unknown column alignment: "+c,l)});if(s.length>1)throw new q("{subarray} can contain only one column");let a={cols:s,envClasses:["small"]};if(a=Mt(t.parser,a,"script"),a.body.length>0&&a.body[0].length>1)throw new q("{subarray} can contain only one column");return a},mathmlBuilder:vt}),wt({type:"array",names:["cases","dcases","rcases","drcases"],props:{numArgs:0},handler(t){const e={cols:[],envClasses:["cases"]},n=Mt(t.parser,e,hr(t.envName));return{type:"leftright",mode:t.mode,body:[n],left:t.envName.indexOf("r")>-1?".":"\\{",right:t.envName.indexOf("r")>-1?"\\}":".",rightColor:void 0}},mathmlBuilder:vt}),wt({type:"array",names:["align","align*","aligned","split"],props:{numArgs:0},handler:pr,mathmlBuilder:vt}),wt({type:"array",names:["alignat","alignat*","alignedat"],props:{numArgs:1},handler:pr,mathmlBuilder:vt}),wt({type:"array",names:["gathered","gather","gather*"],props:{numArgs:0},handler(t){t.envName!=="gathered"&&ee(t);const e={cols:[],envClasses:["abut","jot"],addEqnNum:t.envName==="gather",emptySingleRow:!0,leqno:t.parser.settings.leqno};return Mt(t.parser,e,"display")},mathmlBuilder:vt}),wt({type:"array",names:["equation","equation*"],props:{numArgs:0},handler(t){ee(t);const e={addEqnNum:t.envName==="equation",emptySingleRow:!0,singleRow:!0,maxNumCols:1,envClasses:["align"],leqno:t.parser.settings.leqno};return Mt(t.parser,e,"display")},mathmlBuilder:vt}),wt({type:"array",names:["multline","multline*"],props:{numArgs:0},handler(t){ee(t);const e={addEqnNum:t.envName==="multline",maxNumCols:1,envClasses:["jot","multline"],leqno:t.parser.settings.leqno};return Mt(t.parser,e,"display")},mathmlBuilder:vt}),wt({type:"array",names:["CD"],props:{numArgs:0},handler(t){return ee(t),Ys(t.parser)},mathmlBuilder:vt}),$({type:"text",names:["\\hline","\\hdashline"],props:{numArgs:0,allowedInText:!0,allowedInMath:!0},handler(t,e){throw new q(`${t.funcName} valid only within array environment`)}});const mr=er;$({type:"environment",names:["\\begin","\\end"],props:{numArgs:1,argTypes:["text"]},handler({parser:t,funcName:e},n){const r=n[0];if(r.type!=="ordgroup")throw new q("Invalid environment name",r);let s="";for(let a=0;a<r.body.length;++a)s+=F(r.body[a],"textord").text;if(e==="\\begin"){if(!Object.prototype.hasOwnProperty.call(mr,s))throw new q("No such environment: "+s,r);const a=mr[s],{args:l,optArgs:u}=t.parseArguments("\\begin{"+s+"}",a),c={mode:t.mode,envName:s,parser:t},m=a.handler(c,l,u);t.expect("\\end",!1);const b=t.nextToken,A=F(t.parseFunction(),"environment");if(A.name!==s)throw new q(`Mismatch: \\begin{${s}} matched by \\end{${A.name}}`,b);return m}return{type:"environment",mode:t.mode,name:s,nameGroup:r}}}),$({type:"envTag",names:["\\env@tag"],props:{numArgs:1,argTypes:["math"]},handler({parser:t},e){return{type:"envTag",mode:t.mode,body:e[0]}},mathmlBuilder(t,e){return new y.MathNode("mrow")}}),$({type:"noTag",names:["\\env@notag"],props:{numArgs:0},handler({parser:t}){return{type:"noTag",mode:t.mode}},mathmlBuilder(t,e){return new y.MathNode("mrow")}});const ui=(t,e)=>{if(e!=="mathrm"||t.body.type!=="ordgroup"||t.body.body.length===1||t.body.body[0].type!=="mathord")return!1;for(let n=1;n<t.body.body.length;n++){const r=t.body.body[n].type;if(!(r==="mathord"||r==="textord"&&!isNaN(t.body.body[n].text)))return!1}return!0},fr=(t,e)=>{const n=t.font,r=e.withFont(n),s=tt(t.body,r);if(s.children.length===0)return s;if(n==="boldsymbol"&&["mo","mpadded","mrow"].includes(s.type))return s.style.fontWeight="bold",s;if(ui(t,n)){const u=s.children[0].children[0];delete u.attributes.mathvariant;for(let m=1;m<s.children.length;m++)u.children[0].text+=s.children[m].type==="mn"?s.children[m].children[0].text:s.children[m].children[0].children[0].text;const c=new y.MathNode("mtext",new y.TextNode("​"));return new y.MathNode("mrow",[c,u])}let a=s.children[0].type==="mo";for(let u=1;u<s.children.length;u++)s.children[u].type==="mo"&&n==="boldsymbol"&&(s.children[u].style.fontWeight="bold"),s.children[u].type!=="mi"&&(a=!1),(s.children[u].attributes&&s.children[u].attributes.mathvariant||"")!=="normal"&&(a=!1);if(!a)return s;const l=s.children[0];for(let u=1;u<s.children.length;u++)l.children.push(s.children[u].children[0]);if(l.attributes.mathvariant&&l.attributes.mathvariant==="normal"){const u=new y.MathNode("mtext",new y.TextNode("​"));return new y.MathNode("mrow",[u,l])}return l},gr={"\\Bbb":"\\mathbb","\\bold":"\\mathbf","\\frak":"\\mathfrak","\\bm":"\\boldsymbol"};$({type:"font",names:["\\mathrm","\\mathit","\\mathbf","\\mathnormal","\\up@greek","\\boldsymbol","\\mathbb","\\mathcal","\\mathfrak","\\mathscr","\\mathsf","\\mathtt","\\Bbb","\\bm","\\bold","\\frak"],props:{numArgs:1,allowedInArgument:!0},handler:({parser:t,funcName:e},n)=>{const r=Xt(n[0]);let s=e;return s in gr&&(s=gr[s]),{type:"font",mode:t.mode,font:s.slice(1),body:r}},mathmlBuilder:fr}),$({type:"font",names:["\\rm","\\sf","\\tt","\\bf","\\it","\\cal"],props:{numArgs:0,allowedInText:!0},handler:({parser:t,funcName:e,breakOnTokenText:n},r)=>{const{mode:s}=t,a=t.parseExpression(!0,n,!0),l=`math${e.slice(1)}`;return{type:"font",mode:s,font:l,body:{type:"ordgroup",mode:t.mode,body:a}}},mathmlBuilder:fr});const br=["display","text","script","scriptscript"],ci={auto:-1,display:0,text:0,script:1,scriptscript:2},Ye=(t,e)=>{const n=t.scriptLevel==="auto"?e.incrementLevel():t.scriptLevel==="display"?e.withLevel(ct.TEXT):t.scriptLevel==="text"?e.withLevel(ct.SCRIPT):e.withLevel(ct.SCRIPTSCRIPT);let r=new y.MathNode("mfrac",[tt(t.numer,n),tt(t.denom,n)]);if(!t.hasBarLine)r.setAttribute("linethickness","0px");else if(t.barSize){const s=kt(t.barSize,e);r.setAttribute("linethickness",s.number+s.unit)}if(t.leftDelim!=null||t.rightDelim!=null){const s=[];if(t.leftDelim!=null){const a=new y.MathNode("mo",[new y.TextNode(t.leftDelim.replace("\\",""))]);a.setAttribute("fence","true"),s.push(a)}if(s.push(r),t.rightDelim!=null){const a=new y.MathNode("mo",[new y.TextNode(t.rightDelim.replace("\\",""))]);a.setAttribute("fence","true"),s.push(a)}r=ze(s)}return t.scriptLevel!=="auto"&&(r=new y.MathNode("mstyle",[r]),r.setAttribute("displaystyle",String(t.scriptLevel==="display")),r.setAttribute("scriptlevel",ci[t.scriptLevel])),r};$({type:"genfrac",names:["\\dfrac","\\frac","\\tfrac","\\dbinom","\\binom","\\tbinom","\\\\atopfrac","\\\\bracefrac","\\\\brackfrac"],props:{numArgs:2,allowedInArgument:!0},handler:({parser:t,funcName:e},n)=>{const r=n[0],s=n[1];let a=!1,l=null,u=null,c="auto";switch(e){case"\\dfrac":case"\\frac":case"\\tfrac":a=!0;break;case"\\\\atopfrac":a=!1;break;case"\\dbinom":case"\\binom":case"\\tbinom":l="(",u=")";break;case"\\\\bracefrac":l="\\{",u="\\}";break;case"\\\\brackfrac":l="[",u="]";break;default:throw new Error("Unrecognized genfrac command")}switch(e){case"\\dfrac":case"\\dbinom":c="display";break;case"\\tfrac":case"\\tbinom":c="text";break}return{type:"genfrac",mode:t.mode,continued:!1,numer:r,denom:s,hasBarLine:a,leftDelim:l,rightDelim:u,scriptLevel:c,barSize:null}},mathmlBuilder:Ye}),$({type:"genfrac",names:["\\cfrac"],props:{numArgs:2},handler:({parser:t,funcName:e},n)=>{const r=n[0],s=n[1];return{type:"genfrac",mode:t.mode,continued:!0,numer:r,denom:s,hasBarLine:!0,leftDelim:null,rightDelim:null,scriptLevel:"display",barSize:null}}}),$({type:"infix",names:["\\over","\\choose","\\atop","\\brace","\\brack"],props:{numArgs:0,infix:!0},handler({parser:t,funcName:e,token:n}){let r;switch(e){case"\\over":r="\\frac";break;case"\\choose":r="\\binom";break;case"\\atop":r="\\\\atopfrac";break;case"\\brace":r="\\\\bracefrac";break;case"\\brack":r="\\\\brackfrac";break;default:throw new Error("Unrecognized infix genfrac command")}return{type:"infix",mode:t.mode,replaceWith:r,token:n}}});const xr=function(t){let e=null;return t.length>0&&(e=t,e=e==="."?null:e),e};$({type:"genfrac",names:["\\genfrac"],props:{numArgs:6,allowedInArgument:!0,argTypes:["math","math","size","text","math","math"]},handler({parser:t},e){const n=e[4],r=e[5],s=Xt(e[0]),a=s.type==="atom"&&s.family==="open"?xr(s.text):null,l=Xt(e[1]),u=l.type==="atom"&&l.family==="close"?xr(l.text):null,c=F(e[2],"size");let m,b=null;c.isBlank?m=!0:(b=c.value,m=b.number>0);let A="auto",x=e[3];if(x.type==="ordgroup"){if(x.body.length>0){const T=F(x.body[0],"textord");A=br[Number(T.text)]}}else x=F(x,"textord"),A=br[Number(x.text)];return{type:"genfrac",mode:t.mode,numer:n,denom:r,continued:!1,hasBarLine:m,barSize:b,leftDelim:a,rightDelim:u,scriptLevel:A}},mathmlBuilder:Ye}),$({type:"infix",names:["\\above"],props:{numArgs:1,argTypes:["size"],infix:!0},handler({parser:t,funcName:e,token:n},r){return{type:"infix",mode:t.mode,replaceWith:"\\\\abovefrac",barSize:F(r[0],"size").value,token:n}}}),$({type:"genfrac",names:["\\\\abovefrac"],props:{numArgs:3,argTypes:["math","size","math"]},handler:({parser:t,funcName:e},n)=>{const r=n[0],s=ks(F(n[1],"infix").barSize),a=n[2],l=s.number>0;return{type:"genfrac",mode:t.mode,numer:r,denom:a,continued:!1,hasBarLine:l,barSize:s,leftDelim:null,rightDelim:null,scriptLevel:"auto"}},mathmlBuilder:Ye}),$({type:"hbox",names:["\\hbox"],props:{numArgs:1,argTypes:["hbox"],allowedInArgument:!0,allowedInText:!1},handler({parser:t},e){return{type:"hbox",mode:t.mode,body:it(e[0])}},mathmlBuilder(t,e){const n=e.withLevel(ct.TEXT),r=Tt(t.body,n);return Fe(r)}}),$({type:"horizBrace",names:["\\overbrace","\\underbrace"],props:{numArgs:1},handler({parser:t,funcName:e},n){return{type:"horizBrace",mode:t.mode,label:e,isOver:/^\\over/.test(e),base:n[0]}},mathmlBuilder:(t,e)=>{const n=he.mathMLnode(t.label);return n.style["math-depth"]=0,new y.MathNode(t.isOver?"mover":"munder",[tt(t.base,e),n])}}),$({type:"href",names:["\\href"],props:{numArgs:2,argTypes:["url","original"],allowedInText:!0},handler:({parser:t,token:e},n)=>{const r=n[1],s=F(n[0],"url").url;if(!t.settings.isTrusted({command:"\\href",url:s}))throw new q('Function "\\href" is not trusted',e);return{type:"href",mode:t.mode,href:s,body:it(r)}},mathmlBuilder:(t,e)=>{let n=Tt(t.body,e);return n instanceof ht||(n=new ht("mrow",[n])),n.setAttribute("href",t.href),n}}),$({type:"href",names:["\\url"],props:{numArgs:1,argTypes:["url"],allowedInText:!0},handler:({parser:t,token:e},n)=>{const r=F(n[0],"url").url;if(!t.settings.isTrusted({command:"\\url",url:r}))throw new q('Function "\\url" is not trusted',e);const s=[];for(let l=0;l<r.length;l++){let u=r[l];u==="~"&&(u="\\textasciitilde"),s.push({type:"textord",mode:"text",text:u})}const a={type:"text",mode:t.mode,font:"\\texttt",body:s};return{type:"href",mode:t.mode,href:r,body:it(a)}}}),$({type:"html",names:["\\class","\\id","\\style","\\data"],props:{numArgs:2,argTypes:["raw","original"],allowedInText:!0},handler:({parser:t,funcName:e,token:n},r)=>{const s=F(r[0],"raw").string,a=r[1];if(t.settings.strict)throw new q(`Function "${e}" is disabled in strict mode`,n);let l;const u={};switch(e){case"\\class":u.class=s,l={command:"\\class",class:s};break;case"\\id":u.id=s,l={command:"\\id",id:s};break;case"\\style":u.style=s,l={command:"\\style",style:s};break;case"\\data":{const c=s.split(",");for(let m=0;m<c.length;m++){const b=c[m].split("=");if(b.length!==2)throw new q("Error parsing key-value for \\data");u["data-"+b[0].trim()]=b[1].trim()}l={command:"\\data",attributes:u};break}default:throw new Error("Unrecognized html command")}if(!t.settings.isTrusted(l))throw new q(`Function "${e}" is not trusted`,n);return{type:"html",mode:t.mode,attributes:u,body:it(a)}},mathmlBuilder:(t,e)=>{const n=Tt(t.body,e),r=[];t.attributes.class&&r.push(...t.attributes.class.trim().split(/\s+/)),n.classes=r;for(const s in t.attributes)s!=="class"&&Object.prototype.hasOwnProperty.call(t.attributes,s)&&n.setAttribute(s,t.attributes[s]);return n}});const Ke=function(t){if(/^[-+]? *(\d+(\.\d*)?|\.\d+)$/.test(t))return{number:+t,unit:"bp"};{const e=/([-+]?) *(\d+(?:\.\d*)?|\.\d+) *([a-z]{2})/.exec(t);if(!e)throw new q("Invalid size: '"+t+"' in \\includegraphics");const n={number:+(e[1]+e[2]),unit:e[3]};if(!Rn(n))throw new q("Invalid unit: '"+n.unit+"' in \\includegraphics.");return n}};$({type:"includegraphics",names:["\\includegraphics"],props:{numArgs:1,numOptionalArgs:1,argTypes:["raw","url"],allowedInText:!1},handler:({parser:t,token:e},n,r)=>{let s={number:0,unit:"em"},a={number:.9,unit:"em"},l={number:0,unit:"em"},u="";if(r[0]){const b=F(r[0],"raw").string.split(",");for(let A=0;A<b.length;A++){const x=b[A].split("=");if(x.length===2){const T=x[1].trim();switch(x[0].trim()){case"alt":u=T;break;case"width":s=Ke(T);break;case"height":a=Ke(T);break;case"totalheight":l=Ke(T);break;default:throw new q("Invalid key: '"+x[0]+"' in \\includegraphics.")}}}}const c=F(n[0],"url").url;if(u===""&&(u=c,u=u.replace(/^.*[\\/]/,""),u=u.substring(0,u.lastIndexOf("."))),!t.settings.isTrusted({command:"\\includegraphics",url:c}))throw new q('Function "\\includegraphics" is not trusted',e);return{type:"includegraphics",mode:t.mode,alt:u,width:s,height:a,totalheight:l,src:c}},mathmlBuilder:(t,e)=>{const n=kt(t.height,e),r={number:0,unit:"em"};t.totalheight.number>0&&t.totalheight.unit===n.unit&&t.totalheight.number>n.number&&(r.number=t.totalheight.number-n.number,r.unit=n.unit);let s=0;t.width.number>0&&(s=kt(t.width,e));const a={height:n.number+r.number+"em"};s.number>0&&(a.width=s.number+s.unit),r.number>0&&(a.verticalAlign=-r.number+r.unit);const l=new Cs(t.src,t.alt,a);return l.height=n,l.depth=r,new y.MathNode("mtext",[l])}}),$({type:"kern",names:["\\kern","\\mkern","\\hskip","\\mskip"],props:{numArgs:1,argTypes:["size"],primitive:!0,allowedInText:!0},handler({parser:t,funcName:e,token:n},r){const s=F(r[0],"size");if(t.settings.strict){const a=e[1]==="m",l=s.value.unit==="mu";if(a){if(!l)throw new q(`LaTeX's ${e} supports only mu units, not ${s.value.unit} units`,n);if(t.mode!=="math")throw new q(`LaTeX's ${e} works only in math mode`,n)}else if(l)throw new q(`LaTeX's ${e} doesn't support mu units`,n)}return{type:"kern",mode:t.mode,dimension:s.value}},mathmlBuilder(t,e){const n=kt(t.dimension,e),r=n.unit==="em"?yr(n.number):"";if(t.mode==="text"&&r.length>0){const s=new y.TextNode(r);return new y.MathNode("mtext",[s])}else{const s=new y.MathNode("mspace");return s.setAttribute("width",n.number+n.unit),n.number<0&&(s.style.marginLeft=n.number+n.unit),s}}});const yr=function(t){return t>=.05555&&t<=.05556?" ":t>=.1666&&t<=.1667?" ":t>=.2222&&t<=.2223?" ":t>=.2777&&t<=.2778?"  ":""},wr=/[^A-Za-z_0-9-]/g;$({type:"label",names:["\\label"],props:{numArgs:1,argTypes:["raw"]},handler({parser:t},e){return{type:"label",mode:t.mode,string:e[0].string.replace(wr,"")}},mathmlBuilder(t,e){const n=new y.MathNode("mrow",[],["tml-label"]);return t.string.length>0&&n.setAttribute("id",t.string),n}});const hi=["\\clap","\\llap","\\rlap"];$({type:"lap",names:["\\mathllap","\\mathrlap","\\mathclap","\\clap","\\llap","\\rlap"],props:{numArgs:1,allowedInText:!0},handler:({parser:t,funcName:e,token:n},r)=>{if(hi.includes(e)){if(t.settings.strict&&t.mode!=="text")throw new q(`{${e}} can be used only in text mode.
 Try \\math${e.slice(1)}`,n);e=e.slice(1)}else e=e.slice(5);const s=r[0];return{type:"lap",mode:t.mode,alignment:e,body:s}},mathmlBuilder:(t,e)=>{let n;if(t.alignment==="llap"){const a=dt(it(t.body),e),l=new y.MathNode("mphantom",a);n=new y.MathNode("mpadded",[l]),n.setAttribute("width","0px")}const r=tt(t.body,e);let s;if(t.alignment==="llap"?(r.style.position="absolute",r.style.right="0",r.style.bottom="0",s=new y.MathNode("mpadded",[n,r])):s=new y.MathNode("mpadded",[r]),t.alignment==="rlap")t.body.body.length>0&&t.body.body[0].type==="genfrac"&&s.setAttribute("lspace","0.16667em");else{const a=t.alignment==="llap"?"-1":"-0.5";s.setAttribute("lspace",a+"width"),t.alignment==="llap"?s.style.position="relative":(s.style.display="flex",s.style.justifyContent="center")}return s.setAttribute("width","0px"),s}}),$({type:"ordgroup",names:["\\(","$"],props:{numArgs:0,allowedInText:!0,allowedInMath:!1},handler({funcName:t,parser:e},n){const r=e.mode;e.switchMode("math");const s=t==="\\("?"\\)":"$",a=e.parseExpression(!1,s);return e.expect(s),e.switchMode(r),{type:"ordgroup",mode:e.mode,body:a}}}),$({type:"text",names:["\\)","\\]"],props:{numArgs:0,allowedInText:!0,allowedInMath:!1},handler(t,e){throw new q(`Mismatched ${t.funcName}`,e)}});const di=(t,e)=>{switch(e.level){case ct.DISPLAY:return t.display;case ct.TEXT:return t.text;case ct.SCRIPT:return t.script;case ct.SCRIPTSCRIPT:return t.scriptscript;default:return t.text}};$({type:"mathchoice",names:["\\mathchoice"],props:{numArgs:4,primitive:!0},handler:({parser:t},e)=>({type:"mathchoice",mode:t.mode,display:it(e[0]),text:it(e[1]),script:it(e[2]),scriptscript:it(e[3])}),mathmlBuilder:(t,e)=>{const n=di(t,e);return Tt(n,e)}});const pi=["text","textord","mathord","atom"],Lt=t=>{const e=new y.MathNode("mspace");return e.setAttribute("width",t+"em"),e};function vr(t,e){let n;const r=dt(t.body,e);if(t.mclass==="minner")n=new y.MathNode("mpadded",r);else if(t.mclass==="mord")t.isCharacterBox||r[0].type==="mathord"?(n=r[0],n.type="mi",n.children.length===1&&n.children[0].text&&n.children[0].text==="∇"&&n.setAttribute("mathvariant","normal")):n=new y.MathNode("mi",r);else{n=new y.MathNode("mrow",r),t.mustPromote?(n=r[0],n.type="mo",t.isCharacterBox&&t.body[0].text&&/[A-Za-z]/.test(t.body[0].text)&&n.setAttribute("mathvariant","italic")):n=new y.MathNode("mrow",r);const s=e.level<2;n.type==="mrow"?s&&(t.mclass==="mbin"?(n.children.unshift(Lt(.2222)),n.children.push(Lt(.2222))):t.mclass==="mrel"?(n.children.unshift(Lt(.2778)),n.children.push(Lt(.2778))):t.mclass==="mpunct"?n.children.push(Lt(.1667)):t.mclass==="minner"&&(n.children.unshift(Lt(.0556)),n.children.push(Lt(.0556)))):t.mclass==="mbin"?(n.attributes.lspace=s?"0.2222em":"0",n.attributes.rspace=s?"0.2222em":"0"):t.mclass==="mrel"?(n.attributes.lspace=s?"0.2778em":"0",n.attributes.rspace=s?"0.2778em":"0"):t.mclass==="mpunct"?(n.attributes.lspace="0em",n.attributes.rspace=s?"0.1667em":"0"):t.mclass==="mopen"||t.mclass==="mclose"?(n.attributes.lspace="0em",n.attributes.rspace="0em"):t.mclass==="minner"&&s&&(n.attributes.lspace="0.0556em",n.attributes.width="+0.1111em"),t.mclass==="mopen"||t.mclass==="mclose"||(delete n.attributes.stretchy,delete n.attributes.form)}return n}$({type:"mclass",names:["\\mathord","\\mathbin","\\mathrel","\\mathopen","\\mathclose","\\mathpunct","\\mathinner"],props:{numArgs:1,primitive:!0},handler({parser:t,funcName:e},n){const r=n[0],s=Q.isCharacterBox(r);let a=!0;const l={type:"mathord",text:"",mode:t.mode},u=r.body?r.body:[r];for(const c of u)if(pi.includes(c.type))lt[t.mode][c.text]?l.text+=lt[t.mode][c.text].replace:c.text?l.text+=c.text:c.body&&c.body.map(m=>{l.text+=m.text});else{a=!1;break}return{type:"mclass",mode:t.mode,mclass:"m"+e.slice(5),body:it(a?l:r),isCharacterBox:s,mustPromote:a}},mathmlBuilder:vr});const mi=t=>{const e=t.type==="ordgroup"&&t.body.length?t.body[0]:t;return e.type==="atom"&&(e.family==="bin"||e.family==="rel")?"m"+e.family:"mord"};$({type:"mclass",names:["\\@binrel"],props:{numArgs:2},handler({parser:t},e){return{type:"mclass",mode:t.mode,mclass:mi(e[0]),body:it(e[1]),isCharacterBox:Q.isCharacterBox(e[1])}}}),$({type:"mclass",names:["\\stackrel","\\overset","\\underset"],props:{numArgs:2},handler({parser:t,funcName:e},n){const r=n[1],s=n[0],a={type:"op",mode:r.mode,limits:!0,alwaysHandleSupSub:!0,parentIsSupSub:!1,symbol:!1,stack:!0,suppressBaseShift:e!=="\\stackrel",body:it(r)};return{type:"supsub",mode:s.mode,base:a,sup:e==="\\underset"?null:s,sub:e==="\\underset"?s:null}},mathmlBuilder:vr});const xe=(t,e,n)=>{if(!t)return n;const r=tt(t,e);return r.type==="mrow"&&r.children.length===0?n:r};$({type:"multiscript",names:["\\sideset","\\pres@cript"],props:{numArgs:3},handler({parser:t,funcName:e,token:n},r){if(r[2].body.length===0)throw new q(e+"cannot parse an empty base.");const s=r[2].body[0];if(t.settings.strict&&e==="\\sideset"&&!s.symbol)throw new q("The base of \\sideset must be a big operator. Try \\prescript.");if(r[0].body.length>0&&r[0].body[0].type!=="supsub"||r[1].body.length>0&&r[1].body[0].type!=="supsub")throw new q("\\sideset can parse only subscripts and superscripts in its first two arguments",n);const a=r[0].body.length>0?r[0].body[0]:null,l=r[1].body.length>0?r[1].body[0]:null;return!a&&!l?s:a?{type:"multiscript",mode:t.mode,isSideset:e==="\\sideset",prescripts:a,postscripts:l,base:s}:{type:"styling",mode:t.mode,scriptLevel:"text",body:[{type:"supsub",mode:t.mode,base:s,sup:l.sup,sub:l.sub}]}},mathmlBuilder(t,e){const n=tt(t.base,e),r=new y.MathNode("mprescripts"),s=new y.MathNode("none");let a=[];const l=xe(t.prescripts.sub,e,s),u=xe(t.prescripts.sup,e,s);if(t.isSideset&&(l.setAttribute("style","text-align: left;"),u.setAttribute("style","text-align: left;")),t.postscripts){const c=xe(t.postscripts.sub,e,s),m=xe(t.postscripts.sup,e,s);a=[n,c,m,r,l,u]}else a=[n,r,l,u];return new y.MathNode("mmultiscripts",a)}}),$({type:"not",names:["\\not"],props:{numArgs:1,primitive:!0,allowedInText:!1},handler({parser:t},e){const n=Q.isCharacterBox(e[0]);let r;return n?(r=it(e[0]),r[0].text.charAt(0)==="\\"&&(r[0].text=lt.math[r[0].text].replace),r[0].text=r[0].text.slice(0,1)+"̸"+r[0].text.slice(1)):r=[{type:"textord",mode:"math",text:"̸"},{type:"kern",mode:"math",dimension:{number:-.6,unit:"em"}},e[0]],{type:"not",mode:t.mode,body:r,isCharacterBox:n}},mathmlBuilder(t,e){return t.isCharacterBox?dt(t.body,e,!0)[0]:Tt(t.body,e)}});const fi=["textord","mathord","atom"],gi=["\\smallint"],Qe=["textord","mathord","ordgroup","close","leftright","font"],kr=t=>{t.attributes.lspace="0.1667em",t.attributes.rspace="0.1667em"},ne=(t,e)=>{let n;if(t.symbol)n=new ht("mo",[ft(t.name,t.mode)]),gi.includes(t.name)?n.setAttribute("largeop","false"):t.limits?n.setAttribute("stretchy","true"):n.setAttribute("movablelimits","false"),t.fromMathOp&&kr(n);else if(t.body)n=new ht("mo",dt(t.body,e)),t.fromMathOp&&kr(n);else if(n=new ht("mi",[new On(t.name.slice(1))]),!t.parentIsSupSub){const r=new ht("mo",[ft("⁡","text")]),s=[n,r];if(t.needsLeadingSpace){const a=new ht("mspace");a.setAttribute("width","0.1667em"),s.unshift(a)}if(!t.isFollowedByDelimiter){const a=new ht("mspace");a.setAttribute("width","0.1667em"),s.push(a)}n=new ht("mrow",s)}return n},bi={"∏":"\\prod","∐":"\\coprod","∑":"\\sum","⋀":"\\bigwedge","⋁":"\\bigvee","⋂":"\\bigcap","⋃":"\\bigcup","⨀":"\\bigodot","⨁":"\\bigoplus","⨂":"\\bigotimes","⨄":"\\biguplus","⨅":"\\bigsqcap","⨆":"\\bigsqcup","⨃":"\\bigcupdot","⨇":"\\bigdoublevee","⨈":"\\bigdoublewedge","⨉":"\\bigtimes"};$({type:"op",names:["\\coprod","\\bigvee","\\bigwedge","\\biguplus","\\bigcupplus","\\bigcupdot","\\bigcap","\\bigcup","\\bigdoublevee","\\bigdoublewedge","\\intop","\\prod","\\sum","\\bigotimes","\\bigoplus","\\bigodot","\\bigsqcap","\\bigsqcup","\\bigtimes","\\smallint","∏","∐","∑","⋀","⋁","⋂","⋃","⨀","⨁","⨂","⨄","⨆"],props:{numArgs:0},handler:({parser:t,funcName:e},n)=>{let r=e;return r.length===1&&(r=bi[r]),{type:"op",mode:t.mode,limits:!0,parentIsSupSub:!1,symbol:!0,stack:!1,name:r}},mathmlBuilder:ne}),$({type:"op",names:["\\mathop"],props:{numArgs:1,primitive:!0},handler:({parser:t},e)=>{const n=e[0],r=n.body?n.body:[n],s=r.length===1&&fi.includes(r[0].type);return{type:"op",mode:t.mode,limits:!0,parentIsSupSub:!1,symbol:s,fromMathOp:!0,stack:!1,name:s?r[0].text:null,body:s?null:it(n)}},mathmlBuilder:ne});const xi={"∫":"\\int","∬":"\\iint","∭":"\\iiint","∮":"\\oint","∯":"\\oiint","∰":"\\oiiint","∱":"\\intclockwise","∲":"\\varointclockwise","⨌":"\\iiiint","⨍":"\\intbar","⨎":"\\intBar","⨏":"\\fint","⨒":"\\rppolint","⨓":"\\scpolint","⨕":"\\pointint","⨖":"\\sqint","⨗":"\\intlarhk","⨘":"\\intx","⨙":"\\intcap","⨚":"\\intcup"};$({type:"op",names:["\\arcsin","\\arccos","\\arctan","\\arctg","\\arcctg","\\arg","\\ch","\\cos","\\cosec","\\cosh","\\cot","\\cotg","\\coth","\\csc","\\ctg","\\cth","\\deg","\\dim","\\exp","\\hom","\\ker","\\lg","\\ln","\\log","\\sec","\\sin","\\sinh","\\sh","\\sgn","\\tan","\\tanh","\\tg","\\th"],props:{numArgs:0},handler({parser:t,funcName:e}){const n=t.prevAtomType,r=t.gullet.future().text;return{type:"op",mode:t.mode,limits:!1,parentIsSupSub:!1,symbol:!1,stack:!1,isFollowedByDelimiter:be(r),needsLeadingSpace:n.length>0&&Qe.includes(n),name:e}},mathmlBuilder:ne}),$({type:"op",names:["\\det","\\gcd","\\inf","\\lim","\\max","\\min","\\Pr","\\sup"],props:{numArgs:0},handler({parser:t,funcName:e}){const n=t.prevAtomType,r=t.gullet.future().text;return{type:"op",mode:t.mode,limits:!0,parentIsSupSub:!1,symbol:!1,stack:!1,isFollowedByDelimiter:be(r),needsLeadingSpace:n.length>0&&Qe.includes(n),name:e}},mathmlBuilder:ne}),$({type:"op",names:["\\int","\\iint","\\iiint","\\iiiint","\\oint","\\oiint","\\oiiint","\\intclockwise","\\varointclockwise","\\intbar","\\intBar","\\fint","\\rppolint","\\scpolint","\\pointint","\\sqint","\\intlarhk","\\intx","\\intcap","\\intcup","∫","∬","∭","∮","∯","∰","∱","∲","⨌","⨍","⨎","⨏","⨒","⨓","⨕","⨖","⨗","⨘","⨙","⨚"],props:{numArgs:0},handler({parser:t,funcName:e}){let n=e;return n.length===1&&(n=xi[n]),{type:"op",mode:t.mode,limits:!1,parentIsSupSub:!1,symbol:!0,stack:!1,name:n}},mathmlBuilder:ne}),$({type:"operatorname",names:["\\operatorname@","\\operatornamewithlimits"],props:{numArgs:1,allowedInArgument:!0},handler:({parser:t,funcName:e},n)=>{const r=n[0],s=t.prevAtomType,a=t.gullet.future().text;return{type:"operatorname",mode:t.mode,body:it(r),alwaysHandleSupSub:e==="\\operatornamewithlimits",limits:!1,parentIsSupSub:!1,isFollowedByDelimiter:be(a),needsLeadingSpace:s.length>0&&Qe.includes(s)}},mathmlBuilder:(t,e)=>{let n=dt(t.body,e.withFont("mathrm")),r=!0;for(let a=0;a<n.length;a++){let l=n[a];if(l instanceof y.MathNode)switch(l.type==="mrow"&&l.children.length===1&&l.children[0]instanceof y.MathNode&&(l=l.children[0]),l.type){case"mi":case"mn":case"ms":case"mtext":break;case"mspace":if(l.attributes.width){const u=l.attributes.width.replace("em",""),c=yr(Number(u));c===""?r=!1:n[a]=new y.MathNode("mtext",[new y.TextNode(c)])}break;case"mo":{const u=l.children[0];l.children.length===1&&u instanceof y.TextNode?u.text=u.text.replace(/\u2212/,"-").replace(/\u2217/,"*"):r=!1;break}default:r=!1}else r=!1}if(r){const a=n.map(l=>l.toText()).join("");n=[new y.TextNode(a)]}else if(n.length===1&&["mover","munder"].includes(n[0].type)&&(n[0].children[0].type==="mi"||n[0].children[0].type==="mtext")){if(n[0].children[0].type="mi",t.parentIsSupSub)return new y.MathNode("mrow",n);{const a=new y.MathNode("mo",[ft("⁡","text")]);return y.newDocumentFragment([n[0],a])}}let s;if(r?(s=new y.MathNode("mi",n),n[0].text.length===1&&s.setAttribute("mathvariant","normal")):s=new y.MathNode("mrow",n),!t.parentIsSupSub){const a=new y.MathNode("mo",[ft("⁡","text")]),l=[s,a];if(t.needsLeadingSpace){const u=new y.MathNode("mspace");u.setAttribute("width","0.1667em"),l.unshift(u)}if(!t.isFollowedByDelimiter){const u=new y.MathNode("mspace");u.setAttribute("width","0.1667em"),l.push(u)}return y.newDocumentFragment(l)}return s}}),h("\\operatorname","\\@ifstar\\operatornamewithlimits\\operatorname@"),Pt({type:"ordgroup",mathmlBuilder(t,e){return Tt(t.body,e,t.semisimple)}}),$({type:"phantom",names:["\\phantom"],props:{numArgs:1,allowedInText:!0},handler:({parser:t},e)=>{const n=e[0];return{type:"phantom",mode:t.mode,body:it(n)}},mathmlBuilder:(t,e)=>{const n=dt(t.body,e);return new y.MathNode("mphantom",n)}}),$({type:"hphantom",names:["\\hphantom"],props:{numArgs:1,allowedInText:!0},handler:({parser:t},e)=>{const n=e[0];return{type:"hphantom",mode:t.mode,body:n}},mathmlBuilder:(t,e)=>{const n=dt(it(t.body),e),r=new y.MathNode("mphantom",n),s=new y.MathNode("mpadded",[r]);return s.setAttribute("height","0px"),s.setAttribute("depth","0px"),s}}),$({type:"vphantom",names:["\\vphantom"],props:{numArgs:1,allowedInText:!0},handler:({parser:t},e)=>{const n=e[0];return{type:"vphantom",mode:t.mode,body:n}},mathmlBuilder:(t,e)=>{const n=dt(it(t.body),e),r=new y.MathNode("mphantom",n),s=new y.MathNode("mpadded",[r]);return s.setAttribute("width","0px"),s}}),$({type:"pmb",names:["\\pmb"],props:{numArgs:1,allowedInText:!0},handler({parser:t},e){return{type:"pmb",mode:t.mode,body:it(e[0])}},mathmlBuilder(t,e){const n=dt(t.body,e),r=Le(n);return r.setAttribute("style","font-weight:bold"),r}});const _r=(t,e)=>{const n=e.withLevel(ct.TEXT),r=new y.MathNode("mpadded",[tt(t.body,n)]),s=kt(t.dy,e);return r.setAttribute("voffset",s.number+s.unit),s.number>0?r.style.padding=s.number+s.unit+" 0 0 0":r.style.padding="0 0 "+Math.abs(s.number)+s.unit+" 0",r};$({type:"raise",names:["\\raise","\\lower"],props:{numArgs:2,argTypes:["size","primitive"],primitive:!0},handler({parser:t,funcName:e},n){const r=F(n[0],"size").value;e==="\\lower"&&(r.number*=-1);const s=n[1];return{type:"raise",mode:t.mode,dy:r,body:s}},mathmlBuilder:_r}),$({type:"raise",names:["\\raisebox"],props:{numArgs:2,argTypes:["size","hbox"],allowedInText:!0},handler({parser:t,funcName:e},n){const r=F(n[0],"size").value,s=n[1];return{type:"raise",mode:t.mode,dy:r,body:s}},mathmlBuilder:_r}),$({type:"ref",names:["\\ref","\\eqref"],props:{numArgs:1,argTypes:["raw"]},handler({parser:t,funcName:e},n){return{type:"ref",mode:t.mode,funcName:e,string:n[0].string.replace(wr,"")}},mathmlBuilder(t,e){const n=t.funcName==="\\ref"?["tml-ref"]:["tml-ref","tml-eqref"],r=new y.MathNode("mtext",[new y.TextNode("")],n);return r.setAttribute("href","#"+t.string),r}}),$({type:"reflect",names:["\\reflectbox"],props:{numArgs:1,argTypes:["hbox"],allowedInText:!0},handler({parser:t},e){return{type:"reflect",mode:t.mode,body:e[0]}},mathmlBuilder(t,e){const n=tt(t.body,e);return n.style.transform="scaleX(-1)",n}}),$({type:"internal",names:["\\relax"],props:{numArgs:0,allowedInText:!0},handler({parser:t}){return{type:"internal",mode:t.mode}}}),$({type:"rule",names:["\\rule"],props:{numArgs:2,numOptionalArgs:1,argTypes:["size","size","size"]},handler({parser:t},e,n){const r=n[0],s=F(e[0],"size"),a=F(e[1],"size");return{type:"rule",mode:t.mode,shift:r&&F(r,"size").value,width:s.value,height:a.value}},mathmlBuilder(t,e){const n=kt(t.width,e),r=kt(t.height,e),s=t.shift?kt(t.shift,e):{number:0,unit:"em"},a=e.color&&e.getColor()||"black",l=new y.MathNode("mspace");if(n.number>0&&r.number>0&&l.setAttribute("mathbackground",a),l.setAttribute("width",n.number+n.unit),l.setAttribute("height",r.number+r.unit),s.number===0)return l;const u=new y.MathNode("mpadded",[l]);return s.number>=0?u.setAttribute("height","+"+s.number+s.unit):(u.setAttribute("height",s.number+s.unit),u.setAttribute("depth","+"+-s.number+s.unit)),u.setAttribute("voffset",s.number+s.unit),u}});const Ar={"\\tiny":.5,"\\sixptsize":.6,"\\Tiny":.6,"\\scriptsize":.7,"\\footnotesize":.8,"\\small":.9,"\\normalsize":1,"\\large":1.2,"\\Large":1.44,"\\LARGE":1.728,"\\huge":2.074,"\\Huge":2.488};$({type:"sizing",names:["\\tiny","\\sixptsize","\\Tiny","\\scriptsize","\\footnotesize","\\small","\\normalsize","\\large","\\Large","\\LARGE","\\huge","\\Huge"],props:{numArgs:0,allowedInText:!0},handler:({breakOnTokenText:t,funcName:e,parser:n},r)=>{n.settings.strict&&n.mode==="math"&&console.log(`Temml strict-mode warning: Command ${e} is invalid in math mode.`);const s=n.parseExpression(!1,t,!0);return{type:"sizing",mode:n.mode,funcName:e,body:s}},mathmlBuilder:(t,e)=>{const n=e.withFontSize(Ar[t.funcName]),r=dt(t.body,n),s=Le(r),a=(Ar[t.funcName]/e.fontSize).toFixed(4);return s.setAttribute("mathsize",a+"em"),s}}),$({type:"smash",names:["\\smash"],props:{numArgs:1,numOptionalArgs:1,allowedInText:!0},handler:({parser:t},e,n)=>{let r=!1,s=!1;const a=n[0]&&F(n[0],"ordgroup");if(a){let u="";for(let c=0;c<a.body.length;++c)if(u=a.body[c].text,u==="t")r=!0;else if(u==="b")s=!0;else{r=!1,s=!1;break}}else r=!0,s=!0;const l=e[0];return{type:"smash",mode:t.mode,body:l,smashHeight:r,smashDepth:s}},mathmlBuilder:(t,e)=>{const n=new y.MathNode("mpadded",[tt(t.body,e)]);return t.smashHeight&&n.setAttribute("height","0px"),t.smashDepth&&n.setAttribute("depth","0px"),n}}),$({type:"sqrt",names:["\\sqrt"],props:{numArgs:1,numOptionalArgs:1},handler({parser:t},e,n){const r=n[0],s=e[0];return{type:"sqrt",mode:t.mode,body:s,index:r}},mathmlBuilder(t,e){const{body:n,index:r}=t;return r?new y.MathNode("mroot",[tt(n,e),tt(r,e.incrementLevel())]):new y.MathNode("msqrt",[tt(n,e)])}});const yi={display:0,text:1,script:2,scriptscript:3},wi={display:["0","true"],text:["0","false"],script:["1","false"],scriptscript:["2","false"]};$({type:"styling",names:["\\displaystyle","\\textstyle","\\scriptstyle","\\scriptscriptstyle"],props:{numArgs:0,allowedInText:!0,primitive:!0},handler({breakOnTokenText:t,funcName:e,parser:n},r){const s=n.parseExpression(!0,t,!0),a=e.slice(1,e.length-5);return{type:"styling",mode:n.mode,scriptLevel:a,body:s}},mathmlBuilder(t,e){const n=e.withLevel(yi[t.scriptLevel]),r=dt(t.body,n),s=Le(r),a=wi[t.scriptLevel];return s.setAttribute("scriptlevel",a[0]),s.setAttribute("displaystyle",a[1]),s}});const vi=/^m(over|under|underover)$/;Pt({type:"supsub",mathmlBuilder(t,e){let n=!1,r,s,a=!1,l=!1,u=!1;t.base&&t.base.type==="horizBrace"&&(s=!!t.sup,s===t.base.isOver&&(n=!0,r=t.base.isOver)),t.base&&!t.base.stack&&(t.base.type==="op"||t.base.type==="operatorname")&&(t.base.parentIsSupSub=!0,a=!t.base.symbol,l=a&&!t.isFollowedByDelimiter,u=t.base.needsLeadingSpace);const c=t.base&&t.base.stack?[tt(t.base.body[0],e)]:[tt(t.base,e)],m=e.inSubOrSup();if(t.sub&&c.push(tt(t.sub,m)),t.sup){const x=tt(t.sup,m),T=x.type==="mrow"?x.children[0]:x;T&&T.type==="mo"&&T.classes.includes("tml-prime")&&t.base&&t.base.text&&t.base.text==="f"&&T.classes.push("prime-pad"),c.push(x)}let b;if(n)b=r?"mover":"munder";else if(t.sub)if(t.sup){const x=t.base;x&&(x.type==="op"&&x.limits||x.type==="multiscript")&&(e.level===ct.DISPLAY||x.alwaysHandleSupSub)||x&&x.type==="operatorname"&&x.alwaysHandleSupSub&&(e.level===ct.DISPLAY||x.limits)?b="munderover":b="msubsup"}else{const x=t.base;x&&x.type==="op"&&x.limits&&(e.level===ct.DISPLAY||x.alwaysHandleSupSub)||x&&x.type==="operatorname"&&x.alwaysHandleSupSub&&(x.limits||e.level===ct.DISPLAY)?b="munder":b="msub"}else{const x=t.base;x&&x.type==="op"&&x.limits&&(e.level===ct.DISPLAY||x.alwaysHandleSupSub)||x&&x.type==="operatorname"&&x.alwaysHandleSupSub&&(x.limits||e.level===ct.DISPLAY)?b="mover":b="msup"}let A=new y.MathNode(b,c);if(a){const x=new y.MathNode("mo",[ft("⁡","text")]);if(u){const T=new y.MathNode("mspace");T.setAttribute("width","0.1667em"),A=y.newDocumentFragment([T,A,x])}else A=y.newDocumentFragment([A,x]);if(l){const T=new y.MathNode("mspace");T.setAttribute("width","0.1667em"),A.children.push(T)}}else vi.test(b)&&(A=new y.MathNode("mrow",[A]));return A}});const ki=["\\shortmid","\\nshortmid","\\shortparallel","\\nshortparallel","\\smallsetminus"],_i=["\\Rsh","\\Lsh","\\restriction"],Ai=t=>{if(t.length===1){const e=t.codePointAt(0);return 8591<e&&e<8704}return t.indexOf("arrow")>-1||t.indexOf("harpoon")>-1||_i.includes(t)};Pt({type:"atom",mathmlBuilder(t,e){const n=new y.MathNode("mo",[ft(t.text,t.mode)]);return t.family==="punct"?n.setAttribute("separator","true"):t.family==="open"||t.family==="close"?t.family==="open"?(n.setAttribute("form","prefix"),n.setAttribute("stretchy","false")):t.family==="close"&&(n.setAttribute("form","postfix"),n.setAttribute("stretchy","false")):t.text==="\\mid"?(n.setAttribute("lspace","0.22em"),n.setAttribute("rspace","0.22em"),n.setAttribute("stretchy","false")):t.family==="rel"&&Ai(t.text)?n.setAttribute("stretchy","false"):ki.includes(t.text)?n.setAttribute("mathsize","70%"):t.text===":"&&(n.attributes.lspace="0.2222em",n.attributes.rspace="0.2222em"),n}});const Sr={mathbf:"bold",mathrm:"normal",textit:"italic",mathit:"italic",mathnormal:"italic",mathbb:"double-struck",mathcal:"script",mathfrak:"fraktur",mathscr:"script",mathsf:"sans-serif",mathtt:"monospace"},Nr=function(t,e){if(e.fontFamily==="texttt")return"monospace";if(e.fontFamily==="textsc")return"normal";if(e.fontFamily==="textsf")return e.fontShape==="textit"&&e.fontWeight==="textbf"?"sans-serif-bold-italic":e.fontShape==="textit"?"sans-serif-italic":e.fontWeight==="textbf"?"sans-serif-bold":"sans-serif";if(e.fontShape==="textit"&&e.fontWeight==="textbf")return"bold-italic";if(e.fontShape==="textit")return"italic";if(e.fontWeight==="textbf")return"bold";const n=e.font;if(!n||n==="mathnormal")return null;const r=t.mode;switch(n){case"mathit":return"italic";case"mathrm":{const a=t.text.codePointAt(0);return 939<a&&a<975?"italic":"normal"}case"greekItalic":return"italic";case"up@greek":return"normal";case"boldsymbol":case"mathboldsymbol":return"bold-italic";case"mathbf":return"bold";case"mathbb":return"double-struck";case"mathfrak":return"fraktur";case"mathscr":case"mathcal":return"script";case"mathsf":return"sans-serif";case"mathtt":return"monospace"}let s=t.text;return lt[r][s]&&lt[r][s].replace&&(s=lt[r][s].replace),Object.prototype.hasOwnProperty.call(Sr,n)?Sr[n]:null},Cr=Object.freeze({B:8426,E:8427,F:8427,H:8387,I:8391,L:8390,M:8422,R:8393,e:8394,g:8355,o:8389}),Si=Object.freeze({C:8426,H:8388,I:8392,R:8394,Z:8398}),Ni=Object.freeze({C:8383,H:8389,N:8391,P:8393,Q:8393,R:8395,Z:8394}),Tr=Object.freeze({"ϵ":119527,ϑ:119564,ϰ:119534,φ:119577,ϱ:119535,ϖ:119563}),Ci=Object.freeze({"ϵ":119643,ϑ:119680,ϰ:119650,φ:119693,ϱ:119651,ϖ:119679}),qr=Object.freeze({"ϵ":119701,ϑ:119738,ϰ:119708,φ:119751,ϱ:119709,ϖ:119737}),Ti=Object.freeze({"ϵ":119759,ϑ:119796,ϰ:119766,φ:119809,ϱ:119767,ϖ:119795}),qi=Object.freeze({upperCaseLatin:{normal:t=>0,bold:t=>119743,italic:t=>119795,"bold-italic":t=>119847,script:t=>Cr[t]||119899,"script-bold":t=>119951,fraktur:t=>Si[t]||120003,"fraktur-bold":t=>120107,"double-struck":t=>Ni[t]||120055,"sans-serif":t=>120159,"sans-serif-bold":t=>120211,"sans-serif-italic":t=>120263,"sans-serif-bold-italic":t=>120380,monospace:t=>120367},lowerCaseLatin:{normal:t=>0,bold:t=>119737,italic:t=>t==="h"?8358:119789,"bold-italic":t=>119841,script:t=>Cr[t]||119893,"script-bold":t=>119945,fraktur:t=>119997,"fraktur-bold":t=>120101,"double-struck":t=>120049,"sans-serif":t=>120153,"sans-serif-bold":t=>120205,"sans-serif-italic":t=>120257,"sans-serif-bold-italic":t=>120309,monospace:t=>120361},upperCaseGreek:{normal:t=>0,bold:t=>119575,italic:t=>119633,"bold-italic":t=>119575,script:t=>0,"script-bold":t=>0,fraktur:t=>0,"fraktur-bold":t=>0,"double-struck":t=>0,"sans-serif":t=>119749,"sans-serif-bold":t=>119749,"sans-serif-italic":t=>0,"sans-serif-bold-italic":t=>119807,monospace:t=>0},lowerCaseGreek:{normal:t=>0,bold:t=>119569,italic:t=>119627,"bold-italic":t=>t==="ϕ"?119678:119685,script:t=>0,"script-bold":t=>0,fraktur:t=>0,"fraktur-bold":t=>0,"double-struck":t=>0,"sans-serif":t=>119743,"sans-serif-bold":t=>119743,"sans-serif-italic":t=>0,"sans-serif-bold-italic":t=>119801,monospace:t=>0},varGreek:{normal:t=>0,bold:t=>Tr[t]||-51,italic:t=>0,"bold-italic":t=>Ci[t]||58,script:t=>0,"script-bold":t=>0,fraktur:t=>0,"fraktur-bold":t=>0,"double-struck":t=>0,"sans-serif":t=>qr[t]||116,"sans-serif-bold":t=>qr[t]||116,"sans-serif-italic":t=>0,"sans-serif-bold-italic":t=>Ti[t]||174,monospace:t=>0},numeral:{normal:t=>0,bold:t=>120734,italic:t=>0,"bold-italic":t=>0,script:t=>0,"script-bold":t=>0,fraktur:t=>0,"fraktur-bold":t=>0,"double-struck":t=>120744,"sans-serif":t=>120754,"sans-serif-bold":t=>120764,"sans-serif-italic":t=>0,"sans-serif-bold-italic":t=>0,monospace:t=>120774}}),re=(t,e)=>{const n=t.codePointAt(0),r=64<n&&n<91?"upperCaseLatin":96<n&&n<123?"lowerCaseLatin":912<n&&n<938?"upperCaseGreek":944<n&&n<970||t==="ϕ"?"lowerCaseGreek":120545<n&&n<120572||Tr[t]?"varGreek":47<n&&n<58?"numeral":"other";return r==="other"?t:String.fromCodePoint(n+qi[r][e](t))},Mi=Object.freeze({a:"ᴀ",b:"ʙ",c:"ᴄ",d:"ᴅ",e:"ᴇ",f:"ꜰ",g:"ɢ",h:"ʜ",i:"ɪ",j:"ᴊ",k:"ᴋ",l:"ʟ",m:"ᴍ",n:"ɴ",o:"ᴏ",p:"ᴘ",q:"ǫ",r:"ʀ",s:"s",t:"ᴛ",u:"ᴜ",v:"ᴠ",w:"ᴡ",x:"x",y:"ʏ",z:"ᴢ"}),Oi=/^\d(?:[\d,.]*\d)?$/,$i=/[A-Ba-z]/,Ei=new Set(["\\prime","\\dprime","\\trprime","\\qprime","\\backprime","\\backdprime","\\backtrprime"]),Ii=(t,e,n)=>{const r=new y.MathNode(n,[t]),s=new y.MathNode("mstyle",[r]);return s.style["font-style"]="italic",s.style["font-family"]="Cambria, 'Times New Roman', serif",e==="bold-italic"&&(s.style["font-weight"]="bold"),s};Pt({type:"mathord",mathmlBuilder(t,e){const n=ft(t.text,t.mode,e),r=n.text.codePointAt(0),s=912<r&&r<938?"normal":"italic",a=Nr(t,e)||s;if(a==="script")return n.text=re(n.text,a),new y.MathNode("mi",[n],[e.font]);a!=="italic"&&(n.text=re(n.text,a));let l=new y.MathNode("mi",[n]);return a==="normal"&&(l.setAttribute("mathvariant","normal"),n.text.length===1&&(l=new y.MathNode("mrow",[l]))),l}}),Pt({type:"textord",mathmlBuilder(t,e){let n=t.text;const r=n.codePointAt(0);e.fontFamily==="textsc"&&96<r&&r<123&&(n=Mi[n]);const s=ft(n,t.mode,e),a=Nr(t,e)||"normal";let l;if(Oi.test(t.text)){const u=t.mode==="text"?"mtext":"mn";if(a==="italic"||a==="bold-italic")return Ii(s,a,u);a!=="normal"&&(s.text=s.text.split("").map(c=>re(c,a)).join("")),l=new y.MathNode(u,[s])}else if(t.mode==="text")a!=="normal"&&(s.text=re(s.text,a)),l=new y.MathNode("mtext",[s]);else if(Ei.has(t.text))l=new y.MathNode("mo",[s]),l.classes.push("tml-prime");else{const u=s.text;a!=="italic"&&(s.text=re(s.text,a)),l=new y.MathNode("mi",[s]),s.text===u&&$i.test(u)&&l.setAttribute("mathvariant","italic")}return l}});const Di={"\\nobreak":"nobreak","\\allowbreak":"allowbreak"},Pi={" ":{},"\\ ":{},"~":{className:"nobreak"},"\\space":{},"\\nobreakspace":{className:"nobreak"}};Pt({type:"spacing",mathmlBuilder(t,e){let n;if(Object.prototype.hasOwnProperty.call(Pi,t.text))n=new y.MathNode("mtext",[new y.TextNode(" ")]);else if(Object.prototype.hasOwnProperty.call(Di,t.text))n=new y.MathNode("mo"),t.text==="\\nobreak"&&n.setAttribute("linebreak","nobreak");else throw new q(`Unknown type of space "${t.text}"`);return n}}),Pt({type:"tag"});const Mr={"\\text":void 0,"\\textrm":"textrm","\\textsf":"textsf","\\texttt":"texttt","\\textnormal":"textrm","\\textsc":"textsc"},Or={"\\textbf":"textbf","\\textmd":"textmd"},Bi={"\\textit":"textit","\\textup":"textup"},Li=(t,e)=>{const n=t.font;if(n){if(Mr[n])return e.withTextFontFamily(Mr[n]);if(Or[n])return e.withTextFontWeight(Or[n]);if(n==="\\emph")return e.fontShape==="textit"?e.withTextFontShape("textup"):e.withTextFontShape("textit")}else return e;return e.withTextFontShape(Bi[n])};$({type:"text",names:["\\text","\\textrm","\\textsf","\\texttt","\\textnormal","\\textsc","\\textbf","\\textmd","\\textit","\\textup","\\emph"],props:{numArgs:1,argTypes:["text"],allowedInArgument:!0,allowedInText:!0},handler({parser:t,funcName:e},n){const r=n[0];return{type:"text",mode:t.mode,body:it(r),font:e}},mathmlBuilder(t,e){const n=Li(t,e),r=Tt(t.body,n);return Fe(r)}}),$({type:"verb",names:["\\verb"],props:{numArgs:0,allowedInText:!0},handler(t,e,n){throw new q("\\verb ended by end of line instead of matching delimiter")},mathmlBuilder(t,e){const n=new y.TextNode(Fi(t)),r=new y.MathNode("mtext",[n]);return r.setAttribute("mathvariant","monospace"),r}});const Fi=t=>t.body.replace(/ /g,t.star?"␣":" "),Ft=qn;class gt{constructor(e,n,r){this.lexer=e,this.start=n,this.end=r}static range(e,n){return n?!e||!e.loc||!n.loc||e.loc.lexer!==n.loc.lexer?null:new gt(e.loc.lexer,e.loc.start,n.loc.end):e&&e.loc}}class _t{constructor(e,n){this.text=e,this.loc=n}range(e,n){return new _t(n,gt.range(this,e))}}const $r=`[ \r
	]`,zi="\\\\[a-zA-Z@]+",ji="\\\\[^\uD800-\uDFFF]",Gi=`(${zi})${$r}*`,Ri=`\\\\(
|[ \r	]+
?)[ \r	]*`,Je="[̀-ͯ]",Er=new RegExp(`${Je}+$`),Ui=`(${$r}+)|${Ri}|([!-\\[\\]-‧‪-퟿豈-￿]${Je}*|[\uD800-\uDBFF][\uDC00-\uDFFF]${Je}*|\\\\verb\\*([^]).*?\\4|\\\\verb([^*a-zA-Z]).*?\\5|${Gi}|${ji})`;class Ir{constructor(e,n){this.input=e,this.settings=n,this.tokenRegex=new RegExp(Ui,"g"),this.catcodes={"%":14,"~":13}}setCatcode(e,n){this.catcodes[e]=n}lex(){const e=this.input,n=this.tokenRegex.lastIndex;if(n===e.length)return new _t("EOF",new gt(this,n,n));const r=this.tokenRegex.exec(e);if(r===null||r.index!==n)throw new q(`Unexpected character: '${e[n]}'`,new _t(e[n],new gt(this,n,n+1)));const s=r[6]||r[3]||(r[2]?"\\ ":" ");if(this.catcodes[s]===14){const a=e.indexOf(`
`,this.tokenRegex.lastIndex);if(a===-1){if(this.tokenRegex.lastIndex=e.length,this.settings.strict)throw new q("% comment has no terminating newline; LaTeX would fail because of commenting the end of math mode")}else this.tokenRegex.lastIndex=a+1;return this.lex()}return new _t(s,new gt(this,n,this.tokenRegex.lastIndex))}}class Wi{constructor(e={},n={}){this.current=n,this.builtins=e,this.undefStack=[]}beginGroup(){this.undefStack.push({})}endGroup(){if(this.undefStack.length===0)throw new q("Unbalanced namespace destruction: attempt to pop global namespace; please report this as a bug");const e=this.undefStack.pop();for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(e[n]===void 0?delete this.current[n]:this.current[n]=e[n])}has(e){return Object.prototype.hasOwnProperty.call(this.current,e)||Object.prototype.hasOwnProperty.call(this.builtins,e)}get(e){return Object.prototype.hasOwnProperty.call(this.current,e)?this.current[e]:this.builtins[e]}set(e,n,r=!1){if(r){for(let s=0;s<this.undefStack.length;s++)delete this.undefStack[s][e];this.undefStack.length>0&&(this.undefStack[this.undefStack.length-1][e]=n)}else{const s=this.undefStack[this.undefStack.length-1];s&&!Object.prototype.hasOwnProperty.call(s,e)&&(s[e]=this.current[e])}this.current[e]=n}}const Dr={"^":!0,_:!0,"\\limits":!0,"\\nolimits":!0};class Vi{constructor(e,n,r){this.settings=n,this.expansionCount=0,this.feed(e),this.macros=new Wi(ii,n.macros),this.mode=r,this.stack=[]}feed(e){this.lexer=new Ir(e,this.settings)}switchMode(e){this.mode=e}beginGroup(){this.macros.beginGroup()}endGroup(){this.macros.endGroup()}future(){return this.stack.length===0&&this.pushToken(this.lexer.lex()),this.stack[this.stack.length-1]}popToken(){return this.future(),this.stack.pop()}pushToken(e){this.stack.push(e)}pushTokens(e){this.stack.push(...e)}scanArgument(e){let n,r,s;if(e){if(this.consumeSpaces(),this.future().text!=="[")return null;n=this.popToken(),{tokens:s,end:r}=this.consumeArg(["]"])}else({tokens:s,start:n,end:r}=this.consumeArg());return this.pushToken(new _t("EOF",r.loc)),this.pushTokens(s),n.range(r,"")}consumeSpaces(){for(;this.future().text===" ";)this.stack.pop()}consumeArg(e){const n=[],r=e&&e.length>0;r||this.consumeSpaces();const s=this.future();let a,l=0,u=0;do{if(a=this.popToken(),n.push(a),a.text==="{")++l;else if(a.text==="}"){if(--l,l===-1)throw new q("Extra }",a)}else if(a.text==="EOF")throw new q("Unexpected end of input in a macro argument, expected '"+(e&&r?e[u]:"}")+"'",a);if(e&&r)if((l===0||l===1&&e[u]==="{")&&a.text===e[u]){if(++u,u===e.length){n.splice(-u,u);break}}else u=0}while(l!==0||r);return s.text==="{"&&n[n.length-1].text==="}"&&(n.pop(),n.shift()),n.reverse(),{tokens:n,start:s,end:a}}consumeArgs(e,n){if(n){if(n.length!==e+1)throw new q("The length of delimiters doesn't match the number of args!");const s=n[0];for(let a=0;a<s.length;a++){const l=this.popToken();if(s[a]!==l.text)throw new q("Use of the macro doesn't match its definition",l)}}const r=[];for(let s=0;s<e;s++)r.push(this.consumeArg(n&&n[s+1]).tokens);return r}expandOnce(e){const n=this.popToken(),r=n.text,s=n.noexpand?null:this._getExpansion(r);if(s==null||e&&s.unexpandable){if(e&&s==null&&r[0]==="\\"&&!this.isDefined(r))throw new q("Undefined control sequence: "+r);return this.pushToken(n),!1}if(this.expansionCount++,this.expansionCount>this.settings.maxExpand)throw new q("Too many expansions: infinite loop or need to increase maxExpand setting");let a=s.tokens;const l=this.consumeArgs(s.numArgs,s.delimiters);if(s.numArgs){a=a.slice();for(let u=a.length-1;u>=0;--u){let c=a[u];if(c.text==="#"){if(u===0)throw new q("Incomplete placeholder at end of macro body",c);if(c=a[--u],c.text==="#")a.splice(u+1,1);else if(/^[1-9]$/.test(c.text))a.splice(u,2,...l[+c.text-1]);else throw new q("Not a valid argument number",c)}}}return this.pushTokens(a),a.length}expandAfterFuture(){return this.expandOnce(),this.future()}expandNextToken(){for(;;)if(this.expandOnce()===!1){const e=this.stack.pop();return e.treatAsRelax&&(e.text="\\relax"),e}throw new Error}expandMacro(e){return this.macros.has(e)?this.expandTokens([new _t(e)]):void 0}expandTokens(e){const n=[],r=this.stack.length;for(this.pushTokens(e);this.stack.length>r;)if(this.expandOnce(!0)===!1){const s=this.stack.pop();s.treatAsRelax&&(s.noexpand=!1,s.treatAsRelax=!1),n.push(s)}return n}expandMacroAsText(e){const n=this.expandMacro(e);return n&&n.map(r=>r.text).join("")}_getExpansion(e){const n=this.macros.get(e);if(n==null)return n;if(e.length===1){const s=this.lexer.catcodes[e];if(s!=null&&s!==13)return}const r=typeof n=="function"?n(this):n;if(typeof r=="string"){let s=0;if(r.indexOf("#")!==-1){const m=r.replace(/##/g,"");for(;m.indexOf("#"+(s+1))!==-1;)++s}const a=new Ir(r,this.settings),l=[];let u=a.lex();for(;u.text!=="EOF";)l.push(u),u=a.lex();return l.reverse(),{tokens:l,numArgs:s}}return r}isDefined(e){return this.macros.has(e)||Object.prototype.hasOwnProperty.call(Ft,e)||Object.prototype.hasOwnProperty.call(lt.math,e)||Object.prototype.hasOwnProperty.call(lt.text,e)||Object.prototype.hasOwnProperty.call(Dr,e)}isExpandable(e){const n=this.macros.get(e);return n!=null?typeof n=="string"||typeof n=="function"||!n.unexpandable:Object.prototype.hasOwnProperty.call(Ft,e)&&!Ft[e].primitive}}const Pr=/^[₊₋₌₍₎₀₁₂₃₄₅₆₇₈₉ₐₑₕᵢⱼₖₗₘₙₒₚᵣₛₜᵤᵥₓᵦᵧᵨᵩᵪ]/,ye=Object.freeze({"₊":"+","₋":"-","₌":"=","₍":"(","₎":")","₀":"0","₁":"1","₂":"2","₃":"3","₄":"4","₅":"5","₆":"6","₇":"7","₈":"8","₉":"9","ₐ":"a","ₑ":"e","ₕ":"h","ᵢ":"i","ⱼ":"j","ₖ":"k","ₗ":"l","ₘ":"m","ₙ":"n","ₒ":"o","ₚ":"p","ᵣ":"r","ₛ":"s","ₜ":"t","ᵤ":"u","ᵥ":"v","ₓ":"x","ᵦ":"β","ᵧ":"γ","ᵨ":"ρ","ᵩ":"ϕ","ᵪ":"χ","⁺":"+","⁻":"-","⁼":"=","⁽":"(","⁾":")","⁰":"0","¹":"1","²":"2","³":"3","⁴":"4","⁵":"5","⁶":"6","⁷":"7","⁸":"8","⁹":"9","ᴬ":"A","ᴮ":"B","ᴰ":"D","ᴱ":"E","ᴳ":"G","ᴴ":"H","ᴵ":"I","ᴶ":"J","ᴷ":"K","ᴸ":"L","ᴹ":"M","ᴺ":"N","ᴼ":"O","ᴾ":"P","ᴿ":"R","ᵀ":"T","ᵁ":"U","ⱽ":"V","ᵂ":"W","ᵃ":"a","ᵇ":"b","ᶜ":"c","ᵈ":"d","ᵉ":"e","ᶠ":"f","ᵍ":"g",ʰ:"h","ⁱ":"i",ʲ:"j","ᵏ":"k",ˡ:"l","ᵐ":"m",ⁿ:"n","ᵒ":"o","ᵖ":"p",ʳ:"r",ˢ:"s","ᵗ":"t","ᵘ":"u","ᵛ":"v",ʷ:"w",ˣ:"x",ʸ:"y","ᶻ":"z","ᵝ":"β","ᵞ":"γ","ᵟ":"δ","ᵠ":"ϕ","ᵡ":"χ","ᶿ":"θ"}),Br=Object.freeze({"𝒜":"A",ℬ:"B","𝒞":"C","𝒟":"D",ℰ:"E",ℱ:"F","𝒢":"G",ℋ:"H",ℐ:"I","𝒥":"J","𝒦":"K",ℒ:"L",ℳ:"M","𝒩":"N","𝒪":"O","𝒫":"P","𝒬":"Q",ℛ:"R","𝒮":"S","𝒯":"T","𝒰":"U","𝒱":"V","𝒲":"W","𝒳":"X","𝒴":"Y","𝒵":"Z"});var tn={"́":{text:"\\'",math:"\\acute"},"̀":{text:"\\`",math:"\\grave"},"̈":{text:'\\"',math:"\\ddot"},"̃":{text:"\\~",math:"\\tilde"},"̄":{text:"\\=",math:"\\bar"},"̆":{text:"\\u",math:"\\breve"},"̌":{text:"\\v",math:"\\check"},"̂":{text:"\\^",math:"\\hat"},"̇":{text:"\\.",math:"\\dot"},"̊":{text:"\\r",math:"\\mathring"},"̋":{text:"\\H"},"̧":{text:"\\c"}},Lr={á:"á",à:"à",ä:"ä",ǟ:"ǟ",ã:"ã",ā:"ā",ă:"ă",ắ:"ắ",ằ:"ằ",ẵ:"ẵ",ǎ:"ǎ",â:"â",ấ:"ấ",ầ:"ầ",ẫ:"ẫ",ȧ:"ȧ",ǡ:"ǡ",å:"å",ǻ:"ǻ",ḃ:"ḃ",ć:"ć",č:"č",ĉ:"ĉ",ċ:"ċ",ď:"ď",ḋ:"ḋ",é:"é",è:"è",ë:"ë",ẽ:"ẽ",ē:"ē",ḗ:"ḗ",ḕ:"ḕ",ĕ:"ĕ",ě:"ě",ê:"ê",ế:"ế",ề:"ề",ễ:"ễ",ė:"ė",ḟ:"ḟ",ǵ:"ǵ",ḡ:"ḡ",ğ:"ğ",ǧ:"ǧ",ĝ:"ĝ",ġ:"ġ",ḧ:"ḧ",ȟ:"ȟ",ĥ:"ĥ",ḣ:"ḣ",í:"í",ì:"ì",ï:"ï",ḯ:"ḯ",ĩ:"ĩ",ī:"ī",ĭ:"ĭ",ǐ:"ǐ",î:"î",ǰ:"ǰ",ĵ:"ĵ",ḱ:"ḱ",ǩ:"ǩ",ĺ:"ĺ",ľ:"ľ",ḿ:"ḿ",ṁ:"ṁ",ń:"ń",ǹ:"ǹ",ñ:"ñ",ň:"ň",ṅ:"ṅ",ó:"ó",ò:"ò",ö:"ö",ȫ:"ȫ",õ:"õ",ṍ:"ṍ",ṏ:"ṏ",ȭ:"ȭ",ō:"ō",ṓ:"ṓ",ṑ:"ṑ",ŏ:"ŏ",ǒ:"ǒ",ô:"ô",ố:"ố",ồ:"ồ",ỗ:"ỗ",ȯ:"ȯ",ȱ:"ȱ",ő:"ő",ṕ:"ṕ",ṗ:"ṗ",ŕ:"ŕ",ř:"ř",ṙ:"ṙ",ś:"ś",ṥ:"ṥ",š:"š",ṧ:"ṧ",ŝ:"ŝ",ṡ:"ṡ",ẗ:"ẗ",ť:"ť",ṫ:"ṫ",ú:"ú",ù:"ù",ü:"ü",ǘ:"ǘ",ǜ:"ǜ",ǖ:"ǖ",ǚ:"ǚ",ũ:"ũ",ṹ:"ṹ",ū:"ū",ṻ:"ṻ",ŭ:"ŭ",ǔ:"ǔ",û:"û",ů:"ů",ű:"ű",ṽ:"ṽ",ẃ:"ẃ",ẁ:"ẁ",ẅ:"ẅ",ŵ:"ŵ",ẇ:"ẇ",ẘ:"ẘ",ẍ:"ẍ",ẋ:"ẋ",ý:"ý",ỳ:"ỳ",ÿ:"ÿ",ỹ:"ỹ",ȳ:"ȳ",ŷ:"ŷ",ẏ:"ẏ",ẙ:"ẙ",ź:"ź",ž:"ž",ẑ:"ẑ",ż:"ż",Á:"Á",À:"À",Ä:"Ä",Ǟ:"Ǟ",Ã:"Ã",Ā:"Ā",Ă:"Ă",Ắ:"Ắ",Ằ:"Ằ",Ẵ:"Ẵ",Ǎ:"Ǎ",Â:"Â",Ấ:"Ấ",Ầ:"Ầ",Ẫ:"Ẫ",Ȧ:"Ȧ",Ǡ:"Ǡ",Å:"Å",Ǻ:"Ǻ",Ḃ:"Ḃ",Ć:"Ć",Č:"Č",Ĉ:"Ĉ",Ċ:"Ċ",Ď:"Ď",Ḋ:"Ḋ",É:"É",È:"È",Ë:"Ë",Ẽ:"Ẽ",Ē:"Ē",Ḗ:"Ḗ",Ḕ:"Ḕ",Ĕ:"Ĕ",Ě:"Ě",Ê:"Ê",Ế:"Ế",Ề:"Ề",Ễ:"Ễ",Ė:"Ė",Ḟ:"Ḟ",Ǵ:"Ǵ",Ḡ:"Ḡ",Ğ:"Ğ",Ǧ:"Ǧ",Ĝ:"Ĝ",Ġ:"Ġ",Ḧ:"Ḧ",Ȟ:"Ȟ",Ĥ:"Ĥ",Ḣ:"Ḣ",Í:"Í",Ì:"Ì",Ï:"Ï",Ḯ:"Ḯ",Ĩ:"Ĩ",Ī:"Ī",Ĭ:"Ĭ",Ǐ:"Ǐ",Î:"Î",İ:"İ",Ĵ:"Ĵ",Ḱ:"Ḱ",Ǩ:"Ǩ",Ĺ:"Ĺ",Ľ:"Ľ",Ḿ:"Ḿ",Ṁ:"Ṁ",Ń:"Ń",Ǹ:"Ǹ",Ñ:"Ñ",Ň:"Ň",Ṅ:"Ṅ",Ó:"Ó",Ò:"Ò",Ö:"Ö",Ȫ:"Ȫ",Õ:"Õ",Ṍ:"Ṍ",Ṏ:"Ṏ",Ȭ:"Ȭ",Ō:"Ō",Ṓ:"Ṓ",Ṑ:"Ṑ",Ŏ:"Ŏ",Ǒ:"Ǒ",Ô:"Ô",Ố:"Ố",Ồ:"Ồ",Ỗ:"Ỗ",Ȯ:"Ȯ",Ȱ:"Ȱ",Ő:"Ő",Ṕ:"Ṕ",Ṗ:"Ṗ",Ŕ:"Ŕ",Ř:"Ř",Ṙ:"Ṙ",Ś:"Ś",Ṥ:"Ṥ",Š:"Š",Ṧ:"Ṧ",Ŝ:"Ŝ",Ṡ:"Ṡ",Ť:"Ť",Ṫ:"Ṫ",Ú:"Ú",Ù:"Ù",Ü:"Ü",Ǘ:"Ǘ",Ǜ:"Ǜ",Ǖ:"Ǖ",Ǚ:"Ǚ",Ũ:"Ũ",Ṹ:"Ṹ",Ū:"Ū",Ṻ:"Ṻ",Ŭ:"Ŭ",Ǔ:"Ǔ",Û:"Û",Ů:"Ů",Ű:"Ű",Ṽ:"Ṽ",Ẃ:"Ẃ",Ẁ:"Ẁ",Ẅ:"Ẅ",Ŵ:"Ŵ",Ẇ:"Ẇ",Ẍ:"Ẍ",Ẋ:"Ẋ",Ý:"Ý",Ỳ:"Ỳ",Ÿ:"Ÿ",Ỹ:"Ỹ",Ȳ:"Ȳ",Ŷ:"Ŷ",Ẏ:"Ẏ",Ź:"Ź",Ž:"Ž",Ẑ:"Ẑ",Ż:"Ż",ά:"ά",ὰ:"ὰ",ᾱ:"ᾱ",ᾰ:"ᾰ",έ:"έ",ὲ:"ὲ",ή:"ή",ὴ:"ὴ",ί:"ί",ὶ:"ὶ",ϊ:"ϊ",ΐ:"ΐ",ῒ:"ῒ",ῑ:"ῑ",ῐ:"ῐ",ό:"ό",ὸ:"ὸ",ύ:"ύ",ὺ:"ὺ",ϋ:"ϋ",ΰ:"ΰ",ῢ:"ῢ",ῡ:"ῡ",ῠ:"ῠ",ώ:"ώ",ὼ:"ὼ",Ύ:"Ύ",Ὺ:"Ὺ",Ϋ:"Ϋ",Ῡ:"Ῡ",Ῠ:"Ῠ",Ώ:"Ώ",Ὼ:"Ὼ"};const Hi=["bin","op","open","punct","rel"],Zi=/([-+]?) *(\d+(?:\.\d*)?|\.\d+) *([a-z]{2})/;class we{constructor(e,n,r=!1){this.mode="math",this.gullet=new Vi(e,n,this.mode),this.settings=n,this.isPreamble=r,this.leftrightDepth=0,this.prevAtomType=""}expect(e,n=!0){if(this.fetch().text!==e)throw new q(`Expected '${e}', got '${this.fetch().text}'`,this.fetch());n&&this.consume()}consume(){this.nextToken=null}fetch(){return this.nextToken==null&&(this.nextToken=this.gullet.expandNextToken()),this.nextToken}switchMode(e){this.mode=e,this.gullet.switchMode(e)}parse(){this.gullet.beginGroup(),this.settings.colorIsTextColor&&this.gullet.macros.set("\\color","\\textcolor");const e=this.parseExpression(!1);if(this.expect("EOF"),this.isPreamble){const r=Object.create(null);return Object.entries(this.gullet.macros.current).forEach(([s,a])=>{r[s]=a}),this.gullet.endGroup(),r}const n=this.gullet.macros.get("\\df@tag");return this.gullet.endGroup(),n&&(this.gullet.macros.current["\\df@tag"]=n),e}static get endOfExpression(){return["}","\\endgroup","\\end","\\right","\\endtoggle","&"]}subparse(e){const n=this.nextToken;this.consume(),this.gullet.pushToken(new _t("}")),this.gullet.pushTokens(e);const r=this.parseExpression(!1);return this.expect("}"),this.nextToken=n,r}parseExpression(e,n,r){const s=[];for(;;){this.mode==="math"&&this.consumeSpaces();const a=this.fetch();if(we.endOfExpression.indexOf(a.text)!==-1||n&&a.text===n||r&&a.text==="\\middle"||e&&Ft[a.text]&&Ft[a.text].infix)break;const l=this.parseAtom(n);if(l){if(l.type==="internal")continue}else break;s.push(l),this.prevAtomType=l.type==="atom"?l.family:l.type}return this.mode==="text"&&this.formLigatures(s),this.handleInfixNodes(s)}handleInfixNodes(e){let n=-1,r;for(let s=0;s<e.length;s++)if(e[s].type==="infix"){if(n!==-1)throw new q("only one infix operator per group",e[s].token);n=s,r=e[s].replaceWith}if(n!==-1&&r){let s,a;const l=e.slice(0,n),u=e.slice(n+1);l.length===1&&l[0].type==="ordgroup"?s=l[0]:s={type:"ordgroup",mode:this.mode,body:l},u.length===1&&u[0].type==="ordgroup"?a=u[0]:a={type:"ordgroup",mode:this.mode,body:u};let c;return r==="\\\\abovefrac"?c=this.callFunction(r,[s,e[n],a],[]):c=this.callFunction(r,[s,a],[]),[c]}else return e}handleSupSubscript(e){const n=this.fetch(),r=n.text;this.consume(),this.consumeSpaces();const s=this.parseGroup(e);if(!s)throw new q("Expected group after '"+r+"'",n);return s}formatUnsupportedCmd(e){const n=[];for(let a=0;a<e.length;a++)n.push({type:"textord",mode:"text",text:e[a]});const r={type:"text",mode:this.mode,body:n};return{type:"color",mode:this.mode,color:this.settings.errorColor,body:[r]}}parseAtom(e){const n=this.parseGroup("atom",e);if(this.mode==="text")return n;let r,s;for(;;){this.consumeSpaces();const a=this.fetch();if(a.text==="\\limits"||a.text==="\\nolimits"){if(n&&n.type==="op"){const l=a.text==="\\limits";n.limits=l,n.alwaysHandleSupSub=!0}else if(n&&n.type==="operatorname")n.alwaysHandleSupSub&&(n.limits=a.text==="\\limits");else throw new q("Limit controls must follow a math operator",a);this.consume()}else if(a.text==="^"){if(r)throw new q("Double superscript",a);r=this.handleSupSubscript("superscript")}else if(a.text==="_"){if(s)throw new q("Double subscript",a);s=this.handleSupSubscript("subscript")}else if(a.text==="'"){if(r)throw new q("Double superscript",a);const l={type:"textord",mode:this.mode,text:"\\prime"},u=[l];for(this.consume();this.fetch().text==="'";)u.push(l),this.consume();this.fetch().text==="^"&&u.push(this.handleSupSubscript("superscript")),r={type:"ordgroup",mode:this.mode,body:u}}else if(ye[a.text]){const l=Pr.test(a.text),u=[];for(u.push(new _t(ye[a.text])),this.consume();;){const m=this.fetch().text;if(!ye[m]||Pr.test(m)!==l)break;u.unshift(new _t(ye[m])),this.consume()}const c=this.subparse(u);l?s={type:"ordgroup",mode:"math",body:c}:r={type:"ordgroup",mode:"math",body:c}}else break}if(r||s){if(n&&n.type==="multiscript"&&!n.postscripts)return n.postscripts={sup:r,sub:s},n;{const a=!n||n.type!=="op"&&n.type!=="operatorname"?void 0:be(this.nextToken.text);return{type:"supsub",mode:this.mode,base:n,sup:r,sub:s,isFollowedByDelimiter:a}}}else return n}parseFunction(e,n){const r=this.fetch(),s=r.text,a=Ft[s];if(!a)return null;if(this.consume(),n&&n!=="atom"&&!a.allowedInArgument)throw new q("Got function '"+s+"' with no arguments"+(n?" as "+n:""),r);if(this.mode==="text"&&!a.allowedInText)throw new q("Can't use function '"+s+"' in text mode",r);if(this.mode==="math"&&a.allowedInMath===!1)throw new q("Can't use function '"+s+"' in math mode",r);const l=this.prevAtomType,{args:u,optArgs:c}=this.parseArguments(s,a);return this.prevAtomType=l,this.callFunction(s,u,c,r,e)}callFunction(e,n,r,s,a){const l={funcName:e,parser:this,token:s,breakOnTokenText:a},u=Ft[e];if(u&&u.handler)return u.handler(l,n,r);throw new q(`No function handler for ${e}`)}parseArguments(e,n){const r=n.numArgs+n.numOptionalArgs;if(r===0)return{args:[],optArgs:[]};const s=[],a=[];for(let l=0;l<r;l++){let u=n.argTypes&&n.argTypes[l];const c=l<n.numOptionalArgs;(n.primitive&&u==null||n.type==="sqrt"&&l===1&&a[0]==null)&&(u="primitive");const m=this.parseGroupOfType(`argument to '${e}'`,u,c);if(c)a.push(m);else if(m!=null)s.push(m);else throw new q("Null argument, please report this as a bug")}return{args:s,optArgs:a}}parseGroupOfType(e,n,r){switch(n){case"size":return this.parseSizeGroup(r);case"url":return this.parseUrlGroup(r);case"math":case"text":return this.parseArgumentGroup(r,n);case"hbox":{const s=this.parseArgumentGroup(r,"text");return s!=null?{type:"styling",mode:s.mode,body:[s],scriptLevel:"text"}:null}case"raw":{const s=this.parseStringGroup("raw",r);return s!=null?{type:"raw",mode:"text",string:s.text}:null}case"primitive":{if(r)throw new q("A primitive argument cannot be optional");const s=this.parseGroup(e);if(s==null)throw new q("Expected group as "+e,this.fetch());return s}case"original":case null:case void 0:return this.parseArgumentGroup(r);default:throw new q("Unknown group type as "+e,this.fetch())}}consumeSpaces(){for(;;){const e=this.fetch().text;if(e===" "||e===" "||e==="︎")this.consume();else break}}parseStringGroup(e,n){const r=this.gullet.scanArgument(n);if(r==null)return null;let s="",a;for(;(a=this.fetch()).text!=="EOF";)s+=a.text,this.consume();return this.consume(),r.text=s,r}parseRegexGroup(e,n){const r=this.fetch();let s=r,a="",l;for(;(l=this.fetch()).text!=="EOF"&&e.test(a+l.text);)s=l,a+=s.text,this.consume();if(a==="")throw new q("Invalid "+n+": '"+r.text+"'",r);return r.range(s,a)}parseSizeGroup(e){let n,r=!1;if(this.gullet.consumeSpaces(),!e&&this.gullet.future().text!=="{"?n=this.parseRegexGroup(/^[-+]? *(?:$|\d+|\d+\.\d*|\.\d*) *[a-z]{0,2} *$/,"size"):n=this.parseStringGroup("size",e),!n)return null;!e&&n.text.length===0&&(n.text="0pt",r=!0);const s=Zi.exec(n.text);if(!s)throw new q("Invalid size: '"+n.text+"'",n);const a={number:+(s[1]+s[2]),unit:s[3]};if(!Rn(a))throw new q("Invalid unit: '"+a.unit+"'",n);return{type:"size",mode:this.mode,value:a,isBlank:r}}parseUrlGroup(e){this.gullet.lexer.setCatcode("%",13),this.gullet.lexer.setCatcode("~",12);const n=this.parseStringGroup("url",e);if(this.gullet.lexer.setCatcode("%",14),this.gullet.lexer.setCatcode("~",13),n==null)return null;let r=n.text.replace(/\\([#$%&~_^{}])/g,"$1");return r=n.text.replace(/{\u2044}/g,"/"),{type:"url",mode:this.mode,url:r}}parseArgumentGroup(e,n){const r=this.gullet.scanArgument(e);if(r==null)return null;const s=this.mode;n&&this.switchMode(n),this.gullet.beginGroup();const a=this.parseExpression(!1,"EOF");this.expect("EOF"),this.gullet.endGroup();const l={type:"ordgroup",mode:this.mode,loc:r.loc,body:a};return n&&this.switchMode(s),l}parseGroup(e,n){const r=this.fetch(),s=r.text;let a;if(s==="{"||s==="\\begingroup"||s==="\\toggle"){this.consume();const l=s==="{"?"}":s==="\\begingroup"?"\\endgroup":"\\endtoggle";this.gullet.beginGroup();const u=this.parseExpression(!1,l),c=this.fetch();this.expect(l),this.gullet.endGroup(),a={type:c.text==="\\endtoggle"?"toggle":"ordgroup",mode:this.mode,loc:gt.range(r,c),body:u,semisimple:s==="\\begingroup"||void 0}}else a=this.parseFunction(n,e)||this.parseSymbol(),a==null&&s[0]==="\\"&&!Object.prototype.hasOwnProperty.call(Dr,s)&&(a=this.formatUnsupportedCmd(s),this.consume());return a}formLigatures(e){let n=e.length-1;for(let r=0;r<n;++r){const s=e[r],a=s.text;a==="-"&&e[r+1].text==="-"&&(r+1<n&&e[r+2].text==="-"?(e.splice(r,3,{type:"textord",mode:"text",loc:gt.range(s,e[r+2]),text:"---"}),n-=2):(e.splice(r,2,{type:"textord",mode:"text",loc:gt.range(s,e[r+1]),text:"--"}),n-=1)),(a==="'"||a==="`")&&e[r+1].text===a&&(e.splice(r,2,{type:"textord",mode:"text",loc:gt.range(s,e[r+1]),text:a+a}),n-=1)}}parseSymbol(){const e=this.fetch();let n=e.text;if(/^\\verb[^a-zA-Z]/.test(n)){this.consume();let a=n.slice(5);const l=a.charAt(0)==="*";if(l&&(a=a.slice(1)),a.length<2||a.charAt(0)!==a.slice(-1))throw new q(`\\verb assertion failed --
                    please report what input caused this bug`);return a=a.slice(1,-1),{type:"verb",mode:"text",body:a,star:l}}if(Object.prototype.hasOwnProperty.call(Lr,n[0])&&this.mode==="math"&&!lt[this.mode][n[0]]){if(this.settings.strict&&this.mode==="math")throw new q(`Accented Unicode text character "${n[0]}" used in math mode`,e);n=Lr[n[0]]+n.slice(1)}const r=this.mode==="math"?Er.exec(n):null;r&&(n=n.substring(0,r.index),n==="i"?n="ı":n==="j"&&(n="ȷ"));let s;if(lt[this.mode][n]){let a=lt[this.mode][n].group;a==="bin"&&Hi.includes(this.prevAtomType)&&(a="open");const l=gt.range(e);let u;if(Object.prototype.hasOwnProperty.call(Os,a)){const c=a;u={type:"atom",mode:this.mode,family:c,loc:l,text:n}}else{if(Br[n]){this.consume();const c=this.fetch().text.charCodeAt(0),m=c===65025?"mathscr":"mathcal";return(c===65024||c===65025)&&this.consume(),{type:"font",mode:"math",font:m,body:{type:"mathord",mode:"math",loc:l,text:Br[n]}}}u={type:a,mode:this.mode,loc:l,text:n}}s=u}else if(n.charCodeAt(0)>=128||Er.exec(n)){if(this.settings.strict&&this.mode==="math")throw new q(`Unicode text character "${n[0]}" used in math mode`,e);s={type:"textord",mode:"text",loc:gt.range(e),text:n}}else return null;if(this.consume(),r)for(let a=0;a<r[0].length;a++){const l=r[0][a];if(!tn[l])throw new q(`Unknown accent ' ${l}'`,e);const u=tn[l][this.mode]||tn[l].text;if(!u)throw new q(`Accent ${l} unsupported in ${this.mode} mode`,e);s={type:"accent",mode:this.mode,loc:gt.range(e),label:u,isStretchy:!1,base:s}}return s}}const Fr=function(t,e){if(!(typeof t=="string"||t instanceof String))throw new TypeError("Temml can only parse string typed expression");const n=new we(t,e);delete n.gullet.macros.current["\\df@tag"];let r=n.parse();if(!(r.length>0&&r[0].type&&r[0].type==="array"&&r[0].addEqnNum)&&n.gullet.macros.get("\\df@tag")){if(!e.displayMode)throw new q("\\tag works only in display mode");n.gullet.feed("\\df@tag"),r=[{type:"tag",mode:"text",body:r,tag:n.parse()}]}return r},Xi=[2,2,3,3];class en{constructor(e){this.level=e.level,this.color=e.color,this.font=e.font||"",this.fontFamily=e.fontFamily||"",this.fontSize=e.fontSize||1,this.fontWeight=e.fontWeight||"",this.fontShape=e.fontShape||"",this.maxSize=e.maxSize}extend(e){const n={level:this.level,color:this.color,font:this.font,fontFamily:this.fontFamily,fontSize:this.fontSize,fontWeight:this.fontWeight,fontShape:this.fontShape,maxSize:this.maxSize};for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return new en(n)}withLevel(e){return this.extend({level:e})}incrementLevel(){return this.extend({level:Math.min(this.level+1,3)})}inSubOrSup(){return this.extend({level:Xi[this.level]})}withColor(e){return this.extend({color:e})}withFont(e){return this.extend({font:e})}withTextFontFamily(e){return this.extend({fontFamily:e,font:""})}withFontSize(e){return this.extend({fontSize:e})}withTextFontWeight(e){return this.extend({fontWeight:e,font:""})}withTextFontShape(e){return this.extend({fontShape:e,font:""})}getColor(){return this.color}}const Yi="0.10.29";function Ki(t){const e={};let n=0;const r=t.getElementsByClassName("tml-tageqn");for(const a of r){const l=a.getElementsByClassName("tml-eqn");l.length>0&&(n+=1,l[0].id="tml-eqn-"+n);const u=a.getElementsByClassName("tml-label");if(u.length!==0)if(l.length>0)e[u[0].id]=String(n);else{const c=a.getElementsByClassName("tml-tag");c.length>0&&(e[u[0].id]=c[0].textContent)}}[...t.getElementsByClassName("tml-ref")].forEach(a=>{let l=e[a.getAttribute("href").slice(1)];a.className.indexOf("tml-eqref")===-1&&(l=l.replace(/^\(/,""),l=l.replace(/\($/,"")),l.charAt(0)!=="("&&(l="("+l),l.slice(-1)!==")"&&(l=l+")"),a.textContent=l})}let zr=function(t,e,n={}){e.textContent="";const r=e.tagName.toLowerCase()==="math";r&&(n.wrap="none");const s=nn(t,n);r?(e.textContent="",s.children.forEach(a=>{e.appendChild(a.toNode())})):s.children.length>1?(e.textContent="",s.children.forEach(a=>{e.appendChild(a.toNode())})):e.appendChild(s.toNode())};typeof document<"u"&&document.compatMode!=="CSS1Compat"&&(typeof console<"u"&&console.warn("Warning: Temml doesn't work in quirks mode. Make sure your website has a suitable doctype."),zr=function(){throw new q("Temml doesn't work in quirks mode.")});const Qi=function(t,e){return nn(t,e).toMarkup()},Ji=function(t,e){const n=new Pe(e);return Fr(t,n)},ta=function(t,e){const n=new Pe(e);if(n.macros={},!(typeof t=="string"||t instanceof String))throw new TypeError("Temml can only parse string typed expression");const r=new we(t,n,!0);return delete r.gullet.macros.current["\\df@tag"],r.parse()},ea=function(t,e,n){if(n.throwOnError||!(t instanceof q))throw t;const r=new Mn(["temml-error"],[new Ns(e+`
`+t.toString())]);return r.style.color=n.errorColor,r.style.whiteSpace="pre-line",r},nn=function(t,e){const n=new Pe(e);try{const r=Fr(t,n),s=new en({level:n.displayMode?ct.DISPLAY:ct.TEXT,maxSize:n.maxSize});return zs(r,t,s,n)}catch(r){return ea(r,t,n)}};var ve={version:Yi,render:zr,renderToString:Qi,postProcess:Ki,ParseError:q,definePreamble:ta,__parse:Ji,__renderToMathMLTree:nn,__defineSymbol:i,__defineMacro:h};function na(t){return{inline_math:e=>ve.renderToString(e.text,{...t}),display_math:e=>ve.renderToString(e.text,{displayMode:!0,...t})}}var rn={},ke={},se={},It={};Object.defineProperty(It,"__esModule",{value:!0}),It.Warning=void 0;class ra{constructor(e,n){this.message=e,typeof n=="number"?this.offset=n:n&&"line"in n&&(this.sourceLoc=n,this.offset=n.offset)}render(){let e=this.message;return this.sourceLoc?e+=` at line ${this.sourceLoc.line}, col ${this.sourceLoc.col}`:this.offset&&(e+=` at offset ${this.offset}`),e}}It.Warning=ra;var ie={};Object.defineProperty(ie,"__esModule",{value:!0}),ie.AttributeParser=void 0;var P;(function(t){t[t.SCANNING=0]="SCANNING",t[t.SCANNING_ID=1]="SCANNING_ID",t[t.SCANNING_CLASS=2]="SCANNING_CLASS",t[t.SCANNING_KEY=3]="SCANNING_KEY",t[t.SCANNING_VALUE=4]="SCANNING_VALUE",t[t.SCANNING_BARE_VALUE=5]="SCANNING_BARE_VALUE",t[t.SCANNING_QUOTED_VALUE=6]="SCANNING_QUOTED_VALUE",t[t.SCANNING_QUOTED_VALUE_CONTINUATION=7]="SCANNING_QUOTED_VALUE_CONTINUATION",t[t.SCANNING_ESCAPED=8]="SCANNING_ESCAPED",t[t.SCANNING_ESCAPED_IN_CONTINUATION=9]="SCANNING_ESCAPED_IN_CONTINUATION",t[t.SCANNING_COMMENT=10]="SCANNING_COMMENT",t[t.FAIL=11]="FAIL",t[t.DONE=12]="DONE",t[t.START=13]="START"})(P||(P={}));const sa=/^[a-zA-Z0-9_:-]/,ia=function(t){return sa.exec(t)!==null},pt=[];pt[P.START]=function(t,e){return t.subject.charAt(e)==="{"?P.SCANNING:P.FAIL},pt[P.FAIL]=function(t,e){return P.FAIL},pt[P.DONE]=function(t,e){return P.DONE},pt[P.SCANNING]=function(t,e){const n=t.subject.charAt(e);return n===`
`||n==="\r"?P.SCANNING:n===" "||n==="	"?(t.addEvent(e,e,"attr_space"),P.SCANNING):n==="}"?P.DONE:n==="#"?(t.begin=e,t.addEvent(e,e,"attr_id_marker"),P.SCANNING_ID):n==="%"?(t.begin=e,P.SCANNING_COMMENT):n==="."?(t.begin=e,t.addEvent(e,e,"attr_class_marker"),P.SCANNING_CLASS):ia(n)?(t.begin=e,P.SCANNING_KEY):P.FAIL},pt[P.SCANNING_COMMENT]=function(t,e){const n=t.subject.charAt(e);return n==="%"?(t.begin&&e>t.begin&&t.addEvent(t.begin,e,"comment"),P.SCANNING):n=="}"?P.DONE:P.SCANNING_COMMENT},pt[P.SCANNING_ID]=function(t,e){const n=t.subject.charAt(e);return/^[^\]\[~!@#$%^&*(){}`,.<>\\|=+/?\s]/.exec(n)!==null?P.SCANNING_ID:n==="}"?(t.begin&&t.lastpos&&t.lastpos>t.begin&&t.addEvent(t.begin+1,t.lastpos,"id"),t.begin=null,P.DONE):/^\s/.exec(n)!==null?(t.begin&&t.lastpos&&t.lastpos>t.begin&&t.addEvent(t.begin+1,t.lastpos,"id"),n==="\r"||n===`
`||t.addEvent(e,e,"attr_space"),t.begin=null,P.SCANNING):P.FAIL},pt[P.SCANNING_CLASS]=function(t,e){const n=t.subject.charAt(e);return/^\w/.exec(n)!==null||n==="_"||n==="-"||n===":"?P.SCANNING_CLASS:n==="}"?(t.begin&&t.lastpos&&t.lastpos>t.begin&&t.addEvent(t.begin+1,t.lastpos,"class"),t.begin=null,P.DONE):/^\s/.exec(n)!==null?(t.begin&&t.lastpos&&t.lastpos>t.begin&&t.addEvent(t.begin+1,t.lastpos,"class"),n==="\r"||n===`
`||t.addEvent(e,e,"attr_space"),t.begin=null,P.SCANNING):P.FAIL},pt[P.SCANNING_KEY]=function(t,e){const n=t.subject.charAt(e);return n==="="&&t.begin&&t.lastpos?(t.addEvent(t.begin,t.lastpos,"key"),t.addEvent(e,e,"attr_equal_marker"),t.begin=null,P.SCANNING_VALUE):/^[a-zA-Z0-9_:-]/.exec(n)!==null?P.SCANNING_KEY:P.FAIL},pt[P.SCANNING_VALUE]=function(t,e){const n=t.subject.charAt(e);return n==='"'?(t.begin=e,t.addEvent(e,e,"attr_quote_marker"),P.SCANNING_QUOTED_VALUE):/^[a-zA-Z0-9_:-]/.exec(n)!==null?(t.begin=e,P.SCANNING_BARE_VALUE):P.FAIL},pt[P.SCANNING_BARE_VALUE]=function(t,e){const n=t.subject.charAt(e);return/^[a-zA-Z0-9_:-]/.exec(n)!==null?P.SCANNING_BARE_VALUE:n==="}"&&t.begin&&t.lastpos?(t.addEvent(t.begin,t.lastpos,"value"),t.begin=null,P.DONE):/^\s/.exec(n)&&t.begin&&t.lastpos?(t.addEvent(t.begin,t.lastpos,"value"),n==="\r"||n===`
`||t.addEvent(e,e,"attr_space"),t.begin=null,P.SCANNING):P.FAIL},pt[P.SCANNING_ESCAPED]=function(t,e){return P.SCANNING_QUOTED_VALUE},pt[P.SCANNING_ESCAPED_IN_CONTINUATION]=function(t,e){return P.SCANNING_QUOTED_VALUE_CONTINUATION},pt[P.SCANNING_QUOTED_VALUE]=function(t,e){const n=t.subject.charAt(e);return n==='"'&&t.begin&&t.lastpos?(t.addEvent(t.begin+1,t.lastpos,"value"),t.addEvent(e,e,"attr_quote_marker"),t.begin=null,P.SCANNING):n===`
`&&t.begin&&t.lastpos?(t.addEvent(t.begin+1,e,"value"),t.begin=null,P.SCANNING_QUOTED_VALUE_CONTINUATION):n==="\\"?P.SCANNING_ESCAPED:P.SCANNING_QUOTED_VALUE},pt[P.SCANNING_QUOTED_VALUE_CONTINUATION]=function(t,e){const n=t.subject.charAt(e);return t.begin===null&&(t.begin=e),n==='"'&&t.begin&&t.lastpos?(t.addEvent(e,e,"attr_quote_marker"),t.addEvent(t.begin,t.lastpos,"value"),t.begin=null,P.SCANNING):n===`
`&&t.begin&&t.lastpos?(t.addEvent(t.begin,e,"value"),t.begin=null,P.SCANNING_QUOTED_VALUE_CONTINUATION):n==="\\"?P.SCANNING_ESCAPED_IN_CONTINUATION:P.SCANNING_QUOTED_VALUE_CONTINUATION};class aa{constructor(e){this.subject=e,this.state=P.START,this.begin=null,this.lastpos=null,this.matches=[]}addEvent(e,n,r){this.matches.push({startpos:e,endpos:n,annot:r})}feed(e,n){let r=e;for(;r<=n;){if(this.state=pt[this.state](this,r),this.state===P.DONE)return{status:"done",position:r};if(this.state===P.FAIL)return this.lastpos=r,{status:"fail",position:r};this.lastpos=r,r=r+1}return{status:"continue",position:n}}}ie.AttributeParser=aa;var zt={};Object.defineProperty(zt,"__esModule",{value:!0}),zt.find=zt.pattern=void 0;const oa=function(t){return new RegExp(t,"yd")};zt.pattern=oa;const la=function(t,e,n,r){e.lastIndex=n;let s;r!==void 0?s=t.substring(0,r+1):s=t;const a=e.exec(s);if(a!==null){const l=[];if(a.indices.length>1)for(let u=1;u<a.indices.length;u++){const[c,m]=a.indices[u];l.push(s.substring(c,m))}return{startpos:a.indices[0][0],endpos:a.indices[0][1]-1,captures:l}}else return null};zt.find=la;var _e={};Object.defineProperty(_e,"__esModule",{value:!0}),_e.InlineParser=void 0;const ua=ie,ca=It,J=zt,jr=9,sn=10,an=13,on=32,Gr=33,Rr=34,Ur=39,ln=40,ha=41,da=42,pa=43,un=45,ma=46,fa=58,ga=60,ba=61,cn=91,hn=92,xa=93,ya=94,wa=95,va=96,Ae=123,Se=125,ka=126,Wr=/[\r\n"'()*+.:<=[\\\]^_`${}~-]/g,Vr=function(t,e,n){Wr.lastIndex=e;const r=Wr.exec(t);return r&&r.index<=n?r.index:null},Hr=(0,J.pattern)(`[^ 	\r
]`),_a=(0,J.pattern)("[ \\t]*\\r?\\n"),Aa=(0,J.pattern)("['!\"#$%&\\\\'()\\*+,\\-\\.\\/:;<=>?@\\[\\]\\^_`{|}~']"),Sa=(0,J.pattern)("\\<([^<>\\s]+)\\>"),Na=(0,J.pattern)(`[_*~^+='"-]`),Ca=(0,J.pattern)(":[\\w_+-]+:"),Ta=(0,J.pattern)("\\.\\."),qa=(0,J.pattern)("`*"),Ma=(0,J.pattern)("`+"),Oa=(0,J.pattern)("\\$\\$"),$a=(0,J.pattern)("\\$"),Ea=(0,J.pattern)("\\\\"),Ia=(0,J.pattern)("\\{=[^\\s{}`]+\\}"),Da=(0,J.pattern)("\\^([^\\]]+)\\]"),dn=function(t,e){return e>0&&t.subject.codePointAt(e-1)===Ae||t.subject.codePointAt(e+1)===Se},ae=function(){return!0},Ot=function(t,e,n,r){return function(s,a,l){const u=s.subject;let c=(0,J.find)(u,Hr,a+1)!==null&&r(s,a),m=(0,J.find)(u,Hr,a-1)!==null;const b=s.matches[s.matches.length-1],A=b&&b.annot==="open_marker",x=a+1<=l&&u.codePointAt(a+1)===Se;let T=a,D=a;A&&(c=!0,m=!1,D=a-1),!A&&x&&(m=!0,c=!1,T=a+1),A&&n.match(/^right/)?n=n.replace(/^right/,"left"):x&&n.match(/^left/)&&(n=n.replace(/^left/,"right"));let j=t;x&&(j="{"+j);const rt=s.openers[j];if(m&&rt&&rt.length>0){const N=rt[rt.length-1];if(N.endpos!==a-1)return s.clearOpeners(N.startpos,a),s.addMatch(N.startpos,N.endpos,"+"+e,N.matchIndex),s.addMatch(a,T,"-"+e),T+1}if(c){let N=t;return A&&(N="{"+N),s.addOpener(N,D,a,n),a+1}else return s.addMatch(a,T,n),T+1}},Pa={[va]:function(t,e,n){const r=t.subject,s=(0,J.find)(r,qa,e,n);if(s===null)return null;const a=s.endpos;return(0,J.find)(r,Oa,e-2)&&!(0,J.find)(r,Ea,e-3)?(t.matches.pop(),t.matches.pop(),t.addMatch(e-2,a,"+display_math"),t.verbatimType="display_math"):(0,J.find)(r,$a,e-1)?(t.matches.pop(),t.addMatch(e-1,a,"+inline_math"),t.verbatimType="inline_math"):(t.addMatch(e,a,"+verbatim"),t.verbatimType="verbatim"),t.verbatim=a-e+1,a+1},[hn]:function(t,e,n){const r=t.subject,s=(0,J.find)(r,_a,e+1,n);if(s!==null){if(t.matches.length>0){const a=t.matches[t.matches.length-1];if(a.annot==="str"){let l=a.endpos;const u=a.startpos;for(;l>=u&&(r.codePointAt(l)===on||r.codePointAt(l)===jr);)l=l-1;l<u?t.matches.pop():a.endpos=l}}return t.addMatch(e,e,"escape"),t.addMatch(e+1,s.endpos,"hard_break"),s.endpos+1}else{const a=(0,J.find)(r,Aa,e+1,n);return a!==null?(t.addMatch(e,e,"escape"),t.addMatch(a.startpos,a.endpos,"str"),a.endpos+1):e+1<=n&&r.codePointAt(e+1)===on?(t.addMatch(e,e,"escape"),t.addMatch(e+1,e+1,"non_breaking_space"),e+2):(t.addMatch(e,e,"str"),e+1)}},[ga]:function(t,e,n){const r=t.subject,s=(0,J.find)(r,Sa,e,n);if(s===null)return null;const a=s.endpos,l=s.startpos,u=s.captures[0];return u.match(/[^:]@/)?(t.addMatch(l,l,"+email"),t.addMatch(l+1,a-1,"str"),t.addMatch(a,a,"-email"),a+1):u.match(/[a-zA-Z]:/)?(t.addMatch(l,l,"+url"),t.addMatch(l+1,a-1,"str"),t.addMatch(a,a,"-url"),a+1):null},[ka]:Ot("~","subscript","str",ae),[ya]:Ot("^","superscript","str",ae),[wa]:Ot("_","emph","str",ae),[da]:Ot("*","strong","str",ae),[pa]:Ot("+","insert","str",dn),[ba]:Ot("=","mark","str",dn),[Ur]:Ot("'","single_quoted","right_single_quote",function(t,e){if(e===0)return!0;{const n=t.subject.codePointAt(e-1);return n===on||n===jr||n===an||n===sn||n===Rr||n===Ur||n===un||n===ln||n===cn}}),[Rr]:Ot('"',"double_quoted","left_double_quote",ae),[Ae]:function(t,e,n){return(0,J.find)(t.subject,Na,e+1,n)?(t.addMatch(e,e,"open_marker"),e+1):t.allowAttributes?(t.attributeParser=new ua.AttributeParser(t.subject),t.attributeStart=e,t.attributeSlices=[],e):(t.addMatch(e,e,"str"),e+1)},[fa]:function(t,e,n){const r=(0,J.find)(t.subject,Ca,e,n);return r?(t.addMatch(r.startpos,r.endpos,"symb"),r.endpos+1):(t.addMatch(e,e,"str"),e+1)},[ma]:function(t,e,n){return(0,J.find)(t.subject,Ta,e+1,n)?(t.addMatch(e,e+2,"ellipses"),e+3):null},[cn]:function(t,e,n){const r=(0,J.find)(t.subject,Da,e+1,n);return r?(t.addMatch(e,r.endpos,"footnote_reference"),r.endpos+1):(t.addOpener("[",e,e,"str"),e+1)},[xa]:function(t,e,n){const r=t.openers["["],s=t.subject;if(r&&r.length>0){const a=r[r.length-1];if(a.annot==="reference_link")return t.strMatches((a.subendpos||a.endpos)+1,e-1),s.codePointAt(a.startpos-1)===Gr&&s.codePointAt(a.startpos-2)!==hn?(t.addMatch(a.startpos-1,a.startpos-1,"image_marker",a.matchIndex-1),t.addMatch(a.startpos,a.endpos,"+imagetext",a.matchIndex),t.addMatch(a.substartpos||a.startpos,a.substartpos||a.startpos,"-imagetext",a.subMatchIndex)):(t.addMatch(a.startpos,a.endpos,"+linktext",a.matchIndex),t.addMatch(a.substartpos||a.startpos,a.substartpos||a.startpos,"-linktext",a.subMatchIndex)),t.addMatch(a.subendpos||a.endpos,a.subendpos||a.endpos,"+reference",a.subMatchIndex+1),t.addMatch(e,e,"-reference"),t.clearOpeners(a.startpos,e),e+1;if(e+1<=n&&s.codePointAt(e+1)===cn)return a.annot="reference_link",t.addMatch(e,e,"str"),a.subMatchIndex=t.matches.length-1,t.addMatch(e+1,e+1,"str"),a.substartpos=e,a.subendpos=e+1,t.clearOpeners(a.startpos+1,e-1),e+2;if(e+1<=n&&s.codePointAt(e+1)===ln)return t.openers["("]=[],a.annot="explicit_link",t.addMatch(e,e,"str"),a.subMatchIndex=t.matches.length-1,t.addMatch(e+1,e+1,"str"),a.substartpos=e,a.subendpos=e+1,t.destination=!0,t.clearOpeners(a.startpos+1,e-1),e+2;if(e+1<=n&&s.codePointAt(e+1)===Ae)return t.addMatch(a.startpos,a.endpos,"+span",a.matchIndex),t.addMatch(e,e,"-span"),t.clearOpeners(a.startpos,e),e+1}return null},[ln]:function(t,e,n){return t.destination?(t.addOpener("(",e,e,"str"),e+1):null},[ha]:function(t,e,n){if(!t.destination)return null;const r=t.openers["("];if(r&&r.length>0)return r.pop(),t.addMatch(e,e,"str"),e+1;{const s=t.subject,a=t.openers["["],l=a[a.length-1];if(a&&a.length>0&&l.annot==="explicit_link")return t.strMatches((l.subendpos||l.endpos)+1,e-1),s.codePointAt(l.startpos-1)===Gr&&s.codePointAt(l.startpos-2)!==hn?(t.addMatch(l.startpos-1,l.startpos-1,"image_marker",l.matchIndex-1),t.addMatch(l.startpos,l.endpos,"+imagetext",l.matchIndex),t.addMatch(l.substartpos||l.startpos,l.substartpos||l.startpos,"-imagetext",l.subMatchIndex)):(t.addMatch(l.startpos,l.endpos,"+linktext",l.matchIndex),t.addMatch(l.substartpos||l.startpos,l.substartpos||l.startpos,"-linktext",l.subMatchIndex)),t.addMatch(l.subendpos||l.endpos,l.subendpos||l.endpos,"+destination",l.subMatchIndex+1),t.addMatch(e,e,"-destination"),t.destination=!1,t.clearOpeners(l.startpos,e),e+1}return null},[un]:function(t,e,n){const r=t.subject;if(r.codePointAt(e-1)===Ae||r.codePointAt(e+1)===Se){const c=Ot("-","delete","str",dn)(t,e,n);if(c)return c}let s=e,a=0;for(;s<=n&&r.codePointAt(s)===un;)s++,a++;if(r.codePointAt(s)===Se&&a--,a===0)return t.addMatch(e,e+1,"str"),e+2;const l=a%3===0,u=a%2===0;for(;a>0;)l?(t.addMatch(e,e+2,"em_dash"),e=e+3,a=a-3):u?(t.addMatch(e,e+1,"en_dash"),e=e+2,a=a-2):a>=3&&(a%2!==0||a>4)?(t.addMatch(e,e+2,"em_dash"),e=e+3,a=a-3):a>=2?(t.addMatch(e,e+1,"en_dash"),e=e+2,a=a-2):(t.addMatch(e,e,"str"),e=e+1,a=a-1);return e}};class Ba{constructor(e,n={}){this.options=n,this.warn=n.warn||(()=>{}),this.subject=e,this.matches=[],this.openers={},this.verbatim=0,this.verbatimType="",this.destination=!1,this.firstpos=-1,this.lastpos=0,this.allowAttributes=!0,this.attributeParser=null,this.attributeStart=null,this.attributeSlices=null,this.matchers=Pa}addMatch(e,n,r,s){const a={startpos:e,endpos:n,annot:r};s!==void 0?this.matches.splice(s,1,a):this.matches.push(a)}inVerbatim(){return this.verbatim>0}singleChar(e){return this.addMatch(e,e,"str"),e+1}reparseAttributes(){const e=this.attributeSlices;if(e!==null){if(this.allowAttributes=!1,this.attributeParser=null,this.attributeStart=null,e!==null)for(const n of e)this.feed(n.startpos,n.endpos);this.allowAttributes=!0,this.attributeSlices=null}}getMatches(){const e=this.subject;this.attributeParser&&this.reparseAttributes();let n=this.matches.length-1;if(this.matches[n]&&this.matches[n].annot==="soft_break"){this.matches.pop();const r=this.matches[this.matches.length-1];if(r&&r.annot==="str"&&e.codePointAt(r.endpos)===32){for(;r.endpos>=r.startpos&&e.codePointAt(r.endpos)===32;)r.endpos=r.endpos-1;r.endpos<r.startpos&&this.matches.pop()}}if(this.matches.length>0&&this.verbatim>0){const r=this.matches[this.matches.length-1];this.warn(new ca.Warning("Unclosed verbatim",r.endpos)),this.matches.push({startpos:r.endpos,endpos:r.endpos,annot:"-"+this.verbatimType})}return this.matches}addOpener(e,n,r,s){this.openers[e]||(this.openers[e]=[]),this.openers[e].push({matchIndex:this.matches.length,startpos:n,endpos:r,annot:null,subMatchIndex:this.matches.length,substartpos:null,subendpos:null}),this.addMatch(n,r,s)}clearOpeners(e,n){for(const r in this.openers){const s=this.openers[r];let a=s.length-1;for(;s[a];){const l=s[a];if(l.startpos>=e&&l.endpos<=n)s.splice(a,1);else if(l.substartpos&&l.substartpos>=e&&l.subendpos&&l.subendpos<=n)s[a].substartpos=null,s[a].subendpos=null,s[a].annot=null;else break;a--}}}strMatches(e,n){let r=this.matches.length-1;for(;r>0&&this.matches[r].startpos>=e;)r--;for(this.matches[r].startpos<e&&r++;this.matches[r]&&this.matches[r].endpos<=n;){const s=this.matches[r];s.annot!=="escape"&&s.annot!=="str"&&(s.annot="str"),r++}}feed(e,n){const r=this.subject;(this.firstpos===-1||e<this.firstpos)&&(this.firstpos=e),(this.lastpos===0||n>this.lastpos)&&(this.lastpos=n);let s=e;for(;s<=n;)if(this.attributeParser!==null){const a=s,l=Vr(r,s,n);let u;l===null?u=n:u=l;const c=this.attributeParser.feed(a,u),m=c.position;if(c.status==="done"){const b=this.attributeStart;b!==null&&this.addMatch(b,b,"+attributes");const A=this.attributeParser.matches;for(const x of A)this.addMatch(x.startpos,x.endpos,x.annot);this.addMatch(m,m,"-attributes"),this.attributeParser=null,this.attributeStart=null,this.attributeSlices=null,s=m+1}else c.status==="fail"?(this.reparseAttributes(),s=a):c.status==="continue"&&(this.attributeSlices===null&&(this.attributeSlices=[]),this.attributeSlices.push({startpos:a,endpos:m}),s=m+1)}else{const a=Vr(r,s,n);let l;if(a===null?l=n+1:l=a,l>s&&(this.addMatch(s,l-1,"str"),s=l,s>n))break;const u=r.codePointAt(s);if(u===void 0)throw new Error("Code point at "+s+" is undefined.");if(u===an||u===sn)u===an&&r.codePointAt(s+1)===sn&&s+1<=n?(this.addMatch(s,s+1,"soft_break"),s=s+2):(this.addMatch(s,s,"soft_break"),s=s+1);else if(this.verbatim>0)if(u===96){const c=(0,J.find)(r,Ma,s,n);if(c){const m=c.endpos;if(c.endpos-s+1===this.verbatim){const b=(0,J.find)(r,Ia,m+1,n);b&&this.verbatimType==="verbatim"?(this.addMatch(s,m,"-"+this.verbatimType),this.addMatch(b.startpos,b.endpos,"raw_format"),s=b.endpos+1):(this.addMatch(s,m,"-"+this.verbatimType),s=m+1),this.verbatim=0,this.verbatimType="verbatim"}else this.addMatch(s,m,"str"),s=m+1}else this.addMatch(s,n,"str"),s=n+1}else this.addMatch(s,s,"str"),s=s+1;else{const c=this.matchers[u];if(c){const m=c(this,s,n);m===null?s=this.singleChar(s):s=m}else s=this.singleChar(s)}}}}_e.InlineParser=Ba,Object.defineProperty(se,"__esModule",{value:!0}),se.parseEvents=void 0;const Zr=It,La=ie,et=zt,pn=_e,mn=function(t){return t==="+"||t==="-"||t==="*"||t===":"?[t]:/^[+*-] \[[Xx ]\]/.exec(t)?["X"]:/^[(]?[0-9]+[).]/.exec(t)?[t.replace(/[0-9]+/,"1")]:/^[(]?[ivxlcdm][).]/.exec(t)?[t.replace(/[a-z]+/,"i"),t.replace(/[a-z]+/,"a")]:/^[(]?[IVXLCDM][).]/.exec(t)?[t.replace(/[A-Z]+/,"I"),t.replace(/[A-Z]+/,"A")]:/^[(]?[ivxlcdm]+[).]/.exec(t)?[t.replace(/[a-z]+/,"i")]:/^[(]?[IVXLCDM]+[).]/.exec(t)?[t.replace(/[A-Z]+/,"I")]:/^[(]?[a-z][).]/.exec(t)?[t.replace(/[a-z]/,"a")]:/^[(]?[A-Z][).]/.exec(t)?[t.replace(/[A-Z]/,"A")]:[]},Fa=function(t){return t===32||t===9},za=function(t){return t===10||t===13},Xr=(0,et.pattern)("[ \\t]*\\r?\\n"),ja=(0,et.pattern)("^\\w+\\s"),Ne=(0,et.pattern)("[ \\t\\r\\n]"),Ga=(0,et.pattern)("[^ \\t\\r\\n]+"),Yr=(0,et.pattern)("[>][ \\t\\r\\n]"),Kr=(0,et.pattern)("#+"),Ra=(0,et.pattern)("(~~~~*|````*)([ \\t]*)([^ \\t\\r\\n`]*)[ \\t]*\\r?\\n"),Ua=(0,et.pattern)("(:?)--*(:?)([ \\t]*\\|[ \\t]*)"),Wa=(0,et.pattern)("[^`|\\r\\n]*(?:[|]|`+)"),Va=(0,et.pattern)("\\^[ \\t]+"),Ha=(0,et.pattern)("\\[\\^([^\\]]+)\\]:[ \\t\\r\\n]"),Za=(0,et.pattern)("[-*][ 	]*[-*][ \\t]*[-*][-* \\t]*\\r?\\n"),Xa=(0,et.pattern)("(::::*)[ \\t]*\\r?\\n"),Ya=(0,et.pattern)("(::::*)[ \\t]*"),Ka=(0,et.pattern)("([\\w_-]*)[ \\t]*\\r?\\n"),Qa=(0,et.pattern)("\\[([^\\]\\r\\n]*)\\]:[ \\t]*([^ \\t\\r\\n]*)[\\r\\n]"),Qr=(0,et.pattern)("(\\|[^\\r\\n]*\\|)[ \\t]*\\r?\\n"),fn=(0,et.pattern)("(:?[-*+:]|\\([0-9]+\\)|[0-9]+[.)]|[ivxlcdmIVXLCDM]+[.)]|\\([ivxlcdmIVXLCDM]+\\)|[a-zA-Z][.)]|\\([a-zA-Z]\\))[ \\t\\r\\n]"),gn=(0,et.pattern)("[*+-] \\[[Xx ]\\][ \\t\\r\\n]");var W;(function(t){t[t.None=0]="None",t[t.Inline=1]="Inline",t[t.Block=2]="Block",t[t.Text=3]="Text",t[t.Cells=4]="Cells",t[t.Attributes=5]="Attributes",t[t.ListItem=6]="ListItem"})(W||(W={}));class mt{constructor(e,n){this.name=e.name,this.type=e.type,this.content=e.content,this.continue=e.continue,this.close=e.close,this.indent=0,this.inlineParser=null,this.attributeParser=null,this.extra=n}}class Ja{constructor(e,n={}){e.charAt(e.length-1)!==`
`&&(e=e+`
`),this.subject=e,this.maxoffset=e.length-1,this.options=n,this.warn=n.warn||(()=>{}),this.indent=0,this.startline=0,this.starteol=0,this.endeol=0,this.matches=[],this.containers=[],this.pos=0,this.lastMatchedContainer=0,this.finishedLine=!1,this.returned=0,this.paraSpec={name:"para",type:W.Block,content:W.Inline,continue:r=>this.find(Ne)===null,open:r=>(this.addContainer(new mt(r,{})),this.addMatch(this.pos,this.pos,"+para"),!0),close:()=>{this.getInlineMatches(),this.containers.pop();const r=this.matches[this.matches.length-1],s=r&&r.endpos+1||this.pos;this.addMatch(s,s,"-para")}},this.specs=[{name:"block_quote",type:W.Block,content:W.Block,continue:r=>this.find(Yr)!==null?(this.pos=this.pos+1,!0):!1,open:r=>this.find(Yr)!==null?(this.addContainer(new mt(r,{})),this.addMatch(this.pos,this.pos,"+block_quote"),this.pos=this.pos+1,!0):!1,close:()=>{this.containers.pop(),this.addMatch(this.pos,this.pos,"-block_quote")}},{name:"heading",type:W.Block,content:W.Inline,continue:r=>{const s=this.find(Kr);return s&&r.extra.level===s.endpos-s.startpos+1&&(0,et.find)(this.subject,Ne,s.endpos+1)?(this.pos=s.endpos+1,!0):!1},open:r=>{const s=this.find(Kr);if(s&&(0,et.find)(this.subject,Ne,s.endpos+1)){const a=s.endpos-s.startpos+1;return this.addContainer(new mt(r,{level:a})),this.addMatch(s.startpos,s.endpos,"+heading"),this.pos=s.endpos+1,!0}else return!1},close:()=>{this.getInlineMatches(),this.containers.pop();const r=this.matches[this.matches.length-1],s=r&&r.endpos+1||this.pos;this.addMatch(s,s,"-heading")}},{name:"caption",type:W.Block,content:W.Inline,continue:r=>(0,et.find)(this.subject,Ne,this.pos)===null,open:r=>{const s=this.find(Va);return s?(this.pos=s.endpos+1,this.addContainer(new mt(r,{})),this.addMatch(this.pos,this.pos,"+caption"),!0):!1},close:()=>{this.getInlineMatches(),this.containers.pop(),this.addMatch(this.pos-1,this.pos-1,"-caption")}},{name:"footnote",type:W.Block,content:W.Block,continue:r=>this.indent>(r.extra.indent||0)||this.pos===this.starteol,open:r=>{const s=this.find(Ha);if(s){const a=s.startpos,l=s.endpos,u=s.captures[0];return this.addContainer(new mt(r,{note_label:u,indent:this.indent})),this.addMatch(a,a,"+footnote"),this.addMatch(a+2,l-3,"note_label"),this.pos=l,!0}else return!1},close:()=>{this.containers.pop(),this.addMatch(this.pos,this.pos,"-footnote")}},{name:"reference_definition",type:W.Block,content:W.None,continue:r=>{if(r.extra.indent>=this.indent)return!1;const s=this.find(Ga);return this.pos<this.starteol&&s&&s.endpos===this.starteol-1?(this.addMatch(this.pos,this.starteol-1,"reference_value"),this.pos=this.starteol,!0):!1},open:r=>{const s=this.find(Qa);if(s){const a=s.captures[0],l=s.captures[1];return this.addContainer(new mt(r,{key:a,indent:this.indent})),this.addMatch(s.startpos,s.startpos,"+reference_definition"),this.addMatch(s.startpos,s.startpos+a.length+1,"reference_key"),l.length>0&&this.addMatch(this.starteol-l.length,this.starteol-1,"reference_value"),this.pos=this.starteol-1,!0}else return!1},close:()=>{this.containers.pop(),this.addMatch(this.pos,this.pos,"-reference_definition")}},{name:"thematic_break",type:W.Block,content:W.None,continue:r=>!1,open:r=>{const s=this.find(Za);return s?(this.addContainer(new mt(r,{})),this.addMatch(s.startpos,s.endpos,"thematic_break"),this.pos=s.endpos,!0):!1},close:()=>{this.containers.pop()}},{name:"list",type:W.Block,content:W.ListItem,continue:r=>{if(this.indent>r.extra.indent||this.pos===this.starteol)return!0;{const s=this.find(fn);if(s===null)return!1;let a=this.subject.substring(s.startpos,s.endpos);const l=this.find(gn);l!==null&&(a=this.subject.substring(l.startpos,l.startpos+5));const u=mn(a),c=[];for(const m of r.extra.styles)u.includes(m)&&c.push(m);if(c.length>0)return r.extra.styles=c,!0}return!1},open:r=>{const s=this.find(fn);if(s===null)return!1;const a=s.startpos,l=s.endpos;let u=this.subject.substring(a,l);const c=this.find(gn);c!==null&&(u=this.subject.substring(c.startpos,c.startpos+5));const m=mn(u);if(m.length===0)return!1;const b={styles:m,indent:this.indent};this.addContainer(new mt(r,b));let A="+list";for(const x of m)A=A+"|"+x;return this.addMatch(a,l-1,A),!0},close:()=>{this.containers.pop(),this.addMatch(this.pos,this.pos,"-list")}},{name:"list_item",type:W.ListItem,content:W.Block,continue:r=>this.indent>r.extra.indent||this.pos===this.starteol,open:r=>{const s=this.find(fn);if(s===null)return!1;const a=s.startpos,l=s.endpos;let u=this.subject.substring(a,l),c=null;const m=this.find(gn);m!==null&&(u=this.subject.substring(m.startpos,m.startpos+5),c=this.subject.substring(m.startpos+3,m.startpos+4));const b=mn(u);if(b.length===0)return!1;const A={styles:b,indent:this.indent};this.addContainer(new mt(r,A));let x="+list_item";for(const T of b)x=x+"|"+T;return this.addMatch(a,l-1,x),this.pos=l,c&&(c===" "?this.addMatch(a+2,a+4,"checkbox_unchecked"):this.addMatch(a+2,a+4,"checkbox_checked"),this.pos=a+5),!0},close:()=>{this.containers.pop(),this.addMatch(this.pos,this.pos,"-list_item")}},{name:"table",type:W.Block,content:W.Cells,continue:r=>{const s=this.find(Qr);if(s){const a=s.captures[0];return this.parseTableRow(s.startpos,s.startpos+a.length-1)}else return!1},open:r=>{const s=this.find(Qr);if(s){this.addContainer(new mt(r,{columns:0}));const a=s.captures[0];return this.addMatch(s.startpos,s.startpos,"+table"),this.parseTableRow(s.startpos,s.startpos+a.length-1)?!0:(this.matches.pop(),this.containers.pop(),!1)}else return!1},close:()=>{this.containers.pop(),this.addMatch(this.pos,this.pos,"-table")}},{name:"attributes",type:W.Block,content:W.Attributes,open:r=>{if(this.subject.codePointAt(this.pos)===123){const s=new La.AttributeParser(this.subject),a=s.feed(this.pos,this.starteol);if(a.status==="fail")return!1;if(a.status==="done"&&(0,et.find)(this.subject,Xr,a.position+1)===null)return!1;{const l=this.addContainer(new mt(r,{status:a.status,indent:this.indent,startpos:this.pos,slices:[]}));return l.attributeParser=s,l.extra.slices=[{startpos:this.pos,endpos:this.starteol}],this.pos=this.starteol,!0}}else return!1},continue:r=>{if(r.extra.status==="done")return!1;if(r.attributeParser&&this.indent>r.extra.indent){r.extra.slices.push({startpos:this.pos,endpos:this.starteol});const l=r.attributeParser.feed(this.pos,this.endeol);if(r.extra.status=l.status,l.status!=="fail"||!(0,et.find)(this.subject,Xr,l.position+1))return this.pos=this.starteol,!0}this.addMatch(r.extra.startpos,r.extra.startpos,"+para");const s=this.containers.pop(),a=this.addContainer(new mt(this.paraSpec,{}));if(!a.inlineParser||!s)throw new Error("Missing inlineParser or attrContainer");return a.inlineParser.attributeSlices=s.extra.slices,a.inlineParser.reparseAttributes(),this.pos=a.inlineParser.lastpos+1,!0},close:()=>{const r=this.containers.pop();if(r)if(r.extra.status==="continue"){this.addMatch(r.extra.startpos,r.extra.startpos,"+para");const s=this.addContainer(new mt(this.paraSpec,{}),!0);if(!s||!s.inlineParser)throw new Error("Could not add paragraph");s.inlineParser.attributeSlices=r.extra.slices,s.inlineParser.reparseAttributes(),s.close()}else{if(this.addMatch(r.extra.startpos,r.extra.startpos,"+block_attributes"),r.attributeParser){const s=r.attributeParser.matches;for(const a of s)this.matches.push(a)}this.addMatch(this.pos,this.pos,"-block_attributes")}}},{name:"fenced_div",type:W.Block,content:W.Block,continue:r=>{const s=this.tip();if(s&&s.name==="code_block")return!0;const a=this.find(Xa);if(a&&r.extra.colons){const l=a.captures[0];if(l.length>=r.extra.colons)return r.extra.endFenceStartpos=a.startpos,r.extra.endFenceEndpos=a.startpos+l.length-1,this.pos=a.endpos,!1}return!0},open:r=>{const s=this.find(Ya);if(!s)return!1;const a=s.captures[0],l=(0,et.find)(this.subject,Ka,s.endpos+1);if(!l)return!1;const u=l.startpos,c=l.captures[0];return this.addContainer(new mt(r,{colons:a.length})),this.addMatch(s.startpos,s.endpos,"+div"),c.length>0&&this.addMatch(u,u+c.length-1,"class"),this.pos=l.endpos+1,this.finishedLine=!0,!0},close:()=>{const r=this.containers.pop();if(!r)return;const s=r.extra.endFenceStartpos||this.pos,a=r.extra.endFenceEndpos||this.pos;this.addMatch(s,a,"-div"),s===a&&this.warn(new Zr.Warning("Unclosed div",this.pos))}},{name:"code_block",type:W.Block,content:W.Text,continue:r=>{const s=this.find(r.extra.closePattern);return s?(r.extra.endFenceStartpos=s.startpos,r.extra.endFenceEndpos=s.startpos+s.captures[0].length-1,this.pos=s.endpos,this.finishedLine=!0,!1):!0},open:r=>{const s=this.find(Ra);if(s){const[a,l,u]=s.captures,c=u.charAt(0)==="="&&!0||!1,m=(0,et.pattern)("("+a+a.substring(0,1)+"*)[ \\t]*[\\r\\n]"),b=this.addContainer(new mt(r,{closePattern:m}));if(b.indent=this.indent,this.addMatch(s.startpos,s.startpos+a.length-1,"+code_block"),u.length>0){const A=s.startpos+a.length+l.length;c?this.addMatch(A,A+u.length-1,"raw_format"):this.addMatch(A,A+u.length-1,"code_language")}return this.pos=s.endpos,this.finishedLine=!0,!0}else return!1},close:()=>{const r=this.containers.pop();if(!r)return;const s=r.extra.endFenceStartpos||this.pos,a=r.extra.endFenceEndpos||this.pos;this.addMatch(s,a,"-code_block"),s===a&&this.warn(new Zr.Warning("Unclosed code block",this.pos))}}]}find(e){return(0,et.find)(this.subject,e,this.pos)}tip(){return this.containers.length>=1?this.containers[this.containers.length-1]:null}addMatch(e,n,r){this.matches.push({startpos:Math.min(e,this.maxoffset),endpos:Math.min(n,this.maxoffset),annot:r})}getInlineMatches(){var e;const n=(e=this.tip())===null||e===void 0?void 0:e.inlineParser;if(n){let r;for(const s of n.getMatches())r&&r.annot==="str"&&s.annot==="str"&&s.startpos===r.endpos+1?this.matches[this.matches.length-1].endpos=s.endpos:this.matches.push(s),r=s}}closeUnmatchedContainers(){const e=this.lastMatchedContainer;let n=this.tip();for(;n&&this.containers.length-1>e;)n.close(),n=this.tip()}addContainer(e,n){n||this.closeUnmatchedContainers();let r=this.tip();for(;r&&r.content!==e.type;)r.close(),r=this.tip();return e.content===W.Inline&&(e.inlineParser=new pn.InlineParser(this.subject,{warn:this.warn})),this.containers.push(e),e}skipSpace(){const e=this.subject;let n=this.pos;for(;Fa(e.codePointAt(n));)n++;this.indent=n-this.startline,this.pos=n}getEol(){const e=this.subject;let n=this.pos;for(;!za(e.codePointAt(n));)n++;this.starteol=n,e.codePointAt(n)===13&&e.codePointAt(n+1)===10?this.endeol=n+1:this.endeol=n}parseTableCell(){const e=new pn.InlineParser(this.subject,{warn:this.warn});let n=!1;const r=this.pos-1;let s=r;for(this.skipSpace();!n;){const a=this.find(Wa);if(a===null){n=!1;break}else{const l=a.endpos;this.subject.charAt(l)==="`"||e.inVerbatim()?e.feed(this.pos,l):this.subject.charAt(l-1)==="\\"?e.feed(this.pos,l):(e.feed(this.pos,l-1),s=l,n=!0),this.pos=l+1}}if(n){const a=e.getMatches();return{startpos:r,endpos:s,matches:a}}else return null}parseTableRow(e,n){const r=this.matches.length,s=this.pos;this.addMatch(e,e,"+row"),this.pos++;const a=[];let l=this.pos,u=!1;for(;!u;){const c=(0,et.find)(this.subject,Ua,l);if(c!==null){const[m,b,A]=c.captures;let x="separator_default";if(m.length>0&&b.length>0?x="separator_center":b.length>0?x="separator_right":m.length>0&&(x="separator_left"),a.push({startpos:c.startpos,endpos:c.endpos-A.length,annot:x}),l=c.endpos+1,l===this.starteol){u=!0;break}}else break}if(u){for(const c of a)this.addMatch(c.startpos,c.endpos,c.annot);return this.addMatch(this.starteol-1,this.starteol-1,"-row"),this.pos=this.starteol,this.finishedLine=!0,!0}for(;this.pos<=n;){const c=this.parseTableCell();if(c!==null){this.addMatch(c.startpos,c.startpos,"+cell");const m=c.matches;m.forEach((b,A)=>{const x=b.startpos;let T=b.endpos;if(A===m.length-1&&b.annot==="str")for(;this.subject.codePointAt(T)===32&&T>=x;)T=T-1;this.addMatch(x,T,b.annot)}),this.addMatch(c.endpos,c.endpos,"-cell")}else{for(this.pos=s;this.matches.length>r;)this.matches.pop();return!1}}return this.addMatch(this.pos,this.pos,"-row"),this.pos=this.starteol,this.finishedLine=!0,!0}[Symbol.iterator](){const e=this.specs,n=this.subject.length;this.returned=0;const r=this;return{next(){for(;r.pos<n;){if(r.matches.length>0&&r.returned<r.matches.length)return r.returned=r.returned+1,{value:r.matches[r.returned-1],done:!1};r.indent=0,r.startline=r.pos,r.finishedLine=!1,r.getEol(),r.lastMatchedContainer=-1;let s=0;for(;s<r.containers.length;){const a=r.containers[s];if(r.skipSpace(),a.continue(a))r.lastMatchedContainer=s;else break;s=s+1}if(r.finishedLine)for(;r.containers.length>0&&r.lastMatchedContainer<r.containers.length-1;){const a=r.tip();a&&a.close()}if(!r.finishedLine){r.skipSpace();let a=r.pos===r.starteol,l=!1,u=r.containers[r.lastMatchedContainer],c=!a&&(!u||u.content===W.Block||u.content===W.ListItem)&&!r.find(ja);for(;c;){c=!1;for(const m of e)if((!u&&m.type===W.Block||u&&u.content===m.type)&&m.open(m)){if(r.tip())r.lastMatchedContainer=r.containers.length-1,u=r.containers[r.lastMatchedContainer],r.finishedLine?c=!1:(r.skipSpace(),l=!0,c=m.content===W.Block||m.content===W.ListItem);else throw new Error("No tip after opening container");break}}if(!r.finishedLine){r.skipSpace(),a=r.pos===r.starteol;let m=r.tip();if(!a&&!l&&r.lastMatchedContainer<r.containers.length-1&&m&&m.content===W.Inline||r.closeUnmatchedContainers(),m=r.tip(),(!m||m.content===W.Block)&&(a?l||r.addMatch(r.pos,r.endeol,"blankline"):(r.paraSpec.open(r.paraSpec),m=r.tip(),m&&(m.inlineParser=new pn.InlineParser(r.subject,r.options)))),m&&m.content===W.Text){let A=r.pos;m.indent!==null&&r.indent>m.indent&&(A=A-(r.indent-m.indent)),r.addMatch(A,r.endeol,"str")}else m&&m.content===W.Inline&&!a&&m.inlineParser&&m.inlineParser.feed(r.pos,r.endeol)}}r.pos=(r.endeol||r.pos)+1}return r.lastMatchedContainer=-1,r.closeUnmatchedContainers(),r.matches.length>0&&r.returned<r.matches.length?(r.returned=r.returned+1,{value:r.matches[r.returned-1],done:!1}):{value:{startpos:r.pos,endpos:r.pos,annot:""},done:!0}}}}}const to=function(t,e={}){return new Ja(t,e)};se.parseEvents=to;var bt={};Object.defineProperty(bt,"__esModule",{value:!0}),bt.isCaption=bt.isRow=bt.isBlock=bt.isInline=void 0;const eo={para:!0,heading:!0,block_quote:!0,thematic_break:!0,section:!0,div:!0,code_block:!0,raw_block:!0,bullet_list:!0,ordered_list:!0,task_list:!0,definition_list:!0,table:!0,reference:!0,footnote:!0};function no(t){return eo[t.tag]||!1}bt.isBlock=no;const ro={str:!0,soft_break:!0,hard_break:!0,non_breaking_space:!0,symb:!0,verbatim:!0,raw_inline:!0,inline_math:!0,display_math:!0,url:!0,email:!0,footnote_reference:!0,smart_punctuation:!0,emph:!0,strong:!0,link:!0,image:!0,span:!0,mark:!0,superscript:!0,subscript:!0,insert:!0,delete:!0,double_quoted:!0,single_quoted:!0};function so(t){return ro[t.tag]||!1}bt.isInline=so;function io(t){return"head"in t}bt.isRow=io;function ao(t){return!("head"in t)}bt.isCaption=ao,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.isInline=t.isCaption=t.isRow=t.isBlock=t.getStringContent=t.renderAST=t.parse=void 0;const e=se,n=It,r=bt;Object.defineProperty(t,"isRow",{enumerable:!0,get:function(){return r.isRow}}),Object.defineProperty(t,"isBlock",{enumerable:!0,get:function(){return r.isBlock}}),Object.defineProperty(t,"isCaption",{enumerable:!0,get:function(){return r.isCaption}}),Object.defineProperty(t,"isInline",{enumerable:!0,get:function(){return r.isInline}});const s=function(N){const E=[];return a(N,E),E.join("")};t.getStringContent=s;const a=function(N,E){if("text"in N)E.push(N.text);else if("tag"in N&&(N.tag==="soft_break"||N.tag==="hard_break"))E.push(`
`);else if("children"in N)for(const R of N.children)a(R,E)},l=function(N){return N.replace(/^ `/,"`").replace(/` $/,"`")},u={i:1,v:5,x:10,l:50,c:100,d:500,m:1e3,I:1,V:5,X:10,L:50,C:100,D:500,M:1e3},c=function(N){let E=0,R=0,K=N.length-1;for(;K>=0;){const X=N.charAt(K),Y=u[X];if(!Y)throw new Error("Encountered bad character in roman numeral "+N);Y<R?E=E-Y:E=E+Y,R=Y,K=K-1}return E},m=function(N,E){const R=E.replace(/[().]/g,""),K=N.replace(/[().]/g,"");switch(R){case"1":return parseInt(K,10);case"A":return(K.codePointAt(0)||65)-65+1;case"a":return(K.codePointAt(0)||97)-97+1;case"I":return c(K);case"i":return c(K)}};var b;(function(N){N[N.Normal=0]="Normal",N[N.Verbatim=1]="Verbatim",N[N.Literal=2]="Literal"})(b||(b={}));const A=function(N){return N.trim().replace(/[ \t\r\n]+/g," ")},x=function(N,E={}){const R=[-1];if(E.sourcePositions)for(let v=0;v<N.length;v++)N[v]===`
`&&R.push(v);const K=function(v){const k=R.length;let S=0,g=k-1,p=0,M=0;for(;!p;){const L=S+~~((g-S)/2);R[L]>v?g=L:R[L]<=v&&(L===g||R[L+1]>v?(p=L+1,M=v-R[L]):S===L&&S<g?S=L+1:S=L)}return{line:p,col:M,offset:v}};let X=b.Normal,Y="";const _n={},An={},os={},Ee={},$t={};let Sn=0;const Lo=(0,e.parseEvents)(N,E),ls=E.warn||(()=>{}),us=function(v){if(Object.keys($t).length>0){v.attributes=v.attributes||{};for(const k in $t)v.attributes[k]=$t[k],delete $t[k]}},Fo=function(v){const k=v.replace(/[\]\[~!@#$%^&*(){}`,.<>\\|=+/?\s]+/g," ").trim().replace(/ +/g,"-");let S=0,g=k;for(;!g||Ee[g];)S=S+1,g=(k||"s")+"-"+S;return g},Z=function(v){const k={children:[],data:{},pos:v,attributes:void 0};us(k),ot.push(k)},H=function(v){const k=ot.pop();if(!k)throw new Error("Container stack is empty (popContainer)");return v&&k.pos&&(k.pos.end=v.end),k},z=function(){if(ot.length>0)return ot[ot.length-1];throw new Error("Container stack is empty (topContainer)")},Ie=function(){const v=z();return v.children.length>0?v.children[v.children.length-1]:v},B=function(v){ot.length>0&&ot[ot.length-1].children.push(v)},zo={str:(v,k,S,g)=>{const p=N.substring(k,S+1);X===b.Normal?B({tag:"str",text:p,pos:g}):Y+=p},soft_break:(v,k,S,g)=>{X===b.Normal?B({tag:"soft_break",pos:g}):Y+=`
`},escape:(v,k,S,g)=>{X===b.Verbatim&&(Y+="\\")},hard_break:(v,k,S,g)=>{X===b.Normal?B({tag:"hard_break",pos:g}):Y+=`
`},non_breaking_space:(v,k,S,g)=>{X===b.Verbatim?Y+="\\ ":B({tag:"non_breaking_space",pos:g})},symb:(v,k,S,g)=>{if(X===b.Normal){const p=N.substring(k+1,S);B({tag:"symb",alias:p,pos:g})}else{const p=N.substring(k,S+1);Y+=p}},footnote_reference:(v,k,S,g)=>{const p=N.substring(k+2,S);B({tag:"footnote_reference",text:A(p),pos:g})},"+reference_definition":(v,k,S,g)=>{Z(g)},"-reference_definition":(v,k,S,g)=>{const p=H(g),M=A(p.data.key),L={tag:"reference",label:M,destination:p.data.value||"",attributes:p.attributes,pos:p.pos};p.data.key&&(_n[M]=L)},reference_key:(v,k,S,g)=>{z().data.key=N.substring(k+1,S),z().data.value=""},reference_value:(v,k,S,g)=>{z().data.value=z().data.value+N.substring(k,S+1)},"+emph":(v,k,S,g)=>{Z(g)},"-emph":(v,k,S,g)=>{const p=H(g);B({tag:"emph",children:p.children,pos:p.pos})},"+strong":(v,k,S,g)=>{Z(g)},"-strong":(v,k,S,g)=>{const p=H(g);B({tag:"strong",children:p.children,pos:p.pos})},"+span":(v,k,S,g)=>{Z(g)},"-span":(v,k,S,g)=>{const p=H(g);B({tag:"span",children:p.children,pos:p.pos})},"+mark":(v,k,S,g)=>{Z(g)},"-mark":(v,k,S,g)=>{const p=H(g);B({tag:"mark",children:p.children,pos:p.pos})},"+superscript":(v,k,S,g)=>{Z(g)},"-superscript":(v,k,S,g)=>{const p=H(g);B({tag:"superscript",children:p.children,pos:p.pos})},"+subscript":(v,k,S,g)=>{Z(g)},"-subscript":(v,k,S,g)=>{const p=H(g);B({tag:"subscript",children:p.children,pos:p.pos})},"+delete":(v,k,S,g)=>{Z(g)},"-delete":(v,k,S,g)=>{const p=H(g);B({tag:"delete",children:p.children,pos:p.pos})},"+insert":(v,k,S,g)=>{Z(g)},"-insert":(v,k,S,g)=>{const p=H(g);B({tag:"insert",children:p.children,pos:p.pos})},"+double_quoted":(v,k,S,g)=>{Z(g)},"-double_quoted":(v,k,S,g)=>{const p=H(g);B({tag:"double_quoted",children:p.children,pos:p.pos})},"+single_quoted":(v,k,S,g)=>{Z(g)},"-single_quoted":(v,k,S,g)=>{const p=H(g);B({tag:"single_quoted",children:p.children,pos:p.pos})},"+attributes":(v,k,S,g)=>{Z(g)},"-attributes":(v,k,S,g)=>{const p=H(g);if(p.attributes&&ot.length>0){p.attributes.id&&(Ee[p.attributes.id]=!0);let M=Ie();if(M===z())return;let L=!1;if("tag"in M&&M.tag==="str"){const U=M.text.match(/[^\s]+$/);if(U&&U.index&&U.index>0){let xt;if(M.pos){const yt=M.pos.end;M.pos.end={line:yt.line,col:yt.col-U[0].length,offset:yt.offset-U[0].length},xt={start:{line:yt.line,col:yt.col-U[0].length+1,offset:yt.offset-U[0].length+1},end:yt}}M.text=M.text.substring(0,U.index),B({tag:"str",text:U[0],pos:xt})}else U||(L=!0)}if(M=Ie(),L){ls(new n.Warning("Ignoring unattached attribute",E.sourcePositions?K(k):k));return}M.attributes||(M.attributes={});for(const U in p.attributes)U==="class"&&M.attributes[U]?M.attributes[U]=M.attributes[U]+" "+p.attributes[U]:M.attributes[U]=p.attributes[U]}},"+block_attributes":(v,k,S,g)=>{Z(g)},"-block_attributes":(v,k,S,g)=>{const p=H(g);if(p.attributes&&ot.length>0){p.attributes.id&&(Ee[p.attributes.id]=!0);for(const M in p.attributes)M==="class"&&$t[M]?$t[M]=$t[M]+" "+p.attributes[M]:$t[M]=p.attributes[M]}},class:(v,k,S,g)=>{const p=z(),M=N.substring(k,S+1);p.attributes||(p.attributes={}),p.attributes.class?p.attributes.class=p.attributes.class+" "+M:p.attributes.class=M},id:(v,k,S,g)=>{const p=z(),M=N.substring(k,S+1);p.attributes?p.attributes.id=M:p.attributes={id:M}},key:(v,k,S,g)=>{const p=z(),M=N.substring(k,S+1);p.data.key=M,p.attributes||(p.attributes={}),p.attributes[p.data.key]=""},value:(v,k,S,g)=>{const p=z(),M=N.substring(k,S+1).replace(/[ \r\n]+/g," ").replace(/\\([.,\\/#!$%^&*;:{}=\-_`~+[\]()'"?|])/g,"$1");if(p.attributes||(p.attributes={}),p.data.key)p.attributes[p.data.key]=p.attributes[p.data.key]+M;else throw new Error("Encountered value without key")},"+linktext":(v,k,S,g)=>{Z(g),z().data.isimage=!1},"-linktext":(v,k,S,g)=>{},"+imagetext":(v,k,S,g)=>{Z(g),z().data.isimage=!0},"-imagetext":(v,k,S,g)=>{},"+destination":(v,k,S,g)=>{X=b.Literal},"-destination":(v,k,S,g)=>{const p=H(g);B({tag:p.data.isimage?"image":"link",destination:Y.replace(/[\r\n]/g,""),children:p.children,pos:p.pos}),X=b.Normal,Y=""},"+reference":(v,k,S,g)=>{X=b.Literal},"-reference":(v,k,S,g)=>{const p=H(g);let M=Y;M.length===0&&(M=s(p)),B({tag:p.data.isimage?"image":"link",reference:A(M),children:p.children,pos:p.pos}),X=b.Normal,Y=""},"+verbatim":(v,k,S,g)=>{X=b.Verbatim,Z(g)},"-verbatim":(v,k,S,g)=>{const p=H(g);B({tag:"verbatim",text:l(Y),pos:p.pos}),X=b.Normal,Y=""},raw_format:(v,k,S,g)=>{const p=N.substring(k,S+1).replace(/^\{?=/,"").replace(/\}$/,""),M=z();if(X===b.Verbatim)M.data.format=p;else{const L=M.children[M.children.length-1];if(L&&"tag"in L&&L.tag==="verbatim")L.tag="raw_inline",L.format=p;else throw new Error("raw_format is not after verbatim or code_block.")}},"+display_math":(v,k,S,g)=>{X=b.Verbatim,Z(g)},"+inline_math":(v,k,S,g)=>{X=b.Verbatim,Z(g)},"-display_math":(v,k,S,g)=>{const p=H(g);B({tag:"display_math",text:l(Y),pos:p.pos}),X=b.Normal,Y=""},"-inline_math":(v,k,S,g)=>{const p=H(g);B({tag:"inline_math",text:l(Y),pos:p.pos}),X=b.Normal,Y=""},"+url":(v,k,S,g)=>{X=b.Literal,Z(g)},"-url":(v,k,S,g)=>{const p=H(g);B({tag:"url",text:Y.replace(/[\r\n]/g,""),pos:p.pos}),X=b.Normal,Y=""},"+email":(v,k,S,g)=>{X=b.Literal,Z(g)},"-email":(v,k,S,g)=>{const p=H(g);B({tag:"email",text:Y.replace(/[\r\n]/g,""),pos:p.pos}),X=b.Normal,Y=""},"+para":(v,k,S,g)=>{Z(g)},"-para":(v,k,S,g)=>{const p=H(g);B({tag:"para",children:p.children,attributes:p.attributes,pos:p.pos})},"+heading":(v,k,S,g)=>{Z(g),z().data.level=1+S-k},"-heading":(v,k,S,g)=>{const p=H(g);p.attributes||(p.attributes={}),p.autoAttributes||(p.autoAttributes={});const M=s(p).trim();p.attributes.id||(p.autoAttributes.id=Fo(M),Ee[p.autoAttributes.id]=!0);const L=A(M);!_n[L]&&!An[L]&&(An[L]={tag:"reference",label:L,destination:"#"+(p.attributes.id||p.autoAttributes.id)});let U=z();if(U.data.headinglevel!==void 0){for(;U&&U.data.headinglevel!==void 0&&U.data.headinglevel>=p.data.level;)U=H(g),B({tag:"section",children:U.children,attributes:U.attributes,autoAttributes:U.autoAttributes,pos:U.pos}),U=z();Z(g),z().data.headinglevel=p.data.level,p.autoAttributes&&p.autoAttributes.id&&(z().autoAttributes=p.autoAttributes,delete p.autoAttributes),p.attributes&&p.attributes.id&&(z().attributes=p.attributes,delete p.attributes)}B({tag:"heading",level:p.data.level,children:p.children,attributes:p.attributes,autoAttributes:p.autoAttributes,pos:p.pos})},"+list":(v,k,S,g)=>{Z(g),z().data.styles=v,z().data.blanklines=!1,z().data.tight=!0,Sn++},"-list":(v,k,S,g)=>{const p=H(g),M=p.data.styles[0];if(!M)throw new Error("No style defined for list");const L=m(p.data.firstMarker,M);B(M===":"?{tag:"definition_list",children:p.children,attributes:p.attributes,autoAttributes:p.autoAttributes,pos:p.pos}:M==="X"?{tag:"task_list",tight:p.data.tight,children:p.children,attributes:p.attributes,autoAttributes:p.autoAttributes,pos:p.pos}:M==="+"||M==="*"||M==="-"?{tag:"bullet_list",tight:p.data.tight,style:M,children:p.children,attributes:p.attributes,autoAttributes:p.autoAttributes,pos:p.pos}:{tag:"ordered_list",style:M,children:p.children,start:L,tight:p.data.tight,attributes:p.attributes,autoAttributes:p.autoAttributes,pos:p.pos}),Sn--},"+list_item":(v,k,S,g)=>{v.length<z().data.styles.length&&(z().data.styles=v),z().data.firstMarker||(z().data.firstMarker=N.substring(k,S+1)),Z(g),v.length===1&&v[0]===":"&&(z().data.definitionList=!0)},"-list_item":(v,k,S,g)=>{const p=H(g);if(p.data.definitionList)if(p.children[0]&&p.children[0].tag==="para"){const M={tag:"term",children:p.children[0].children};p.children.shift();const L={tag:"definition",children:p.children};B({tag:"definition_list_item",children:[M,L],attributes:p.attributes,autoAttributes:p.autoAttributes,pos:p.pos})}else{const M={tag:"term",children:[]},L={tag:"definition",children:p.children};B({tag:"definition_list_item",children:[M,L],attributes:p.attributes,autoAttributes:p.autoAttributes,pos:p.pos})}else p.data.checkbox?B({tag:"task_list_item",children:p.children,attributes:p.attributes,autoAttributes:p.autoAttributes,checkbox:p.data.checkbox,pos:p.pos}):B({tag:"list_item",children:p.children,attributes:p.attributes,autoAttributes:p.autoAttributes,pos:p.pos})},checkbox_checked:(v,k,S,g)=>{z().data.checkbox="checked"},checkbox_unchecked:(v,k,S,g)=>{z().data.checkbox="unchecked"},"+block_quote":(v,k,S,g)=>{Z(g)},"-block_quote":(v,k,S,g)=>{const p=H(g);B({tag:"block_quote",children:p.children,attributes:p.attributes,autoAttributes:p.autoAttributes,pos:p.pos})},"+table":(v,k,S,g)=>{Z(g),z().data.aligns=[]},"-table":(v,k,S,g)=>{var p;const M=H(g),L=M.children;let U={tag:"caption",children:[]};((p=L[0])===null||p===void 0?void 0:p.tag)==="caption"&&(U=L.shift()),B({tag:"table",children:[U,...L],attributes:M.attributes,autoAttributes:M.autoAttributes,pos:M.pos})},"+row":(v,k,S,g)=>{Z(g),z().data.aligns=[]},"-row":(v,k,S,g)=>{const p=H(g);if(p.children.length===0){z().data.aligns=p.data.aligns;const M=Ie();if(M&&"tag"in M&&M.tag==="row"){M.head=!0;for(let L=0;L<M.children.length;L++)M.children[L].head=!0,M.children[L].align=p.data.aligns[L]||"default"}}else{p.data.aligns=[];for(let M=0;M<p.children.length;M++)p.children[M].align=z().data.aligns[M]||"default";B({tag:"row",children:p.children,head:!1,attributes:p.attributes,autoAttributes:p.autoAttributes,pos:p.pos})}},separator_default:(v,k,S,g)=>{z().data.aligns.push("default")},separator_left:(v,k,S,g)=>{z().data.aligns.push("left")},separator_right:(v,k,S,g)=>{z().data.aligns.push("right")},separator_center:(v,k,S,g)=>{z().data.aligns.push("center")},"+cell":(v,k,S,g)=>{Z(g)},"-cell":(v,k,S,g)=>{const p=H(g);B({tag:"cell",children:p.children,head:!1,align:"default",attributes:p.attributes,autoAttributes:p.autoAttributes,pos:p.pos})},"+caption":(v,k,S,g)=>{Z(g)},"-caption":(v,k,S,g)=>{var p;const M=H(g),L=Ie();if(!L||"tag"in L&&L.tag!=="table")return;const U={tag:"caption",children:M.children,attributes:M.attributes,autoAttributes:M.autoAttributes,pos:M.pos};((p=L.children[0])===null||p===void 0?void 0:p.tag)==="caption"&&(L.children[0]=U)},"+footnote":(v,k,S,g)=>{Z(g)},"-footnote":(v,k,S,g)=>{const p=H(g);if(p.data.label){const M=A(p.data.label);os[M]={tag:"footnote",label:M||"",children:p.children,attributes:p.attributes,autoAttributes:p.autoAttributes,pos:p.pos}}else ls(new n.Warning("Ignoring footnote without a label.",E.sourcePositions?K(S):S))},note_label:(v,k,S,g)=>{z().data.label=N.substring(k,S+1)},"+code_block":(v,k,S,g)=>{Z(g),X=b.Verbatim},"-code_block":(v,k,S,g)=>{const p=H(g);p.data.format?B({tag:"raw_block",format:p.data.format,text:Y,attributes:p.attributes,autoAttributes:p.autoAttributes,pos:p.pos}):B({tag:"code_block",text:Y,lang:p.data.lang,attributes:p.attributes,autoAttributes:p.autoAttributes,pos:p.pos}),X=b.Normal,Y=""},code_language:(v,k,S,g)=>{const p=z();p.data.lang=N.substring(k,S+1)},"+div":(v,k,S,g)=>{Z(g)},"-div":(v,k,S,g)=>{const p=H(g);B({tag:"div",children:p.children,attributes:p.attributes,autoAttributes:p.autoAttributes,pos:p.pos})},thematic_break:(v,k,S,g)=>{const p={tag:"thematic_break",pos:g};us(p),B(p)},left_single_quote:(v,k,S,g)=>{B({tag:"smart_punctuation",type:"left_single_quote",text:"'",pos:g})},right_single_quote:(v,k,S,g)=>{B({tag:"smart_punctuation",type:"right_single_quote",text:"'",pos:g})},left_double_quote:(v,k,S,g)=>{B({tag:"smart_punctuation",type:"left_double_quote",text:'"',pos:g})},right_double_quote:(v,k,S,g)=>{B({tag:"smart_punctuation",type:"right_double_quote",text:'"',pos:g})},ellipses:(v,k,S,g)=>{B({tag:"smart_punctuation",type:"ellipses",text:"...",pos:g})},en_dash:(v,k,S,g)=>{B({tag:"smart_punctuation",type:"en_dash",text:"--",pos:g})},em_dash:(v,k,S,g)=>{B({tag:"smart_punctuation",type:"em_dash",text:"---",pos:g})},blankline:(v,k,S,g)=>{let p;"tight"in z().data?p=z():ot.length>=2&&"tight"in ot[ot.length-2].data&&(p=ot[ot.length-2]),p&&(p.data.blanklines=!0)}},jo=function(v,k){let S,g,p;E.sourcePositions&&(S=K(k.startpos),g=K(k.endpos),p={start:S,end:g});let M=k.annot,L=[];if(k.annot.includes("|")){const xt=k.annot.split("|");M=xt[0],L=xt.slice(1)}if(Sn>0&&M!=="blankline"){let xt;const yt=z();yt&&(yt.data&&"tight"in yt.data?xt=yt:v.length>=2&&"tight"in v[v.length-2].data&&(xt=v[v.length-2])),xt&&(!/^[+-]list/.test(M)&&xt.data.blanklines&&(xt.data.tight=!1),/^[-+]list_item$/.test(M)||(xt.data.blanklines=!1))}const U=zo[M];U&&U(L,k.startpos,k.endpos,p)},ot=[{children:[],data:{headinglevel:0},pos:{start:{line:0,col:0,offset:0},end:{line:0,col:0,offset:0}}}];let cs=0;for(const v of Lo)jo(ot,v),cs=v.endpos;let De;E.sourcePositions&&(De=K(cs));let Gt=z();for(;Gt&&Gt.data.headinglevel>0;)H(De&&{start:De,end:De}),B({tag:"section",children:Gt.children,attributes:Gt.attributes,autoAttributes:Gt.autoAttributes,pos:Gt.pos}),Gt=z();const Nn={tag:"doc",references:_n,autoReferences:An,footnotes:os,children:ot[0].children};return ot[0].autoAttributes&&(Nn.autoAttributes=ot[0].autoAttributes),ot[0].attributes&&(Nn.attributes=ot[0].attributes),Nn};t.parse=x;const T={children:!0,tag:!0,pos:!0,attributes:!0,autoAttributes:!0,references:!0,autoReferences:!0,footnotes:!0},D=function(N){return JSON.stringify(N).replace(/\\\n/g,"\\n")},j=function(N,E,R){if(E.push(" ".repeat(R)),R>128){E.push(`(((DEEPLY NESTED CONTENT OMITTED)))
`);return}E.push(N.tag),N.pos&&E.push(` (${N.pos.start.line}:${N.pos.start.col}:${N.pos.start.offset}-${N.pos.end.line}:${N.pos.end.col}:${N.pos.end.offset})`);for(const K in N)if(!T[K]){const X=N[K];X!=null&&E.push(` ${K}=${D(X)}`)}if(N.attributes)for(const K in N.attributes)E.push(` ${K}=${D(N.attributes[K])}`);if(E.push(`
`),N.children)for(const K of N.children)j(K,E,R+2)},rt=function(N){const E=[];if(j(N,E,0),Object.keys(N.references).length>0){E.push(`references
`);for(const R in N.references)E.push(`  [${D(R)}] =
`),j(N.references[R],E,4)}if(Object.keys(N.footnotes).length>0){E.push(`footnotes
`);for(const R in N.footnotes)E.push(`  [${D(R)}] =
`),j(N.footnotes[R],E,4)}return E.join("")};t.renderAST=rt}(ke);var Wt={};Object.defineProperty(Wt,"__esModule",{value:!0}),Wt.HTMLRenderer=Wt.renderHTML=void 0;const Jr=ke,oo=It,lo=/[&<>]/,uo=/[&<>"]/;class ts{constructor(e){this.smartPunctuationMap={right_single_quote:"’",left_single_quote:"‘",right_double_quote:"”",left_double_quote:"“",ellipses:"…",em_dash:"—",en_dash:"–"},this.warn=e.warn||(()=>{}),this.options=e||{},this.tight=!1,this.footnoteIndex={},this.nextFootnoteIndex=1,this.references={},this.autoReferences={}}escape(e){return lo.test(e)?e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"):e}escapeAttribute(e){return uo.test(e)?e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;"):e}renderAttributes(e,n){let r="";if(n)for(const a in n)if(a==="class"){let l=n[a];e.attributes&&e.attributes.class&&(l=`${l} ${e.attributes.class}`),r+=` ${a}="${this.escapeAttribute(l)}"`}else r+=` ${a}="${this.escapeAttribute(n[a])}"`;const s=Object.assign(Object.assign({},e.autoAttributes),e.attributes);if(s)for(const a in s){const l=s[a];a==="class"&&n&&n.class||(r+=` ${a}="${this.escapeAttribute(l)}"`)}if(e.pos){const a=e.pos.start,l=e.pos.end;r+=` data-startpos="${a.line}:${a.col}:${a.offset}" data-endpos="${l.line}:${l.col}:${l.offset}"`}return r}renderTag(e,n,r){let s="";return(n.attributes||n.autoAttributes||r||n.pos)&&(s=this.renderAttributes(n,r)),`<${e}${s}>`}renderCloseTag(e){return`</${e}>`}inTags(e,n,r,s){const a=r>=2?`
`:"",l=r>=1?`
`:"";return`${this.renderTag(e,n,s)}${a}${this.renderChildren(n)}</${e}>${l}`}addBacklink(e,n){const r=`<a href="#fnref${n}" role="doc-backlink">↩︎</a>`;return/\<\/p\>[\r\n]*$/.test(e)?e.replace(/\<\/p\>([\r\n]*)$/,r+"</p>$1"):e+`<p>${r}</p>
`}renderChildren(e){let n="";const r=this.tight;"tight"in e&&(this.tight=!!e.tight);for(const s of e.children)n+=this.renderAstNode(s);return"tight"in e&&(this.tight=r),n}renderAstNode(e){var n;const r=(n=this.options.overrides)===null||n===void 0?void 0:n[e.tag];return r?r(e,this):this.renderAstNodeDefault(e)}renderNotes(e){let n="";const r=[],s={};for(const a in e)s[a]=this.renderChildren(e[a]);for(const a in this.footnoteIndex){const l=this.footnoteIndex[a];l&&(r[l]=s[a])}n+=`<section role="doc-endnotes">
<hr>
<ol>
`;for(let a=1;a<r.length;a++){const l=r[a]||"";n+=`<li id="fn${a}">
`,n+=this.addBacklink(l,a),n+=`</li>
`}return n+=`</ol>
</section>
`,n}renderAstNodeDefault(e){var n;switch(e.tag){case"doc":{let r="";return r+=this.renderChildren(e),this.nextFootnoteIndex>1&&(r+=this.renderNotes(e.footnotes)),r}case"para":return this.tight?`${this.renderChildren(e)}
`:this.inTags("p",e,1);case"block_quote":return this.inTags("blockquote",e,2);case"div":return this.inTags("div",e,2);case"section":return this.inTags("section",e,2);case"list_item":return this.inTags("li",e,2);case"task_list_item":return this.inTags("li",e,2,{class:e.checkbox==="checked"?"checked":"unchecked"});case"definition_list_item":return this.renderChildren(e);case"definition":return this.inTags("dd",e,2);case"term":return this.inTags("dt",e,1);case"definition_list":return this.inTags("dl",e,2);case"bullet_list":return this.inTags("ul",e,2);case"task_list":return this.inTags("ul",e,2,{class:"task-list"});case"ordered_list":{const r={};return e.start&&e.start!==1&&(r.start=e.start.toString()),e.style&&!/1/.test(e.style)&&(r.type=e.style.replace(/[().]/g,"")),this.inTags("ol",e,2,r)}case"heading":return this.inTags(`h${e.level}`,e,1);case"footnote_reference":{let r="";const s=e.text;let a=this.footnoteIndex[s];return a||(a=this.nextFootnoteIndex,this.footnoteIndex[s]=a,this.nextFootnoteIndex++),r+=this.renderTag("a",e,{id:"fnref"+a,href:"#fn"+a,role:"doc-noteref"}),r+="<sup>",r+=this.escape(a.toString()),r+="</sup></a>",r}case"table":return this.inTags("table",e,2);case"caption":{let r="";return e.children.length>0&&(r+=this.inTags("caption",e,1)),r}case"row":return this.inTags("tr",e,2);case"cell":{const r={};return e.align&&e.align!=="default"&&(r.style=`text-align: ${e.align};`),this.inTags(e.head?"th":"td",e,1,r)}case"thematic_break":{let r="";return r+=this.renderTag("hr",e),r+=`
`,r}case"code_block":{let r="";return r+=this.renderTag("pre",e),r+="<code",e.lang&&(r+=` class="language-${this.escapeAttribute(e.lang)}"`),r+=">",r+=this.escape(e.text),r+=this.renderCloseTag("code"),r+=this.renderCloseTag("pre"),r+=`
`,r}case"raw_block":{let r="";return e.format==="html"&&(r+=e.text),r}case"str":return e.attributes||e.autoAttributes?`${this.renderTag("span",e)}${this.escape(e.text)}</span>`:this.escape(e.text);case"smart_punctuation":return this.smartPunctuationMap[e.type]||e.text;case"double_quoted":{let r="";return r+=this.smartPunctuationMap.left_double_quote||'"',r+=this.renderChildren(e),r+=this.smartPunctuationMap.right_double_quote||'"',r}case"single_quoted":{let r="";return r+=this.smartPunctuationMap.left_single_quote||"'",r+=this.renderChildren(e),r+=this.smartPunctuationMap.right_single_quote||"'",r}case"symb":return this.escape(`:${e.alias}:`);case"inline_math":{let r="";return r+=this.renderTag("span",e,{class:"math inline"}),r+=`\\(${this.escape(e.text)}\\)`,r+=this.renderCloseTag("span"),r}case"display_math":{let r="";return r+=this.renderTag("span",e,{class:"math display"}),r+=`\\[${this.escape(e.text)}\\]`,r+=this.renderCloseTag("span"),r}case"verbatim":{let r="";return r+=this.renderTag("code",e),r+=this.escape(e.text),r+=this.renderCloseTag("code"),r}case"raw_inline":{let r="";return e.format==="html"&&(r+=e.text),r}case"soft_break":return`
`;case"hard_break":return`<br>
`;case"non_breaking_space":return"&nbsp;";case"link":case"image":{const r={};let s=e.destination;if(e.reference){const a=this.references[e.reference]||this.autoReferences[e.reference];if(a){if(s=a.destination,e.tag==="image"?(r.alt=(0,Jr.getStringContent)(e),r.src=s):r.href=s,a.attributes)for(const l in a.attributes)(!e.attributes||!e.attributes[l])&&(r[l]=a.attributes[l]);if(a.autoAttributes)for(const l in a.autoAttributes)(!e.autoAttributes||!e.autoAttributes[l])&&(r[l]=a.autoAttributes[l])}else this.warn(new oo.Warning(`Reference ${JSON.stringify(e.reference)} not found`,(n=e==null?void 0:e.pos)===null||n===void 0?void 0:n.end))}else e.tag==="image"?(r.alt=(0,Jr.getStringContent)(e),s!==void 0&&(r.src=s)):s!==void 0&&(r.href=s);return e.tag==="image"?this.renderTag("img",e,r):this.inTags("a",e,0,r)}case"url":case"email":{let r="";const s={};return e.tag==="email"?s.href="mailto:"+e.text:s.href=e.text,r+=this.renderTag("a",e,s),r+=this.escape(e.text),r+=this.renderCloseTag("a"),r}case"strong":return this.inTags("strong",e,0);case"emph":return this.inTags("em",e,0);case"span":return this.inTags("span",e,0);case"mark":return this.inTags("mark",e,0);case"insert":return this.inTags("ins",e,0);case"delete":return this.inTags("del",e,0);case"superscript":return this.inTags("sup",e,0);case"subscript":return this.inTags("sub",e,0);default:return""}}render(e){return this.references=e.references,this.autoReferences=e.autoReferences,this.renderAstNode(e)}}Wt.HTMLRenderer=ts;const co=function(t,e={}){return new ts(e).render(t)};Wt.renderHTML=co;var Ce={};Object.defineProperty(Ce,"__esModule",{value:!0}),Ce.applyFilter=void 0;class ho{constructor(e){this.finished=!1,this.stack=[],this.enter=!0,this.top=e,this.current=e}walk(e){for(;!this.finished;){e(this);const n=this.stack&&this.stack[this.stack.length-1];if(this.enter)"children"in this.current&&this.current.children.length>0?(this.stack.push({node:this.current,childIndex:0}),this.current=this.current.children[0],this.enter=!0):this.enter=!1;else if(n){n.childIndex++;const r=n.node.children[n.childIndex];r?(this.current=r,this.enter=!0):(this.stack.pop(),this.current=n.node,this.enter=!1)}else this.finished=!0}}}const po=function(t,e,n){if(!t||!t.tag)throw new Error("Filter called on a non-node.");const r=n[t.tag];if(!r)return!1;let s;if(e?"enter"in r&&r.enter&&(s=r.enter):"exit"in r&&r.exit?s=r.exit:s=r,typeof s=="function")return s(t)},bn=function(t,e){return new ho(t).walk(n=>{let r=po(n.current,n.enter,e);const s=n.stack[n.stack.length-1];if(typeof r=="object"&&"stop"in r&&r.stop&&(r=r.stop,n.enter=!1),r){if(Array.isArray(r))if(s)s.node.children.splice(s.childIndex,1,...r),n.current=s.node.children[s.childIndex],r.length>1&&(s.childIndex+=r.length-1);else throw Error("Cannot replace top node with multiple nodes");else if(typeof r=="object"&&"tag"in r&&r.tag)if(s)s.node.children[s.childIndex]=r;else return r}}),t},mo=function(t,e){const n=e();let r;Array.isArray(n)?r=n:r=[n];for(const s of r){bn(t,s);for(const a in t.footnotes)bn(t.footnotes[a],s);for(const a in t.references)bn(t.references[a],s)}};Ce.applyFilter=mo;var Vt={};Object.defineProperty(Vt,"__esModule",{value:!0}),Vt.fromPandoc=Vt.toPandoc=void 0;const Te=It,qe={Decimal:{Period:"1.",OneParen:"1)",TwoParens:"(1)"},LowerAlpha:{Period:"a.",OneParen:"a)",TwoParens:"(a)"},UpperAlpha:{Period:"A.",OneParen:"A)",TwoParens:"(A)"},LowerRoman:{Period:"i.",OneParen:"i)",TwoParens:"(i)"},UpperRoman:{Period:"I.",OneParen:"I)",TwoParens:"(I)"}},es={};for(const t in qe)for(const e in qe[t])es[qe[t][e]]=[t,e];const fo=function(t){return t.t==="Para"&&(t.t="Plain"),t},At=function(t){const e=Object.assign(Object.assign({},t.autoAttributes),t.attributes);if(e){const n=e.id||"",r=e.class&&e.class.split(" ")||[],s=[];for(const a in e)a!==n&&a!=="class"&&s.push([a,e[a]]);return[n,r,s]}else return["",[],[]]};class go{constructor(e={}){this.references={},this.footnotes={},this.options=e,this.smartPunctuationMap=this.options.smartPunctuationMap||{right_single_quote:"’",left_single_quote:"‘",right_double_quote:"”",left_double_quote:"“",ellipses:"…",em_dash:"—",en_dash:"–"},this.warn||(this.warn=()=>{})}toPandocChildren(e){if("children"in e){const n=[];return e.children.forEach(r=>{this.addToPandocElts(n,r)}),n}else return[]}toPandocDefinitionListItem(e){const n=this;return function(r){if(!("children"in r))return[];const[s,a]=r.children;return[n.toPandocChildren(s),[n.toPandocChildren(a)]]}}toPandocListItem(e){const n=this;return function(r){let s=n.toPandocChildren(r);return"checkbox"in r&&r.checkbox&&s[0].t==="Para"&&(r.checkbox==="checked"?s[0].c.unshift({t:"Str",c:"☒"},{t:"Space"}):s[0].c.unshift({t:"Str",c:"☐"},{t:"Space"})),"tight"in e&&e.tight&&(s=s.map(fo)),s}}addToPandocElts(e,n){switch(n.tag){case"section":case"div":{const r=At(n);n.tag==="section"&&r[1].unshift("section"),e.push({t:"Div",c:[r,this.toPandocChildren(n)]});break}case"block_quote":e.push({t:"BlockQuote",c:this.toPandocChildren(n)});break;case"definition_list":{const r=n.children.map(this.toPandocDefinitionListItem(n));e.push({t:"DefinitionList",c:r});break}case"task_list":case"bullet_list":{let r;r=n.children.map(this.toPandocListItem(n)),e.push({t:"BulletList",c:r});break}case"ordered_list":{const r=n.children.map(this.toPandocListItem(n)),[s,a]=es[n.style],l=n.start||1;e.push({t:"OrderedList",c:[[l,{t:s},{t:a}],r]});break}case"task_list_item":case"list_item":break;case"para":e.push({t:"Para",c:this.toPandocChildren(n)});break;case"heading":e.push({t:"Header",c:[n.level,At(n),this.toPandocChildren(n)]});break;case"code_block":{const r=At(n);n.lang&&r[1].unshift(n.lang),e.push({t:"CodeBlock",c:[r,n.text]});break}case"raw_block":e.push({t:"RawBlock",c:[n.format,n.text]});break;case"thematic_break":e.push({t:"HorizontalRule"});break;case"table":{const r=At(n),s=["",[],[]];let a=[],l=[],u=[];const c=[],m=[s,[]];let b=[],A=[];const x={left:"AlignLeft",right:"AlignRight",center:"AlignCenter",default:"AlignDefault"},T=function(N){return[{t:x[N.align]||"AlignDefault"},{t:"ColWidthDefault"}]},D=this,j=function(N){if("children"in N)return[At(N),{t:"align"in N&&x[N.align]||"AlignDefault"},1,1,[{t:"Plain",c:D.toPandocChildren(N)}]]},rt=function(N){if("children"in N)return[At(N),N.children.map(j)]};for(let N=0;N<n.children.length;N++){const E=n.children[N];if(!("children"in E))break;l.length===0&&(l=E.children.map(T)),E.tag==="caption"?E.children.length&&(a=this.toPandocChildren(E)):E.head?A.length===0?b.push(rt(E)):(c.push([s,0,b,A]),A=[],b=[rt(E)]):(c.length===0&&A.length===0&&(u=b,b=[]),A.push(rt(E)))}(b.length>0||A.length>0)&&c.push([s,0,b,A]),e.push({t:"Table",c:[r,[null,[{t:"Plain",c:a}]],l,[s,u],c,m]});break}case"raw_inline":e.push({t:"RawInline",c:[n.format,n.text]});break;case"soft_break":e.push({t:"SoftBreak"});break;case"hard_break":e.push({t:"LineBreak"});break;case"str":n.text.split(/ +/).forEach((r,s)=>{s>0&&e.push({t:"Space"}),r.length>0&&e.push({t:"Str",c:r})});break;case"verbatim":e.push({t:"Code",c:[At(n),n.text]});break;case"inline_math":e.push({t:"Math",c:[{t:"InlineMath"},n.text]});break;case"display_math":e.push({t:"Math",c:[{t:"DisplayMath"},n.text]});break;case"non_breaking_space":e.push({t:"Str",c:" "});break;case"smart_punctuation":e.push({t:"Str",c:this.smartPunctuationMap[n.type]||n.text});break;case"symb":e.push({t:"Span",c:[["",["symbol"],[["alias",n.alias]]],[{t:"Str",c:":"+n.alias+":"}]]});break;case"single_quoted":case"double_quoted":{const r={t:n.tag==="single_quoted"?"SingleQuote":"DoubleQuote"};e.push({t:"Quoted",c:[r,this.toPandocChildren(n)]});break}case"email":case"url":{let r=n.text;n.tag==="email"&&(r="mailto:"+r);const s=At(n);s[1].unshift(n.tag==="email"?"email":"uri"),e.push({t:"Link",c:[s,[{t:"Str",c:n.text}],[r,""]]});break}case"image":case"link":{let r=n.destination||"";const s={};if(n.reference){const m=this.references[n.reference];if(m){r=m.destination||"";const b=Object.assign(Object.assign({},m.autoAttributes),m.attributes);if(b)for(const A in b)s[A]=b[A]}else this.warn(new Te.Warning("Reference "+n.reference+" not found."))}const a=Object.assign(Object.assign({},n.autoAttributes),n.attributes);if(a)for(const m in a)s[m]&&m==="class"?s[m]+=" "+a[m]:s[m]||(s[m]=a[m]);const l=At({tag:"link",attributes:s,children:[]}),u=r||"",c=n.attributes&&n.attributes.title||n.autoAttributes&&n.autoAttributes.title||"";c&&(l[2]=l[2].filter(([m,b])=>m!=="title")),e.push({t:n.tag==="link"?"Link":"Image",c:[l,this.toPandocChildren(n),[u,c]]});break}case"emph":e.push({t:"Emph",c:this.toPandocChildren(n)});break;case"strong":e.push({t:"Strong",c:this.toPandocChildren(n)});break;case"superscript":e.push({t:"Superscript",c:this.toPandocChildren(n)});break;case"subscript":e.push({t:"Subscript",c:this.toPandocChildren(n)});break;case"span":e.push({t:"Span",c:[At(n),this.toPandocChildren(n)]});break;case"mark":e.push({t:"Span",c:[["",["mark"],[]],this.toPandocChildren(n)]});break;case"insert":e.push({t:"Underline",c:this.toPandocChildren(n)});break;case"delete":e.push({t:"Strikeout",c:this.toPandocChildren(n)});break;case"footnote_reference":{const r=this.footnotes[n.text];r?e.push({t:"Note",c:this.toPandocChildren(r)}):e.push({t:"Superscript",c:[{t:"Str",c:n.text}]});break}default:this.warn(new Te.Warning("Skipping unhandled node "+n.tag))}}toPandoc(e){return this.references=e.references,this.footnotes=e.footnotes,{"pandoc-api-version":[1,23],meta:{},blocks:this.toPandocChildren(e)}}}const St=function(t){const e={};t[0]&&(e.id=t[0]),t[1].length>0&&(e.class=t[1].join(" "));for(let n=0;n<t[2].length;n++)e[t[2][n][0].toString()]=t[2][n][1];return Object.keys(e).length===0?null:e},xn=function(t){return t.t==="Plain"||t.t==="Para"},bo=function(t){if(!t[0])return null;const e=t[0];return xn(e)&&e.c.length>=2&&e.c[0].t==="Str"&&e.c[1].t==="Space"?e.c[0].c==="☒"?(e.c.shift(),e.c.shift(),"checked"):e.c[0].c==="☐"?(e.c.shift(),e.c.shift(),"unchecked"):null:null};class xo{constructor(e={}){this.footnotes={},this.footnoteIndex=0,this.options=e,this.warn=e.warn||(()=>{})}fromPandocInlines(e){let n=[];const r=[];for(let s=0;s<e.length;s++){const a=e[s];if(a.t==="Str")n.push(a.c);else if(a.t==="Space")n.push(" ");else switch(n.length>0&&(r.push({tag:"str",text:n.join("")}),n=[]),a.t){case"SoftBreak":r.push({tag:"soft_break"});break;case"LineBreak":r.push({tag:"hard_break"});break;case"Emph":r.push({tag:"emph",children:this.fromPandocInlines(a.c)});break;case"Strong":r.push({tag:"strong",children:this.fromPandocInlines(a.c)});break;case"Superscript":r.push({tag:"superscript",children:this.fromPandocInlines(a.c)});break;case"Subscript":r.push({tag:"subscript",children:this.fromPandocInlines(a.c)});break;case"Strikeout":r.push({tag:"delete",children:this.fromPandocInlines(a.c)});break;case"Span":{const l={tag:"span",children:this.fromPandocInlines(a.c[1])},u=St(a.c[0]);u&&(l.attributes=u),r.push(l);break}case"Underline":r.push({tag:"span",attributes:{class:"underline"},children:this.fromPandocInlines(a.c)});break;case"SmallCaps":r.push({tag:"span",attributes:{class:"smallcaps"},children:this.fromPandocInlines(a.c)});break;case"Math":r.push({tag:a.c[0].t==="DisplayMath"?"display_math":"inline_math",text:a.c[1]});break;case"Quoted":a.c[0].t==="SingleQuote"?r.push({tag:"single_quoted",children:this.fromPandocInlines(a.c[1])}):r.push({tag:"double_quoted",children:this.fromPandocInlines(a.c[1])});break;case"RawInline":r.push({tag:"raw_inline",format:a.c[0],text:a.c[1]});break;case"Code":{const l=St(a.c[0]),u={tag:"verbatim",text:a.c[1]};l&&(u.attributes=l),r.push(u);break}case"Image":case"Link":{let l=St(a.c[0]);a.c[2][1]&&(l=l||{},l.title=a.c[2][1]);const u=a.c[2][0],c=this.fromPandocInlines(a.c[1]);if(a.t==="Image"){const m={tag:"image",destination:u,children:c};l&&(m.attributes=l),r.push(m)}else{const m={tag:"link",destination:u,children:c};l&&(m.attributes=l),r.push(m)}break}case"Cite":r.push({tag:"span",attributes:{class:"cite"},children:this.fromPandocInlines(a.c[1])});break;case"Note":{this.footnoteIndex++;const l=this.footnoteIndex.toString(),u=a.c.map(c=>this.fromPandocBlock(c));this.footnotes[this.footnoteIndex.toString()]={tag:"footnote",label:l,children:u},r.push({tag:"footnote_reference",text:l});break}}}return n.length>0&&r.push({tag:"str",text:n.join("")}),r}fromPandocBlock(e){switch(e.t){case"Plain":case"Para":return{tag:"para",children:this.fromPandocInlines(e.c)};case"BlockQuote":return{tag:"block_quote",children:e.c.map(n=>this.fromPandocBlock(n))};case"Div":{let n=St(e.c[0]);const r=/\bsection\b/.test(n&&n.class||"")?"section":"div",s=e.c[1].map(a=>this.fromPandocBlock(a));if(r==="section")return n=n||{},n.class=n.class.replace(/section */,""),n.class||delete n.class,{tag:"section",attributes:n,children:s};{const a={tag:"div",children:s};return n&&(a.attributes=n),a}}case"Header":{const n=St(e.c[1]),r={tag:"heading",level:e.c[0],children:this.fromPandocInlines(e.c[2])};return n&&(r.attributes=n),r}case"HorizontalRule":return{tag:"thematic_break"};case"RawBlock":return{tag:"raw_block",format:e.c[0],text:e.c[1]};case"CodeBlock":{const n=St(e.c[0]);let r;if(n&&n.class){const a=n.class.split(/  */);r=a[0],a.shift(),a.length>0?n.class=a.join(" "):delete n.class}const s={tag:"code_block",lang:r,text:e.c[1]};return n&&(s.attributes=n),r||delete s.lang,s}case"DefinitionList":{const n=[];for(let r=0;r<e.c.length;r++){const s=e.c[r][0],a=e.c[r][1],l=this.fromPandocInlines(s),u=[];for(let c=0;c<a.length;c++)a[c].map(m=>{u.push(this.fromPandocBlock(m))});n.push({tag:"definition_list_item",children:[{tag:"term",children:l},{tag:"definition",children:u}]})}return{tag:"definition_list",children:n}}case"OrderedList":case"BulletList":{const n=[],r=[];let s=!1,a;e.t==="BulletList"?a=e.c:a=e.c[1];for(let l=0;l<a.length;l++){const u=bo(a[l]),c=a[l].map(m=>(m.t==="Plain"?s=!0:m.t==="Para"&&(s=!1),this.fromPandocBlock(m)));u!==null?r.push({tag:"task_list_item",checkbox:u,children:c}):n.push({tag:"list_item",children:c})}if(e.t==="BulletList")return r.length>0?{tag:"task_list",tight:s,children:r}:{tag:"bullet_list",style:"-",tight:s,children:n};if(e.t==="OrderedList"){const l=e.c[0][0];let u=e.c[0][1].t;u==="DefaultStyle"&&(u="Decimal");let c=e.c[0][2].t;return c==="DefaultDelim"&&(c="Period"),{tag:"ordered_list",style:qe[u][c],start:l,tight:s,children:n}}}case"Table":{const n=St(e.c[0]),r=e.c[1][1],s={tag:"caption",children:[]};r.length>1||r.length===1&&!xn(r[0])?this.warn(new Te.Warning("Skipping block-level content in table caption.")):r[0]&&"c"in r[0]&&(s.children=this.fromPandocInlines(r[0].c));const a=e.c[2],l=[];for(const x in a)l.push(a[x][0].t.slice(5).toLowerCase());const u=[],c=e.c[3][1];for(const x in c)u.push(this.fromPandocRow(c[x],!0,0,l));const m=e.c[4];for(const x in m){const T=m[x][1],D=m[x][2];for(const rt in D)u.push(this.fromPandocRow(D[rt],!0,T,l));const j=m[x][3];for(const rt in j)u.push(this.fromPandocRow(j[rt],!1,T,l))}const b=e.c[5][1];for(const x in b)u.push(this.fromPandocRow(b[x],!1,0,l));const A={tag:"table",children:[s,...u]};return n&&(A.attributes=n),A}case"Figure":{const n=St(e.c[0]);/\bsection\b/.test(n&&n.class||"");const r=e.c[2].map(l=>this.fromPandocBlock(l)),s=e.c[1][1];if(s.length>0){const l=s.map(u=>this.fromPandocBlock(u));r.push(...l)}const a={tag:"div",children:r};return n&&(a.attributes=n),a}case"LineBlock":{const n=[];for(let r=0;r<e.c.length;r++)r>0&&n.push({tag:"hard_break"}),n.push(...this.fromPandocInlines(e.c[r]));return{tag:"para",children:n}}case"Null":return{tag:"raw_block",format:"none",text:""}}return{tag:"raw_block",format:"error",text:"Could not convert "+e.t}}fromPandocRow(e,n,r,s){const a=St(e[0]),l=e[1],u=[];for(let m=0;m<l.length;m++)u.push(this.fromPandocCell(l[m],n||m<r,s[m]));const c={tag:"row",head:n,children:u};return a&&(c.attributes=a),c}fromPandocCell(e,n,r){let s=[];const a=St(e[0]);let l=e[1].t.slice(5).toLowerCase();l==="default"&&(l=r);const u=e[4];u.length>1||u.length===1&&!xn(u[0])?(this.warn(new Te.Warning("Skipping table cell with block-level content.")),s=[{tag:"str",text:"((content omitted))"}]):u[0]&&(s=this.fromPandocInlines(u[0].c));const c={tag:"cell",head:n,align:l,children:s};return a&&(c.attributes=a),c}fromPandoc(e){if(typeof e!="object")throw Error("Pandoc document must be an object");if(e["pandoc-api-version"])if(e.blocks){if(!e.meta)throw Error("Pandoc document lacks meta")}else throw Error("Pandoc document lacks blocks");else throw Error("Pandoc document lacks pandoc-api-version");return{tag:"doc",children:e.blocks.map(s=>this.fromPandocBlock(s)),footnotes:this.footnotes,references:{},autoReferences:{}}}}const yo=function(t,e){return new go(e).toPandoc(t)};Vt.toPandoc=yo;const wo=function(t,e){return new xo(e).fromPandoc(t)};Vt.fromPandoc=wo;var Me={};Object.defineProperty(Me,"__esModule",{value:!0}),Me.renderDjot=void 0;const jt=bt,ns=ke,rs=function(t){const e=t.tag;return e==="space"||e==="soft_break"||e==="hard_break"},vo=function(t){return t.children[0]&&rs(t.children[0])},ko=function(t){return t.children[0]&&rs(t.children[t.children.length-1])},yn=function(t,e){const n=t.text.match(/(`+)/g),r={};if(n)for(const a in n)r[n[a].length]=!0;let s=e;for(;r[s];)s++;return"`".repeat(s)},ss=function(t){if(t<0||t>=4e3)return"?";let e="";for(;t>0;)if(t>=1e3)e+="M",t-=1e3;else if(t>=900)e+="CM",t-=900;else if(t>=500)e+="D",t-=500;else if(t>=400)e+="CD",t-=400;else if(t>=100)e+="C",t-=100;else if(t>=90)e+="XC",t-=90;else if(t>=50)e+="L",t-=50;else if(t>=40)e+="XL",t-=40;else if(t>=10)e+="X",t-=10;else if(t==9)e+="IX",t-=9;else if(t>=5)e+="V",t-=5;else if(t==4)e+="IV",t-=4;else if(t>=1)e+="I",t-=1;else throw new Error("toRoman encountered x = "+t);return e},_o=function(t,e){const n=e.replace(/[a-zA-Z0-9]+/g,"$"),r=e.replace(/[.()]/g,"");let s;switch(r){case"1":s=t.toString();break;case"a":s=String.fromCodePoint(96+t%26);break;case"A":s=String.fromCodePoint(64+t%26);break;case"i":s=ss(t).toLowerCase();break;case"I":s=ss(t);break;default:throw new Error("formatNumber encountered unknown style "+e)}return n.replace("$",s)};class Ao{constructor(e,n={}){this.prefixes=[],this.buffer=[],this.startOfLine=!0,this.endOfPrefix=0,this.column=0,this.needsBlankLine=!1,this.handlers={doc:r=>{this.renderChildren(r.children),this.prefixes=[],this.cr(),Object.keys(r.references).length>0&&(this.cr(),this.newline());for(const a in r.references)this.renderNode(r.references[a]);Object.keys(r.footnotes).length>0;for(const a in r.footnotes)this.renderNode(r.footnotes[a]);this.prefixes=[],this.cr()},footnote:r=>{this.lit("[^"+r.label+"]:"),this.space(),this.needsBlankLine=!1,this.prefixes.push("  "),this.renderChildren(r.children),this.prefixes.pop(),this.blankline()},reference:r=>{this.lit("["),this.lit(r.label),this.lit("]:"),this.prefixes.push("  "),this.space(),this.lit(r.destination),this.wrap(),this.prefixes.pop(),this.blankline()},para:r=>{this.renderChildren(r.children),this.blankline()},thematic_break:()=>{this.lit("* * * * *"),this.blankline()},div:r=>{this.lit(":::"),this.cr(),this.renderChildren(r.children),this.cr(),this.lit(":::"),this.blankline()},heading:r=>{const s="#".repeat(r.level);this.lit(s+" "),this.prefixes.push(s+" "),this.renderChildren(r.children),this.prefixes.pop(),this.blankline()},block_quote:r=>{this.prefixes.push("> "),this.lit("> "),this.renderChildren(r.children),this.prefixes.pop(),this.blankline()},section:r=>{this.renderChildren(r.children)},code_block:r=>{const s=yn(r,3);this.lit(s),r.lang&&this.lit(" "+r.lang),this.cr(),this.litlines(r.text),this.cr(),this.lit(s),this.blankline()},raw_block:r=>{const s=yn(r,3);this.lit(s),this.lit(" ="+r.format),this.cr(),this.litlines(r.text),this.cr(),this.lit(s),this.blankline()},definition_list:r=>{const s=r.children;for(let a=0;a<s.length;a++){const l=s[a];a>0&&this.newline(),this.lit(":"),this.needsBlankLine=!1,this.space(),this.prefixes.push(" ".repeat(2)),this.renderChildren(l.children),this.prefixes.pop()}},ordered_list:r=>{const s=r.style,a=r.start||1,l=r.children,u=r.tight;for(let c=0;c<l.length;c++){const m=l[c];c>0&&(this.cr(),u||this.newline());const b=_o(a+c,s);this.lit(b),this.needsBlankLine=!1,this.space(),this.prefixes.push(" ".repeat(b.length+1)),this.renderChildren(m.children),this.prefixes.pop()}u&&this.blankline()},bullet_list:r=>{const s=r.children,a=r.tight;for(let l=0;l<s.length;l++){const u=s[l];l>0&&(this.cr(),a||this.newline());const c=r.style;this.lit(c),this.needsBlankLine=!1,this.space(),this.prefixes.push(" ".repeat(c.length+1)),this.renderChildren(u.children),this.prefixes.pop()}a&&this.blankline()},task_list:r=>{const s=r.children,a=r.tight;for(let l=0;l<s.length;l++){const u=s[l];l>0&&(this.cr(),a||this.newline()),this.needsBlankLine=!1,this.lit(`- [${u.checkbox==="checked"?"X":" "}]`),this.space(),this.prefixes.push(" ".repeat(6)),this.renderChildren(u.children),this.prefixes.pop()}a&&this.blankline()},term:r=>{this.renderChildren(r.children),this.blankline()},definition:r=>{this.renderChildren(r.children)},table:r=>{const s=r.children.filter(jt.isCaption),a=r.children.filter(jt.isRow);for(let l=0;l<a.length;l++){const u=a[l];if("head"in u&&!u.head&&l>0&&a[l-1].head){const c=a[l-1];for(let m=0;m<c.children.length;m++){switch(m===0&&this.lit("|"),c&&c.children[m].align){case"left":this.lit(":--");break;case"right":this.lit("--:");break;case"center":this.lit(":-:");break;default:this.lit("---")}this.lit("|")}this.cr()}for(let c=0;c<u.children.length;c++){const m=u.children[c];c===0&&this.lit("|"),this.noWrap(()=>{m.tag==="cell"&&this.renderChildren(m.children)}),this.lit("|")}this.cr()}s.length>0&&s[0].children.length>0&&(this.newline(),this.lit("^ "),this.needsBlankLine=!1,this.prefixes.push("  "),this.renderChildren(s[0].children),this.prefixes.pop(),this.blankline()),this.blankline()},str:r=>{r.text.split(/  */).forEach((s,a)=>{a>0&&this.space(),this.out(s)})},space:()=>{this.space()},soft_break:()=>{this.soft_break()},smart_punctuation:r=>{this.lit(r.text)},non_breaking_space:()=>{this.lit("\\ ")},single_quoted:this.inlineContainer("'"),double_quoted:this.inlineContainer('"'),emph:this.inlineContainer("_"),strong:this.inlineContainer("*"),superscript:this.inlineContainer("^"),subscript:this.inlineContainer("~"),mark:this.inlineContainer("=",!0),delete:this.inlineContainer("-",!0),insert:this.inlineContainer("+",!0),footnote_reference:r=>{this.lit("[^"+r.text+"]")},symb:r=>{this.lit(":"+r.alias+":")},email:r=>{this.lit("<"+r.text+">")},url:r=>{this.lit("<"+r.text+">")},span:r=>{this.lit("["),this.renderChildren(r.children),this.lit("]")},link:r=>{this.lit("["),this.renderChildren(r.children),this.lit("]"),r.reference?(this.lit("["),r.reference!==(0,ns.getStringContent)(r)&&this.lit(r.reference),this.lit("]")):r.destination?(this.lit("("),this.lit(r.destination),this.lit(")")):this.lit("()")},image:r=>{this.lit("!["),this.renderChildren(r.children),this.lit("]"),r.reference?(this.lit("["),r.reference!==(0,ns.getStringContent)(r)&&this.lit(r.reference),this.lit("]")):r.destination?(this.lit("("),this.lit(r.destination),this.lit(")")):this.lit("()")},raw_inline:r=>{this.verbatimNode(r),this.lit("{="+r.format+"}")},verbatim:r=>{this.verbatimNode(r)},inline_math:r=>{this.lit("$"),this.verbatimNode(r)},display_math:r=>{this.lit("$$"),this.verbatimNode(r)}},this.doc=e,this.wrapWidth=(n==null?void 0:n.wrapWidth)||0}escape(e){return e=e.replace(/([~`'"${}[\]^<>\\*_]|-(?=-)|!(=\[)|\.(?=\.))/g,"\\$1"),(this.column===0||this.column===this.endOfPrefix)&&(e=e.replace(/^#/,"\\#")),e}out(e){this.lit(this.escape(e))}doBlankLines(){this.needsBlankLine&&(this.cr(),this.newline(),this.needsBlankLine=!1)}lit(e){this.buffer.push(e),this.column+=e.length,this.startOfLine=!1}blankline(){this.needsBlankLine=!0}newline(){if(this.endOfPrefix===this.column)for(;/  *$|^$/.test(this.buffer[this.buffer.length-1]);)this.buffer[this.buffer.length-1]=this.buffer[this.buffer.length-1].replace(/  *$/,""),this.buffer[this.buffer.length-1]===""&&this.buffer.pop();if(this.endOfPrefix=0,this.column=0,this.buffer.push(`
`),this.prefixes.length>0){for(let e=0,n=this.prefixes.length;e<n;e++)this.buffer.push(this.prefixes[e]),this.column+=this.prefixes[e].length;this.endOfPrefix=this.column}this.startOfLine=!0}cr(){this.startOfLine||this.newline()}wrap(){if(this.wrapWidth<=0)return;let e=this.buffer.length-1;if(!this.startOfLine&&this.buffer.length>0&&this.column>this.wrapWidth){let n;for(;e>=0&&(n=this.buffer[e],n!==" ");){if(/^[ \r\n]+$/.test(n))return;e--}}if(e<this.buffer.length-1){const n=this.buffer.splice(e+1);this.buffer[this.buffer.length-1]===" "&&this.buffer.pop(),this.newline(),this.startOfLine=!0;for(let r=0;r<n.length;r++)this.buffer.push(n[r]),this.column+=n[r].length,this.startOfLine=!1}}space(){this.wrap(),this.lit(" ")}soft_break(){this.wrapWidth===0?this.newline():this.space()}needsBraces(e){return vo(e)||ko(e)||this.buffer.length>0&&/\w$/.test(this.buffer[this.buffer.length-1])}noWrap(e){const n=this.wrapWidth;this.wrapWidth=-1,e(),this.wrapWidth=n}inlineContainer(e,n){const r=this;return function(s){n=n||r.needsBraces(s),n&&r.lit("{"),r.lit(e),r.renderChildren(s.children),r.lit(e),n&&r.lit("}")}}litlines(e){const n=e.split(/\r?\n/);n[n.length-1]===""&&n.pop();for(const r of n)this.lit(r),this.cr()}verbatimNode(e){const n=yn(e,1);this.lit(n),/^`/.test(e.text)&&this.lit(" "),this.lit(e.text),/`$/.test(e.text)&&this.lit(" "),this.lit(n)}renderChildren(e){for(let n=0,r=e.length;n<r;n++)this.renderNode(e[n]);e[0]&&!(0,jt.isBlock)(e[0])&&this.wrap()}renderNode(e){this.doBlankLines();const n=this.handlers[e.tag];if(n)e.attributes&&(0,jt.isBlock)(e)&&(this.renderAttributes(e),this.cr()),n(e),e.attributes&&(0,jt.isInline)(e)&&this.renderAttributes(e);else throw new Error("No renderer defined for node type "+e.tag)}renderAttributes(e){if(!e.attributes||Object.keys(e.attributes).length===0)return;const n=e.attributes;this.lit("{");let r=!0;(0,jt.isBlock)(e)&&this.prefixes.push(" ");for(const s in n){if(r||this.space(),s==="id")this.lit("#"),this.lit(n[s]);else if(s==="class"){const a=n[s].split(/  */);for(let l=0;l<a.length;l++)l>0&&this.space(),this.lit("."),this.lit(a[l])}else this.lit(s),this.lit('="'),this.out(n[s]),this.lit('"');r=!1}(0,jt.isBlock)(e)&&this.prefixes.pop(),this.lit("}")}render(){return this.renderNode(this.doc),this.buffer.join("")}}const So=function(t,e={}){return new Ao(t,e).render()};Me.renderDjot=So;var Oe={};Object.defineProperty(Oe,"__esModule",{value:!0}),Oe.version=void 0,Oe.version="0.3.1",function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.isInline=t.isBlock=t.version=t.renderDjot=t.toPandoc=t.fromPandoc=t.applyFilter=t.HTMLRenderer=t.renderHTML=t.parseEvents=t.renderAST=t.parse=void 0;var e=ke;Object.defineProperty(t,"parse",{enumerable:!0,get:function(){return e.parse}}),Object.defineProperty(t,"renderAST",{enumerable:!0,get:function(){return e.renderAST}});var n=se;Object.defineProperty(t,"parseEvents",{enumerable:!0,get:function(){return n.parseEvents}});var r=Wt;Object.defineProperty(t,"renderHTML",{enumerable:!0,get:function(){return r.renderHTML}}),Object.defineProperty(t,"HTMLRenderer",{enumerable:!0,get:function(){return r.HTMLRenderer}});var s=Ce;Object.defineProperty(t,"applyFilter",{enumerable:!0,get:function(){return s.applyFilter}});var a=Vt;Object.defineProperty(t,"fromPandoc",{enumerable:!0,get:function(){return a.fromPandoc}}),Object.defineProperty(t,"toPandoc",{enumerable:!0,get:function(){return a.toPandoc}});var l=Me;Object.defineProperty(t,"renderDjot",{enumerable:!0,get:function(){return l.renderDjot}});var u=Oe;Object.defineProperty(t,"version",{enumerable:!0,get:function(){return u.version}});var c=bt;Object.defineProperty(t,"isBlock",{enumerable:!0,get:function(){return c.isBlock}}),Object.defineProperty(t,"isInline",{enumerable:!0,get:function(){return c.isInline}})}(rn);let wn={},vn={},kn={},Dt={};function No(t){vn=t.temmlOptions??{},Dt=t.djotHTMLRenderOptions??{},wn=t.djotParseOptions??{},kn=t.overrides??{}}function Co(){Dt={},wn={},vn={},kn={}}function To(t,...e){const n=Tn(t,...e).replace(new RegExp("(?<!\\$)(\\$\\`)([^`]+)\\`([.,])","g"),"$1$2$3`"),r=rn.parse(n,wn),s={...na(vn),...kn,...Dt==null?void 0:Dt.overrides};return Dt={...Dt,overrides:s},rn.renderHTML(r,{...Dt})}function qo(t,e){return ve.renderToString(t,e)}function $e(t,e){return ve.renderToString(t,{...e,displayMode:!0})}function Mo(t,e){return Ht("align",t,e)}function Oo(t,e){return Ht("align*",t,e)}function $o(t,e,n){return $e(`\\begin{alignat}{${e}}${t}\\end{alignat}`,n)}function Eo(t,e,n){return $e(`\\begin{alignat*}{${e}}${t}\\end{alignat*}`,n)}function Io(t,e){return Ht("gather",t,e)}function Do(t,e){return Ht("gather*",t,e)}function is(t,e){return Ht("equation",t,e)}function as(t,e){return Ht("equation*",t,e)}const Po=is,Bo=as;function Ht(t,e,n){return $e(`\\begin{${t}}${e}\\end{${t}}`,n)}st.align=Mo,st.alignStar=Oo,st.alignat=$o,st.alignatStar=Eo,st.display=$e,st.eqn=Po,st.eqnStar=Bo,st.equation=is,st.equationStar=as,st.gather=Io,st.gatherStar=Do,st.math=qo,st.mathlifier=To,st.mathlifierDj=Tn,st.mathlifierFactory=Rt,st.mathlifierTex=Cn,st.resetOptions=Co,st.setOptions=No,Object.defineProperty(st,Symbol.toStringTag,{value:"Module"})});
